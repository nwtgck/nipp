Opal.modules.stringio=function(Opal){function $rb_ge(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs>=rhs:lhs["$>="](rhs)}function $rb_gt(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs>rhs:lhs["$>"](rhs)}function $rb_plus(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs+rhs:lhs["$+"](rhs)}function $rb_minus(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs-rhs:lhs["$-"](rhs)}var $nesting=(Opal.top,[]),nil=Opal.nil,$klass=(Opal.breaker,Opal.slice,Opal.klass),$truthy=Opal.truthy;return Opal.add_stubs(["$include","$new","$call","$close","$attr_accessor","$length","$include?","$!","$check_readable","$==","$===","$>=","$raise","$>","$+","$-","$seek","$enum_for","$eof?","$ord","$[]","$check_writable","$String","$write","$closed_write?","$closed_read?"]),function($base,$super,$parent_nesting){function $StringIO(){}var TMP_StringIO_open_1,TMP_StringIO_initialize_2,TMP_StringIO_eof$q_3,TMP_StringIO_seek_4,TMP_StringIO_tell_5,TMP_StringIO_rewind_6,TMP_StringIO_each_byte_7,TMP_StringIO_each_char_8,TMP_StringIO_write_9,TMP_StringIO_read_10,TMP_StringIO_close_11,TMP_StringIO_close_read_12,TMP_StringIO_close_write_13,TMP_StringIO_closed$q_14,TMP_StringIO_closed_read$q_15,TMP_StringIO_closed_write$q_16,TMP_StringIO_check_writable_17,TMP_StringIO_check_readable_18,self=$StringIO=$klass($base,$super,"StringIO",$StringIO),def=self.$$proto,$nesting=[self].concat($parent_nesting);return def.position=def.string=def.closed=nil,self.$include(Opal.const_get_qualified(Opal.const_get_relative($nesting,"IO"),"Readable")),self.$include(Opal.const_get_qualified(Opal.const_get_relative($nesting,"IO"),"Writable")),Opal.defs(self,"$open",TMP_StringIO_open_1=function(string,mode){var self=this,$iter=TMP_StringIO_open_1.$$p,block=$iter||nil,io=nil,res=nil;return null==string&&(string=""),null==mode&&(mode=nil),$iter&&(TMP_StringIO_open_1.$$p=null),io=self.$new(string,mode),res=block.$call(io),io.$close(),res},TMP_StringIO_open_1.$$arity=-1),self.$attr_accessor("string"),Opal.defn(self,"$initialize",TMP_StringIO_initialize_2=function(string,mode){var $a,self=this;return null==string&&(string=""),null==mode&&(mode="rw"),self.string=string,self.position=string.$length(),$truthy($truthy($a=mode["$include?"]("r"))?mode["$include?"]("w")["$!"]():$a)?self.closed="write":$truthy($truthy($a=mode["$include?"]("w"))?mode["$include?"]("r")["$!"]():$a)?self.closed="read":nil},TMP_StringIO_initialize_2.$$arity=-1),Opal.defn(self,"$eof?",TMP_StringIO_eof$q_3=function(){var self=this;return self.$check_readable(),self.position["$=="](self.string.$length())},TMP_StringIO_eof$q_3.$$arity=0),Opal.alias(self,"eof","eof?"),Opal.defn(self,"$seek",TMP_StringIO_seek_4=function(pos,whence){var self=this,$case=nil;return null==whence&&(whence=Opal.const_get_qualified(Opal.const_get_relative($nesting,"IO"),"SEEK_SET")),$case=whence,Opal.const_get_qualified(Opal.const_get_relative($nesting,"IO"),"SEEK_SET")["$==="]($case)?($truthy($rb_ge(pos,0))||self.$raise(Opal.const_get_qualified(Opal.const_get_relative($nesting,"Errno"),"EINVAL")),self.position=pos):Opal.const_get_qualified(Opal.const_get_relative($nesting,"IO"),"SEEK_CUR")["$==="]($case)?self.position=$truthy($rb_gt($rb_plus(self.position,pos),self.string.$length()))?self.string.$length():$rb_plus(self.position,pos):Opal.const_get_qualified(Opal.const_get_relative($nesting,"IO"),"SEEK_END")["$==="]($case)&&(self.position=$truthy($rb_gt(pos,self.string.$length()))?0:$rb_minus(self.position,pos)),0},TMP_StringIO_seek_4.$$arity=-2),Opal.defn(self,"$tell",TMP_StringIO_tell_5=function(){var self=this;return self.position},TMP_StringIO_tell_5.$$arity=0),Opal.alias(self,"pos","tell"),Opal.alias(self,"pos=","seek"),Opal.defn(self,"$rewind",TMP_StringIO_rewind_6=function(){var self=this;return self.$seek(0)},TMP_StringIO_rewind_6.$$arity=0),Opal.defn(self,"$each_byte",TMP_StringIO_each_byte_7=function(){var self=this,$iter=TMP_StringIO_each_byte_7.$$p,block=$iter||nil,i=nil;if($iter&&(TMP_StringIO_each_byte_7.$$p=null),!$truthy(block))return self.$enum_for("each_byte");for(self.$check_readable(),i=self.position;!$truthy(self["$eof?"]());)block.$call(self.string["$[]"](i).$ord()),i=$rb_plus(i,1);return self},TMP_StringIO_each_byte_7.$$arity=0),Opal.defn(self,"$each_char",TMP_StringIO_each_char_8=function(){var self=this,$iter=TMP_StringIO_each_char_8.$$p,block=$iter||nil,i=nil;if($iter&&(TMP_StringIO_each_char_8.$$p=null),!$truthy(block))return self.$enum_for("each_char");for(self.$check_readable(),i=self.position;!$truthy(self["$eof?"]());)block.$call(self.string["$[]"](i)),i=$rb_plus(i,1);return self},TMP_StringIO_each_char_8.$$arity=0),Opal.defn(self,"$write",TMP_StringIO_write_9=function(string){var self=this,before=nil,after=nil;return self.$check_writable(),string=self.$String(string),self.string.$length()["$=="](self.position)?(self.string=$rb_plus(self.string,string),self.position=$rb_plus(self.position,string.$length())):(before=self.string["$[]"](Opal.Range.$new(0,$rb_minus(self.position,1),!1)),after=self.string["$[]"](Opal.Range.$new($rb_plus(self.position,string.$length()),-1,!1)),self.string=$rb_plus($rb_plus(before,string),after),self.position=$rb_plus(self.position,string.$length()))},TMP_StringIO_write_9.$$arity=1),Opal.defn(self,"$read",TMP_StringIO_read_10=function(length,outbuf){var self=this,string=nil,str=nil;return null==length&&(length=nil),null==outbuf&&(outbuf=nil),self.$check_readable(),$truthy(self["$eof?"]())?nil:(string=function(){return $truthy(length)?(str=self.string["$[]"](self.position,length),self.position=$rb_plus(self.position,length),str):(str=self.string["$[]"](Opal.Range.$new(self.position,-1,!1)),self.position=self.string.$length(),str)}(),$truthy(outbuf)?outbuf.$write(string):string)},TMP_StringIO_read_10.$$arity=-1),Opal.defn(self,"$close",TMP_StringIO_close_11=function(){var self=this;return self.closed="both"},TMP_StringIO_close_11.$$arity=0),Opal.defn(self,"$close_read",TMP_StringIO_close_read_12=function(){var self=this;return self.closed=self.closed["$=="]("write")?"both":"read"},TMP_StringIO_close_read_12.$$arity=0),Opal.defn(self,"$close_write",TMP_StringIO_close_write_13=function(){var self=this;return self.closed=self.closed["$=="]("read")?"both":"write"},TMP_StringIO_close_write_13.$$arity=0),Opal.defn(self,"$closed?",TMP_StringIO_closed$q_14=function(){var self=this;return self.closed["$=="]("both")},TMP_StringIO_closed$q_14.$$arity=0),Opal.defn(self,"$closed_read?",TMP_StringIO_closed_read$q_15=function(){var $a,self=this;return $truthy($a=self.closed["$=="]("read"))?$a:self.closed["$=="]("both")},TMP_StringIO_closed_read$q_15.$$arity=0),Opal.defn(self,"$closed_write?",TMP_StringIO_closed_write$q_16=function(){var $a,self=this;return $truthy($a=self.closed["$=="]("write"))?$a:self.closed["$=="]("both")},TMP_StringIO_closed_write$q_16.$$arity=0),Opal.defn(self,"$check_writable",TMP_StringIO_check_writable_17=function(){var self=this;return $truthy(self["$closed_write?"]())?self.$raise(Opal.const_get_relative($nesting,"IOError"),"not opened for writing"):nil},TMP_StringIO_check_writable_17.$$arity=0),Opal.defn(self,"$check_readable",TMP_StringIO_check_readable_18=function(){var self=this;return $truthy(self["$closed_read?"]())?self.$raise(Opal.const_get_relative($nesting,"IOError"),"not opened for reading"):nil},TMP_StringIO_check_readable_18.$$arity=0),nil&&"check_readable"}($nesting[0],Opal.const_get_relative($nesting,"IO"),$nesting)};