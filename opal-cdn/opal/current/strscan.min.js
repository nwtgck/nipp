Opal.modules.strscan=function(Opal){Opal.top;var $nesting=[],nil=Opal.nil,$klass=(Opal.breaker,Opal.slice,Opal.klass),$send=Opal.send;return Opal.add_stubs(["$attr_reader","$anchor","$scan_until","$length","$size","$rest","$pos=","$-","$private"]),function($base,$super,$parent_nesting){function $StringScanner(){}var TMP_StringScanner_initialize_1,TMP_StringScanner_beginning_of_line$q_2,TMP_StringScanner_scan_3,TMP_StringScanner_scan_until_4,TMP_StringScanner_$$_5,TMP_StringScanner_check_6,TMP_StringScanner_check_until_7,TMP_StringScanner_peek_8,TMP_StringScanner_eos$q_9,TMP_StringScanner_exist$q_10,TMP_StringScanner_skip_11,TMP_StringScanner_skip_until_12,TMP_StringScanner_get_byte_13,TMP_StringScanner_match$q_14,TMP_StringScanner_pos$eq_15,TMP_StringScanner_matched_size_16,TMP_StringScanner_post_match_17,TMP_StringScanner_pre_match_18,TMP_StringScanner_reset_19,TMP_StringScanner_rest_20,TMP_StringScanner_rest$q_21,TMP_StringScanner_rest_size_22,TMP_StringScanner_terminate_23,TMP_StringScanner_unscan_24,TMP_StringScanner_anchor_25,self=$StringScanner=$klass($base,null,"StringScanner",$StringScanner),def=self.$$proto;[self].concat($parent_nesting);return def.pos=def.string=def.working=def.matched=def.prev_pos=def.match=nil,self.$attr_reader("pos"),self.$attr_reader("matched"),Opal.defn(self,"$initialize",TMP_StringScanner_initialize_1=function(string){return this.string=string,this.pos=0,this.matched=nil,this.working=string,this.match=[]},TMP_StringScanner_initialize_1.$$arity=1),self.$attr_reader("string"),Opal.defn(self,"$beginning_of_line?",TMP_StringScanner_beginning_of_line$q_2=function(){return 0===this.pos||"\n"===this.string.charAt(this.pos-1)},TMP_StringScanner_beginning_of_line$q_2.$$arity=0),Opal.alias(self,"bol?","beginning_of_line?"),Opal.defn(self,"$scan",TMP_StringScanner_scan_3=function(pattern){var result=(pattern=this.$anchor(pattern)).exec(this.working);return null==result?this.matched=nil:"object"==typeof result?(this.prev_pos=this.pos,this.pos+=result[0].length,this.working=this.working.substring(result[0].length),this.matched=result[0],(this.match=result)[0]):"string"==typeof result?(this.pos+=result.length,this.working=this.working.substring(result.length),result):nil},TMP_StringScanner_scan_3.$$arity=1),Opal.defn(self,"$scan_until",TMP_StringScanner_scan_until_4=function(pattern){pattern=this.$anchor(pattern);for(var result,pos=this.pos,working=this.working;;){if(result=pattern.exec(working),pos+=1,working=working.substr(1),null!=result)return this.matched=this.string.substr(this.pos,pos-this.pos-1+result[0].length),this.prev_pos=pos-1,this.pos=pos,this.working=working.substr(result[0].length),this.matched;if(0===working.length)return this.matched=nil}},TMP_StringScanner_scan_until_4.$$arity=1),Opal.defn(self,"$[]",TMP_StringScanner_$$_5=function(idx){var match=this.match;return idx<0&&(idx+=match.length),idx<0||idx>=match.length?nil:null==match[idx]?nil:match[idx]},TMP_StringScanner_$$_5.$$arity=1),Opal.defn(self,"$check",TMP_StringScanner_check_6=function(pattern){var result=(pattern=this.$anchor(pattern)).exec(this.working);return this.matched=null==result?nil:result[0]},TMP_StringScanner_check_6.$$arity=1),Opal.defn(self,"$check_until",TMP_StringScanner_check_until_7=function(pattern){var prev_pos=this.prev_pos,pos=this.pos,result=this.$scan_until(pattern);return result!==nil&&(this.matched=result.substr(-1),this.working=this.string.substr(pos)),this.prev_pos=prev_pos,this.pos=pos,result},TMP_StringScanner_check_until_7.$$arity=1),Opal.defn(self,"$peek",TMP_StringScanner_peek_8=function(length){return this.working.substring(0,length)},TMP_StringScanner_peek_8.$$arity=1),Opal.defn(self,"$eos?",TMP_StringScanner_eos$q_9=function(){return 0===this.working.length},TMP_StringScanner_eos$q_9.$$arity=0),Opal.defn(self,"$exist?",TMP_StringScanner_exist$q_10=function(pattern){var result=pattern.exec(this.working);return null==result?nil:0==result.index?0:result.index+1},TMP_StringScanner_exist$q_10.$$arity=1),Opal.defn(self,"$skip",TMP_StringScanner_skip_11=function(pattern){var result=(pattern=this.$anchor(pattern)).exec(this.working);if(null==result)return this.matched=nil;var match_str=result[0],match_len=match_str.length;return this.matched=match_str,this.prev_pos=this.pos,this.pos+=match_len,this.working=this.working.substring(match_len),match_len},TMP_StringScanner_skip_11.$$arity=1),Opal.defn(self,"$skip_until",TMP_StringScanner_skip_until_12=function(pattern){var result=this.$scan_until(pattern);return result===nil?nil:(this.matched=result.substr(-1),result.length)},TMP_StringScanner_skip_until_12.$$arity=1),Opal.defn(self,"$get_byte",TMP_StringScanner_get_byte_13=function(){var result=nil;return this.pos<this.string.length?(this.prev_pos=this.pos,this.pos+=1,result=this.matched=this.working.substring(0,1),this.working=this.working.substring(1)):this.matched=nil,result},TMP_StringScanner_get_byte_13.$$arity=0),Opal.alias(self,"getch","get_byte"),Opal.defn(self,"$match?",TMP_StringScanner_match$q_14=function(pattern){var result=(pattern=this.$anchor(pattern)).exec(this.working);return null==result?nil:(this.prev_pos=this.pos,result[0].length)},TMP_StringScanner_match$q_14.$$arity=1),Opal.defn(self,"$pos=",TMP_StringScanner_pos$eq_15=function(pos){return pos<0&&(pos+=this.string.$length()),this.pos=pos,this.working=this.string.slice(pos)},TMP_StringScanner_pos$eq_15.$$arity=1),Opal.defn(self,"$matched_size",TMP_StringScanner_matched_size_16=function(){return this.matched===nil?nil:this.matched.length},TMP_StringScanner_matched_size_16.$$arity=0),Opal.defn(self,"$post_match",TMP_StringScanner_post_match_17=function(){return this.matched===nil?nil:this.string.substr(this.pos)},TMP_StringScanner_post_match_17.$$arity=0),Opal.defn(self,"$pre_match",TMP_StringScanner_pre_match_18=function(){return this.matched===nil?nil:this.string.substr(0,this.prev_pos)},TMP_StringScanner_pre_match_18.$$arity=0),Opal.defn(self,"$reset",TMP_StringScanner_reset_19=function(){return this.working=this.string,this.matched=nil,this.pos=0},TMP_StringScanner_reset_19.$$arity=0),Opal.defn(self,"$rest",TMP_StringScanner_rest_20=function(){return this.working},TMP_StringScanner_rest_20.$$arity=0),Opal.defn(self,"$rest?",TMP_StringScanner_rest$q_21=function(){return 0!==this.working.length},TMP_StringScanner_rest$q_21.$$arity=0),Opal.defn(self,"$rest_size",TMP_StringScanner_rest_size_22=function(){return this.$rest().$size()},TMP_StringScanner_rest_size_22.$$arity=0),Opal.defn(self,"$terminate",TMP_StringScanner_terminate_23=function(){var $writer,lhs,rhs;return this.match=nil,$writer=[this.string.$length()],$send(this,"pos=",Opal.to_a($writer)),$writer[(lhs=$writer.length,rhs=1,"number"==typeof lhs&&"number"==typeof rhs?lhs-rhs:lhs["$-"](rhs))]},TMP_StringScanner_terminate_23.$$arity=0),Opal.defn(self,"$unscan",TMP_StringScanner_unscan_24=function(){return this.pos=this.prev_pos,this.prev_pos=nil,this.match=nil,this},TMP_StringScanner_unscan_24.$$arity=0),self.$private(),Opal.defn(self,"$anchor",TMP_StringScanner_anchor_25=function(pattern){var flags=pattern.toString().match(/\/([^\/]+)$/);return flags=flags?flags[1]:void 0,new RegExp("^(?:"+pattern.source+")",flags)},TMP_StringScanner_anchor_25.$$arity=1),nil&&"anchor"}($nesting[0],0,$nesting)};
