Opal.modules.e2mmap=function(Opal){function $rb_minus(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs-rhs:lhs["$-"](rhs)}Opal.top;var $nesting=[],nil=Opal.nil,$$=(Opal.const_get_qualified,Opal.const_get_relative),$module=(Opal.breaker,Opal.slice,Opal.module),$send=Opal.send,$truthy=Opal.truthy,$hash2=Opal.hash2,$gvars=Opal.gvars;return Opal.add_stubs(["$<","$bind","$module_eval","$Raise","$class","$extend","$def_e2message","$def_exception","$instance_eval","$[]=","$-","$new","$const_defined?","$remove_const","$const_set","$e2mm_message","$nil?","$caller","$=~","$[]","$quote","$shift","$raise","$sprintf","$Fail","$inspect","$each","$ancestors"]),function($base,$parent_nesting){function $Exception2MessageMapper(){}var TMP_Exception2MessageMapper_extend_object_1,TMP_Exception2MessageMapper_bind_2,TMP_Exception2MessageMapper_Raise_6,TMP_Exception2MessageMapper_def_e2message_7,TMP_Exception2MessageMapper_def_exception_8,TMP_Exception2MessageMapper_def_e2message_9,TMP_Exception2MessageMapper_def_exception_11,TMP_Exception2MessageMapper_Raise_14,TMP_Exception2MessageMapper_e2mm_message_15,self=$Exception2MessageMapper=$module($base,"Exception2MessageMapper",$Exception2MessageMapper),$nesting=(self.prototype,[self].concat($parent_nesting));Opal.const_set($nesting[0],"E2MM",$$($nesting,"Exception2MessageMapper")),Opal.defs($$($nesting,"E2MM"),"$extend_object",TMP_Exception2MessageMapper_extend_object_1=function(cl){var $zuper_ii,lhs,rhs,$iter=TMP_Exception2MessageMapper_extend_object_1.$$p,$zuper=nil,$zuper_i=nil;for($iter&&(TMP_Exception2MessageMapper_extend_object_1.$$p=null),$zuper_i=0,$zuper_ii=arguments.length,$zuper=new Array($zuper_ii);$zuper_i<$zuper_ii;$zuper_i++)$zuper[$zuper_i]=arguments[$zuper_i];return $send(this,Opal.find_super_dispatcher(this,"extend_object",TMP_Exception2MessageMapper_extend_object_1,!1,$Exception2MessageMapper),$zuper,$iter),$truthy((lhs=cl,rhs=$$($nesting,"E2MM"),"number"==typeof lhs&&"number"==typeof rhs?lhs<rhs:lhs["$<"](rhs)))?nil:cl.$bind(this)},TMP_Exception2MessageMapper_extend_object_1.$$arity=1),Opal.def(self,"$bind",TMP_Exception2MessageMapper_bind_2=function(cl){var TMP_3;return $send(this,"module_eval",[],((TMP_3=function(){var TMP_Raise_4,TMP_included_5,self=TMP_3.$$s||this;return Opal.def(self,"$Raise",TMP_Raise_4=function($a,$b){var $post_args,err,rest;return 0<($post_args=Opal.slice.call(arguments,0,arguments.length)).length&&(err=$post_args[0],$post_args.splice(0,1)),null==err&&(err=nil),rest=$post_args,$send($$($nesting,"Exception2MessageMapper"),"Raise",[this.$class(),err].concat(Opal.to_a(rest)))},TMP_Raise_4.$$arity=-1),Opal.alias(self,"Fail","Raise"),function(self,$parent_nesting){self.prototype,[self].concat($parent_nesting);Opal.udef(self,"$included")}(Opal.get_singleton_class(self),$nesting),Opal.defs(self,"$included",TMP_included_5=function(mod){return mod.$extend($$($nesting,"Exception2MessageMapper"))},TMP_included_5.$$arity=1),nil&&"included"}).$$s=this,TMP_3.$$arity=0,TMP_3))},TMP_Exception2MessageMapper_bind_2.$$arity=1),Opal.def(self,"$Raise",TMP_Exception2MessageMapper_Raise_6=function($a,$b){var $post_args,err,rest,self=this;return 0<($post_args=Opal.slice.call(arguments,0,arguments.length)).length&&(err=$post_args[0],$post_args.splice(0,1)),null==err&&(err=nil),rest=$post_args,$send($$($nesting,"E2MM"),"Raise",[self,err].concat(Opal.to_a(rest)))},TMP_Exception2MessageMapper_Raise_6.$$arity=-1),Opal.alias(self,"Fail","Raise"),Opal.alias(self,"fail","Raise"),Opal.def(self,"$def_e2message",TMP_Exception2MessageMapper_def_e2message_7=function(c,m){return $$($nesting,"E2MM").$def_e2message(this,c,m)},TMP_Exception2MessageMapper_def_e2message_7.$$arity=2),Opal.def(self,"$def_exception",TMP_Exception2MessageMapper_def_exception_8=function(n,m,s){return null==s&&(s=$$($nesting,"StandardError")),$$($nesting,"E2MM").$def_exception(this,n,m,s)},TMP_Exception2MessageMapper_def_exception_8.$$arity=-3),self.MessageMap=$hash2([],{}),Opal.defs($$($nesting,"E2MM"),"$def_e2message",TMP_Exception2MessageMapper_def_e2message_9=function(k,c,m){var TMP_10;return $send($$($nesting,"E2MM"),"instance_eval",[],((TMP_10=function(){var $writer,self=TMP_10.$$s||this;return null==self.MessageMap&&(self.MessageMap=nil),$writer=[[k,c],m],$send(self.MessageMap,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=this,TMP_10.$$arity=0,TMP_10)),c},TMP_Exception2MessageMapper_def_e2message_9.$$arity=3),Opal.defs($$($nesting,"E2MM"),"$def_exception",TMP_Exception2MessageMapper_def_exception_11=function(k,n,m,s){var TMP_12,TMP_13,e;return null==s&&(s=$$($nesting,"StandardError")),e=$$($nesting,"Class").$new(s),$send($$($nesting,"E2MM"),"instance_eval",[],((TMP_12=function(){var $writer,self=TMP_12.$$s||this;return null==self.MessageMap&&(self.MessageMap=nil),$writer=[[k,e],m],$send(self.MessageMap,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=this,TMP_12.$$arity=0,TMP_12)),$truthy(k["$const_defined?"](n,!1))&&$send(k,"module_eval",[],((TMP_13=function(){return(TMP_13.$$s||this).$remove_const(n)}).$$s=this,TMP_13.$$arity=0,TMP_13)),k.$const_set(n,e)},TMP_Exception2MessageMapper_def_exception_11.$$arity=-4),Opal.defs($$($nesting,"E2MM"),"$Raise",TMP_Exception2MessageMapper_Raise_14=function($a,$b,$c){var $post_args,klass,err,rest,self=this,form=nil,b=nil;return null==$gvars["@"]&&($gvars["@"]=nil),0<($post_args=Opal.slice.call(arguments,0,arguments.length)).length&&(klass=$post_args[0],$post_args.splice(0,1)),null==klass&&(klass=$$($nesting,"E2MM")),0<$post_args.length&&(err=$post_args[0],$post_args.splice(0,1)),null==err&&(err=nil),rest=$post_args,$truthy(form=self.$e2mm_message(klass,err))?(b=$truthy($gvars["@"]["$nil?"]())?self.$caller(1):$gvars["@"],$truthy(b["$[]"](0)["$=~"](new RegExp("^"+$$($nesting,"Regexp").$quote("./e2mmap.rb".$force_encoding("US-ASCII"))+":")))&&b.$shift(),self.$raise(err,$send(self,"sprintf",[form].concat(Opal.to_a(rest))),b)):$$($nesting,"E2MM").$Fail($$($nesting,"E2MM"),$$($nesting,"ErrNotRegisteredException"),err.$inspect())},TMP_Exception2MessageMapper_Raise_14.$$arity=-1),function(self,$parent_nesting){self.prototype,[self].concat($parent_nesting);Opal.alias(self,"Fail","Raise")}(Opal.get_singleton_class($$($nesting,"E2MM")),$nesting),Opal.defs($$($nesting,"E2MM"),"$e2mm_message",TMP_Exception2MessageMapper_e2mm_message_15=function(klass,exp){try{var TMP_16;return $send(klass.$ancestors(),"each",[],((TMP_16=function(c){var mes,self=TMP_16.$$s||this;if(null==self.MessageMap&&(self.MessageMap=nil),null==c&&(c=nil),!$truthy(mes=self.MessageMap["$[]"]([c,exp])))return nil;Opal.ret(mes)}).$$s=this,TMP_16.$$arity=1,TMP_16)),nil}catch($returner){if($returner===Opal.returner)return $returner.$v;throw $returner}},TMP_Exception2MessageMapper_e2mm_message_15.$$arity=2),function(self,$parent_nesting){self.prototype,[self].concat($parent_nesting);Opal.alias(self,"message","e2mm_message")}(Opal.get_singleton_class(self),$nesting),$$($nesting,"E2MM").$def_exception($$($nesting,"E2MM"),"ErrNotRegisteredException","not registered exception(%s)")}($nesting[0],$nesting)},Opal.modules["matrix/eigenvalue_decomposition"]=function(Opal){function $rb_minus(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs-rhs:lhs["$-"](rhs)}function $rb_gt(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?rhs<lhs:lhs["$>"](rhs)}function $rb_plus(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs+rhs:lhs["$+"](rhs)}function $rb_divide(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs/rhs:lhs["$/"](rhs)}function $rb_times(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs*rhs:lhs["$*"](rhs)}function $rb_lt(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs<rhs:lhs["$<"](rhs)}function $rb_ge(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?rhs<=lhs:lhs["$>="](rhs)}Opal.top;var $nesting=[],nil=Opal.nil,$$$=Opal.const_get_qualified,$$=Opal.const_get_relative,$klass=(Opal.breaker,Opal.slice,Opal.klass),$truthy=Opal.truthy,$send=Opal.send;return Opal.add_stubs(["$is_a?","$raise","$class","$row_count","$new","$symmetric?","$to_a","$tridiagonalize","$diagonalize","$reduce_to_hessenberg","$hessenberg_to_real_schur","$send","$transpose","$build_eigenvectors","$inverse","$dup","$each_with_index","$==","$Complex","$[]","$[]=","$-","$map","$diagonal","$eigenvalues","$v","$d","$v_inv","$alias_method","$private","$>","$+","$-@","$abs","$/","$*","$times","$downto","$sqrt","$upto","$!=","$max","$<","$<=","$hypot","$>=","$min","$cdiv"]),function($base,$super,$parent_nesting){function $Matrix(){}var self=$Matrix=$klass($base,null,"Matrix",$Matrix),$nesting=(self.prototype,[self].concat($parent_nesting));return function($base,$super,$parent_nesting){function $EigenvalueDecomposition(){}var TMP_EigenvalueDecomposition_initialize_1,TMP_EigenvalueDecomposition_eigenvector_matrix_3,TMP_EigenvalueDecomposition_eigenvector_matrix_inv_4,TMP_EigenvalueDecomposition_eigenvalues_5,TMP_EigenvalueDecomposition_eigenvectors_7,TMP_EigenvalueDecomposition_eigenvalue_matrix_9,TMP_EigenvalueDecomposition_to_ary_10,TMP_EigenvalueDecomposition_build_eigenvectors_11,TMP_EigenvalueDecomposition_cdiv_16,TMP_EigenvalueDecomposition_tridiagonalize_17,TMP_EigenvalueDecomposition_diagonalize_37,TMP_EigenvalueDecomposition_reduce_to_hessenberg_46,TMP_EigenvalueDecomposition_hessenberg_to_real_schur_63,self=$EigenvalueDecomposition=$klass($base,null,"EigenvalueDecomposition",$EigenvalueDecomposition),def=self.prototype,$nesting=[self].concat($parent_nesting);return def.size=def.symmetric=def.d=def.e=def.v=def.h=nil,Opal.def(self,"$initialize",TMP_EigenvalueDecomposition_initialize_1=function(a){var TMP_2;return $truthy(a["$is_a?"]($$($nesting,"Matrix")))||this.$raise($$($nesting,"TypeError"),"Expected Matrix but got "+a.$class()),this.size=a.$row_count(),this.d=$$($nesting,"Array").$new(this.size,0),this.e=$$($nesting,"Array").$new(this.size,0),$truthy(this.symmetric=a["$symmetric?"]())?(this.v=a.$to_a(),this.$tridiagonalize(),this.$diagonalize()):(this.v=$send($$($nesting,"Array"),"new",[this.size],((TMP_2=function(){var self=TMP_2.$$s||this;return null==self.size&&(self.size=nil),$$($nesting,"Array").$new(self.size,0)}).$$s=this,TMP_2.$$arity=0,TMP_2)),this.h=a.$to_a(),this.ort=$$($nesting,"Array").$new(this.size,0),this.$reduce_to_hessenberg(),this.$hessenberg_to_real_schur())},TMP_EigenvalueDecomposition_initialize_1.$$arity=1),Opal.def(self,"$eigenvector_matrix",TMP_EigenvalueDecomposition_eigenvector_matrix_3=function(){return $$($nesting,"Matrix").$send("new",this.$build_eigenvectors().$transpose())},TMP_EigenvalueDecomposition_eigenvector_matrix_3.$$arity=0),Opal.alias(self,"v","eigenvector_matrix"),Opal.def(self,"$eigenvector_matrix_inv",TMP_EigenvalueDecomposition_eigenvector_matrix_inv_4=function(){var r=nil;return r=$$($nesting,"Matrix").$send("new",this.$build_eigenvectors()),$truthy(this.symmetric)||(r=r.$transpose().$inverse()),r},TMP_EigenvalueDecomposition_eigenvector_matrix_inv_4.$$arity=0),Opal.alias(self,"v_inv","eigenvector_matrix_inv"),Opal.def(self,"$eigenvalues",TMP_EigenvalueDecomposition_eigenvalues_5=function(){var TMP_6,values=nil;return values=this.d.$dup(),$send(this.e,"each_with_index",[],((TMP_6=function(imag,i){var self=TMP_6.$$s||this,$writer=nil;return null==imag&&(imag=nil),null==i&&(i=nil),imag["$=="](0)?nil:($writer=[i,self.$Complex(values["$[]"](i),imag)],$send(values,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)])}).$$s=this,TMP_6.$$arity=2,TMP_6)),values},TMP_EigenvalueDecomposition_eigenvalues_5.$$arity=0),Opal.def(self,"$eigenvectors",TMP_EigenvalueDecomposition_eigenvectors_7=function(){var TMP_8;return $send(this.$build_eigenvectors(),"map",[],((TMP_8=function(ev){TMP_8.$$s;return null==ev&&(ev=nil),$$($nesting,"Vector").$send("new",ev)}).$$s=this,TMP_8.$$arity=1,TMP_8))},TMP_EigenvalueDecomposition_eigenvectors_7.$$arity=0),Opal.def(self,"$eigenvalue_matrix",TMP_EigenvalueDecomposition_eigenvalue_matrix_9=function(){return $send($$($nesting,"Matrix"),"diagonal",Opal.to_a(this.$eigenvalues()))},TMP_EigenvalueDecomposition_eigenvalue_matrix_9.$$arity=0),Opal.alias(self,"d","eigenvalue_matrix"),Opal.def(self,"$to_ary",TMP_EigenvalueDecomposition_to_ary_10=function(){return[this.$v(),this.$d(),this.$v_inv()]},TMP_EigenvalueDecomposition_to_ary_10.$$arity=0),self.$alias_method("to_a","to_ary"),self.$private(),Opal.def(self,"$build_eigenvectors",TMP_EigenvalueDecomposition_build_eigenvectors_11=function(){var TMP_12;return $send(this.e.$each_with_index(),"map",[],((TMP_12=function(imag,i){var TMP_13,TMP_14,TMP_15,self=TMP_12.$$s||this;return null==self.size&&(self.size=nil),null==imag&&(imag=nil),null==i&&(i=nil),imag["$=="](0)?$send($$($nesting,"Array"),"new",[self.size],((TMP_13=function(j){var self=TMP_13.$$s||this;return null==self.v&&(self.v=nil),null==j&&(j=nil),self.v["$[]"](j)["$[]"](i)}).$$s=self,TMP_13.$$arity=1,TMP_13)):$truthy($rb_gt(imag,0))?$send($$($nesting,"Array"),"new",[self.size],((TMP_14=function(j){var self=TMP_14.$$s||this;return null==self.v&&(self.v=nil),null==j&&(j=nil),self.$Complex(self.v["$[]"](j)["$[]"](i),self.v["$[]"](j)["$[]"]($rb_plus(i,1)))}).$$s=self,TMP_14.$$arity=1,TMP_14)):$send($$($nesting,"Array"),"new",[self.size],((TMP_15=function(j){var self=TMP_15.$$s||this;return null==self.v&&(self.v=nil),null==j&&(j=nil),self.$Complex(self.v["$[]"](j)["$[]"]($rb_minus(i,1)),self.v["$[]"](j)["$[]"](i)["$-@"]())}).$$s=self,TMP_15.$$arity=1,TMP_15))}).$$s=this,TMP_12.$$arity=2,TMP_12))},TMP_EigenvalueDecomposition_build_eigenvectors_11.$$arity=0),Opal.def(self,"$cdiv",TMP_EigenvalueDecomposition_cdiv_16=function(xr,xi,yr,yi){var r=nil,d=nil;return $truthy($rb_gt(yr.$abs(),yi.$abs()))?(d=$rb_plus(yr,$rb_times(r=$rb_divide(yi,yr),yi)),[$rb_divide($rb_plus(xr,$rb_times(r,xi)),d),$rb_divide($rb_minus(xi,$rb_times(r,xr)),d)]):(d=$rb_plus(yi,$rb_times(r=$rb_divide(yr,yi),yr)),[$rb_divide($rb_plus($rb_times(r,xr),xi),d),$rb_divide($rb_minus($rb_times(r,xi),xr),d)])},TMP_EigenvalueDecomposition_cdiv_16.$$arity=4),Opal.def(self,"$tridiagonalize",TMP_EigenvalueDecomposition_tridiagonalize_17=function(){var TMP_18,TMP_19,TMP_30,TMP_36,$writer=nil;return $send(this.size,"times",[],((TMP_18=function(j){var $writer,self=TMP_18.$$s||this;return null==self.v&&(self.v=nil),null==self.size&&(self.size=nil),null==self.d&&(self.d=nil),null==j&&(j=nil),$writer=[j,self.v["$[]"]($rb_minus(self.size,1))["$[]"](j)],$send(self.d,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=this,TMP_18.$$arity=1,TMP_18)),$send($rb_minus(this.size,1),"downto",[$rb_plus(0,1)],((TMP_19=function(i){var TMP_20,TMP_21,TMP_22,TMP_23,TMP_24,TMP_26,TMP_27,TMP_28,self=TMP_19.$$s||this,scale=nil,h=nil,$writer=nil,f=nil,g=nil,hh=nil;return null==self.d&&(self.d=nil),null==self.e&&(self.e=nil),null==i&&(i=nil),h=scale=0,$send(i,"times",[],((TMP_20=function(k){var self=TMP_20.$$s||this;return null==self.d&&(self.d=nil),null==k&&(k=nil),scale=$rb_plus(scale,self.d["$[]"](k).$abs())}).$$s=self,TMP_20.$$arity=1,TMP_20)),$truthy(scale["$=="](0))?($writer=[i,self.d["$[]"]($rb_minus(i,1))],$send(self.e,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$send(i,"times",[],((TMP_21=function(j){var self=TMP_21.$$s||this;return null==self.v&&(self.v=nil),null==self.d&&(self.d=nil),null==j&&(j=nil),$writer=[j,self.v["$[]"]($rb_minus(i,1))["$[]"](j)],$send(self.d,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[j,0],$send(self.v["$[]"](i),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[i,0],$send(self.v["$[]"](j),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_21.$$arity=1,TMP_21))):($send(i,"times",[],((TMP_22=function(k){var self=TMP_22.$$s||this;return null==self.d&&(self.d=nil),null==k&&(k=nil),$writer=[k,$rb_divide(self.d["$[]"](k),scale)],$send(self.d,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],h=$rb_plus(h,$rb_times(self.d["$[]"](k),self.d["$[]"](k)))}).$$s=self,TMP_22.$$arity=1,TMP_22)),f=self.d["$[]"]($rb_minus(i,1)),g=$$($nesting,"Math").$sqrt(h),$truthy($rb_gt(f,0))&&(g=g["$-@"]()),$writer=[i,$rb_times(scale,g)],$send(self.e,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],h=$rb_minus(h,$rb_times(f,g)),$writer=[$rb_minus(i,1),$rb_minus(f,g)],$send(self.d,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$send(i,"times",[],((TMP_23=function(j){var self=TMP_23.$$s||this;return null==self.e&&(self.e=nil),null==j&&(j=nil),$writer=[j,0],$send(self.e,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_23.$$arity=1,TMP_23)),$send(i,"times",[],((TMP_24=function(j){var TMP_25,self=TMP_24.$$s||this;return null==self.d&&(self.d=nil),null==self.v&&(self.v=nil),null==self.e&&(self.e=nil),null==j&&(j=nil),f=self.d["$[]"](j),$writer=[i,f],$send(self.v["$[]"](j),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],g=$rb_plus(self.e["$[]"](j),$rb_times(self.v["$[]"](j)["$[]"](j),f)),$send($rb_plus(j,1),"upto",[$rb_minus(i,1)],((TMP_25=function(k){var self=TMP_25.$$s||this;return null==self.v&&(self.v=nil),null==self.d&&(self.d=nil),null==self.e&&(self.e=nil),null==k&&(k=nil),g=$rb_plus(g,$rb_times(self.v["$[]"](k)["$[]"](j),self.d["$[]"](k))),$writer=[k,$rb_plus(self.e["$[]"](k),$rb_times(self.v["$[]"](k)["$[]"](j),f))],$send(self.e,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_25.$$arity=1,TMP_25)),$writer=[j,g],$send(self.e,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_24.$$arity=1,TMP_24)),f=0,$send(i,"times",[],((TMP_26=function(j){var self=TMP_26.$$s||this;return null==self.e&&(self.e=nil),null==self.d&&(self.d=nil),null==j&&(j=nil),$writer=[j,$rb_divide(self.e["$[]"](j),h)],$send(self.e,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],f=$rb_plus(f,$rb_times(self.e["$[]"](j),self.d["$[]"](j)))}).$$s=self,TMP_26.$$arity=1,TMP_26)),hh=$rb_divide(f,$rb_plus(h,h)),$send(i,"times",[],((TMP_27=function(j){var self=TMP_27.$$s||this;return null==self.e&&(self.e=nil),null==self.d&&(self.d=nil),null==j&&(j=nil),$writer=[j,$rb_minus(self.e["$[]"](j),$rb_times(hh,self.d["$[]"](j)))],$send(self.e,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_27.$$arity=1,TMP_27)),$send(i,"times",[],((TMP_28=function(j){var TMP_29,self=TMP_28.$$s||this;return null==self.d&&(self.d=nil),null==self.e&&(self.e=nil),null==self.v&&(self.v=nil),null==j&&(j=nil),f=self.d["$[]"](j),g=self.e["$[]"](j),$send(j,"upto",[$rb_minus(i,1)],((TMP_29=function(k){var self=TMP_29.$$s||this,$binary_op_recvr_tmp_3=nil;return null==self.v&&(self.v=nil),null==self.e&&(self.e=nil),null==self.d&&(self.d=nil),null==k&&(k=nil),$binary_op_recvr_tmp_3=self.v["$[]"](k),$writer=[j,$rb_minus($binary_op_recvr_tmp_3["$[]"](j),$rb_plus($rb_times(f,self.e["$[]"](k)),$rb_times(g,self.d["$[]"](k))))],$send($binary_op_recvr_tmp_3,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_29.$$arity=1,TMP_29)),$writer=[j,self.v["$[]"]($rb_minus(i,1))["$[]"](j)],$send(self.d,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[j,0],$send(self.v["$[]"](i),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_28.$$arity=1,TMP_28))),$writer=[i,h],$send(self.d,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=this,TMP_19.$$arity=1,TMP_19)),$send(0,"upto",[$rb_minus($rb_minus(this.size,1),1)],((TMP_30=function(i){var TMP_31,TMP_32,TMP_35,self=TMP_30.$$s||this,$writer=nil,h=nil;return null==self.v&&(self.v=nil),null==self.size&&(self.size=nil),null==self.d&&(self.d=nil),null==i&&(i=nil),$writer=[i,self.v["$[]"](i)["$[]"](i)],$send(self.v["$[]"]($rb_minus(self.size,1)),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[i,1],$send(self.v["$[]"](i),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],h=self.d["$[]"]($rb_plus(i,1)),$truthy(h["$!="](0))&&($send(0,"upto",[i],((TMP_31=function(k){var self=TMP_31.$$s||this;return null==self.v&&(self.v=nil),null==self.d&&(self.d=nil),null==k&&(k=nil),$writer=[k,$rb_divide(self.v["$[]"](k)["$[]"]($rb_plus(i,1)),h)],$send(self.d,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_31.$$arity=1,TMP_31)),$send(0,"upto",[i],((TMP_32=function(j){var TMP_33,TMP_34,self=TMP_32.$$s||this,g=nil;return null==j&&(j=nil),$send(g=0,"upto",[i],((TMP_33=function(k){var self=TMP_33.$$s||this;return null==self.v&&(self.v=nil),null==k&&(k=nil),g=$rb_plus(g,$rb_times(self.v["$[]"](k)["$[]"]($rb_plus(i,1)),self.v["$[]"](k)["$[]"](j)))}).$$s=self,TMP_33.$$arity=1,TMP_33)),$send(0,"upto",[i],((TMP_34=function(k){var self=TMP_34.$$s||this,$binary_op_recvr_tmp_4=nil;return null==self.v&&(self.v=nil),null==self.d&&(self.d=nil),null==k&&(k=nil),$binary_op_recvr_tmp_4=self.v["$[]"](k),$writer=[j,$rb_minus($binary_op_recvr_tmp_4["$[]"](j),$rb_times(g,self.d["$[]"](k)))],$send($binary_op_recvr_tmp_4,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_34.$$arity=1,TMP_34))}).$$s=self,TMP_32.$$arity=1,TMP_32))),$send(0,"upto",[i],((TMP_35=function(k){var self=TMP_35.$$s||this;return null==self.v&&(self.v=nil),null==k&&(k=nil),$writer=[$rb_plus(i,1),0],$send(self.v["$[]"](k),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_35.$$arity=1,TMP_35))}).$$s=this,TMP_30.$$arity=1,TMP_30)),$send(this.size,"times",[],((TMP_36=function(j){var self=TMP_36.$$s||this,$writer=nil;return null==self.v&&(self.v=nil),null==self.size&&(self.size=nil),null==self.d&&(self.d=nil),null==j&&(j=nil),$writer=[j,self.v["$[]"]($rb_minus(self.size,1))["$[]"](j)],$send(self.d,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[j,0],$send(self.v["$[]"]($rb_minus(self.size,1)),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=this,TMP_36.$$arity=1,TMP_36)),$writer=[$rb_minus(this.size,1),1],$send(this.v["$[]"]($rb_minus(this.size,1)),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[0,0],$send(this.e,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]},TMP_EigenvalueDecomposition_tridiagonalize_17.$$arity=0),Opal.def(self,"$diagonalize",TMP_EigenvalueDecomposition_diagonalize_37=function(){var TMP_38,TMP_39,TMP_43,eps,$writer=nil,f=nil,tst1=nil;return $send(1,"upto",[$rb_minus(this.size,1)],((TMP_38=function(i){var $writer,self=TMP_38.$$s||this;return null==self.e&&(self.e=nil),null==i&&(i=nil),$writer=[$rb_minus(i,1),self.e["$[]"](i)],$send(self.e,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=this,TMP_38.$$arity=1,TMP_38)),$writer=[$rb_minus(this.size,1),0],$send(this.e,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],tst1=f=0,eps=$$$($$($nesting,"Float"),"EPSILON"),$send(this.size,"times",[],((TMP_39=function(l){var TMP_40,TMP_41,lhs,rhs,self=TMP_39.$$s||this,m=nil,iter=nil,g=nil,p=nil,r=nil,dl1=nil,h=nil,c=nil,c2=nil,c3=nil,el1=nil,s=nil,s2=nil;for(null==self.d&&(self.d=nil),null==self.e&&(self.e=nil),null==self.size&&(self.size=nil),null==l&&(l=nil),tst1=[tst1,$rb_plus(self.d["$[]"](l).$abs(),self.e["$[]"](l).$abs())].$max(),m=l;$truthy($rb_lt(m,self.size))&&!$truthy((lhs=self.e["$[]"](m).$abs(),rhs=$rb_times(eps,tst1),"number"==typeof lhs&&"number"==typeof rhs?lhs<=rhs:lhs["$<="](rhs)));)m=$rb_plus(m,1);if($truthy($rb_gt(m,l)))for(iter=0;$truthy($rb_gt(self.e["$[]"](l).$abs(),$rb_times(eps,tst1)));)iter=$rb_plus(iter,1),g=self.d["$[]"](l),p=$rb_divide($rb_minus(self.d["$[]"]($rb_plus(l,1)),g),$rb_times(2,self.e["$[]"](l))),r=$$($nesting,"Math").$hypot(p,1),$truthy($rb_lt(p,0))&&(r=r["$-@"]()),$writer=[l,$rb_divide(self.e["$[]"](l),$rb_plus(p,r))],$send(self.d,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[$rb_plus(l,1),$rb_times(self.e["$[]"](l),$rb_plus(p,r))],$send(self.d,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],dl1=self.d["$[]"]($rb_plus(l,1)),h=$rb_minus(g,self.d["$[]"](l)),$send($rb_plus(l,2),"upto",[$rb_minus(self.size,1)],((TMP_40=function(i){var self=TMP_40.$$s||this;return null==self.d&&(self.d=nil),null==i&&(i=nil),$writer=[i,$rb_minus(self.d["$[]"](i),h)],$send(self.d,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_40.$$arity=1,TMP_40)),f=$rb_plus(f,h),p=self.d["$[]"](m),c3=c2=c=1,el1=self.e["$[]"]($rb_plus(l,1)),s2=s=0,$send($rb_minus(m,1),"downto",[l],((TMP_41=function(i){var TMP_42,self=TMP_41.$$s||this;return null==self.e&&(self.e=nil),null==self.d&&(self.d=nil),null==self.size&&(self.size=nil),null==i&&(i=nil),c3=c2,s2=s,g=$rb_times(c2=c,self.e["$[]"](i)),h=$rb_times(c,p),r=$$($nesting,"Math").$hypot(p,self.e["$[]"](i)),$writer=[$rb_plus(i,1),$rb_times(s,r)],$send(self.e,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],s=$rb_divide(self.e["$[]"](i),r),c=$rb_divide(p,r),p=$rb_minus($rb_times(c,self.d["$[]"](i)),$rb_times(s,g)),$writer=[$rb_plus(i,1),$rb_plus(h,$rb_times(s,$rb_plus($rb_times(c,g),$rb_times(s,self.d["$[]"](i)))))],$send(self.d,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$send(self.size,"times",[],((TMP_42=function(k){var self=TMP_42.$$s||this;return null==self.v&&(self.v=nil),null==k&&(k=nil),h=self.v["$[]"](k)["$[]"]($rb_plus(i,1)),$writer=[$rb_plus(i,1),$rb_plus($rb_times(s,self.v["$[]"](k)["$[]"](i)),$rb_times(c,h))],$send(self.v["$[]"](k),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[i,$rb_minus($rb_times(c,self.v["$[]"](k)["$[]"](i)),$rb_times(s,h))],$send(self.v["$[]"](k),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_42.$$arity=1,TMP_42))}).$$s=self,TMP_41.$$arity=1,TMP_41)),p=$rb_divide($rb_times($rb_times($rb_times($rb_times(s["$-@"](),s2),c3),el1),self.e["$[]"](l)),dl1),$writer=[l,$rb_times(s,p)],$send(self.e,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[l,$rb_times(c,p)],$send(self.d,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)];return $writer=[l,$rb_plus(self.d["$[]"](l),f)],$send(self.d,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[l,0],$send(self.e,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=this,TMP_39.$$arity=1,TMP_39)),$send(0,"upto",[$rb_minus(this.size,2)],((TMP_43=function(i){var TMP_44,TMP_45,self=TMP_43.$$s||this,k=nil,p=nil;return null==self.d&&(self.d=nil),null==self.size&&(self.size=nil),null==i&&(i=nil),k=i,p=self.d["$[]"](i),$send($rb_plus(i,1),"upto",[$rb_minus(self.size,1)],((TMP_44=function(j){var self=TMP_44.$$s||this;return null==self.d&&(self.d=nil),null==j&&(j=nil),$truthy($rb_lt(self.d["$[]"](j),p))?(k=j,p=self.d["$[]"](j)):nil}).$$s=self,TMP_44.$$arity=1,TMP_44)),$truthy(k["$!="](i))?($writer=[k,self.d["$[]"](i)],$send(self.d,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[i,p],$send(self.d,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$send(self.size,"times",[],((TMP_45=function(j){var self=TMP_45.$$s||this;return null==self.v&&(self.v=nil),null==j&&(j=nil),p=self.v["$[]"](j)["$[]"](i),$writer=[i,self.v["$[]"](j)["$[]"](k)],$send(self.v["$[]"](j),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[k,p],$send(self.v["$[]"](j),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_45.$$arity=1,TMP_45))):nil}).$$s=this,TMP_43.$$arity=1,TMP_43))},TMP_EigenvalueDecomposition_diagonalize_37.$$arity=0),Opal.def(self,"$reduce_to_hessenberg",TMP_EigenvalueDecomposition_reduce_to_hessenberg_46=function(){var TMP_47,TMP_56,TMP_58,high;return 0,high=$rb_minus(this.size,1),$send($rb_plus(0,1),"upto",[$rb_minus(high,1)],((TMP_47=function(m){var TMP_48,TMP_49,TMP_50,TMP_53,self=TMP_47.$$s||this,scale=nil,h=nil,g=nil,$writer=nil;return null==self.ort&&(self.ort=nil),null==self.size&&(self.size=nil),null==self.h&&(self.h=nil),null==m&&(m=nil),scale=0,$send(m,"upto",[high],((TMP_48=function(i){var self=TMP_48.$$s||this;return null==self.h&&(self.h=nil),null==i&&(i=nil),scale=$rb_plus(scale,self.h["$[]"](i)["$[]"]($rb_minus(m,1)).$abs())}).$$s=self,TMP_48.$$arity=1,TMP_48)),$truthy(scale["$!="](0))?(h=0,$send(high,"downto",[m],((TMP_49=function(i){var $writer,self=TMP_49.$$s||this;return null==self.h&&(self.h=nil),null==self.ort&&(self.ort=nil),null==i&&(i=nil),$writer=[i,$rb_divide(self.h["$[]"](i)["$[]"]($rb_minus(m,1)),scale)],$send(self.ort,"[]=",Opal.to_a($writer)),$rb_minus($writer.length,1),h=$rb_plus(h,$rb_times(self.ort["$[]"](i),self.ort["$[]"](i)))}).$$s=self,TMP_49.$$arity=1,TMP_49)),g=$$($nesting,"Math").$sqrt(h),$truthy($rb_gt(self.ort["$[]"](m),0))&&(g=g["$-@"]()),h=$rb_minus(h,$rb_times(self.ort["$[]"](m),g)),$writer=[m,$rb_minus(self.ort["$[]"](m),g)],$send(self.ort,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$send(m,"upto",[$rb_minus(self.size,1)],((TMP_50=function(j){var TMP_51,TMP_52,self=TMP_50.$$s||this,f=nil;return null==j&&(j=nil),f=0,$send(high,"downto",[m],((TMP_51=function(i){var self=TMP_51.$$s||this;return null==self.ort&&(self.ort=nil),null==self.h&&(self.h=nil),null==i&&(i=nil),f=$rb_plus(f,$rb_times(self.ort["$[]"](i),self.h["$[]"](i)["$[]"](j)))}).$$s=self,TMP_51.$$arity=1,TMP_51)),f=$rb_divide(f,h),$send(m,"upto",[high],((TMP_52=function(i){var self=TMP_52.$$s||this,$binary_op_recvr_tmp_5=nil;return null==self.h&&(self.h=nil),null==self.ort&&(self.ort=nil),null==i&&(i=nil),$binary_op_recvr_tmp_5=self.h["$[]"](i),$writer=[j,$rb_minus($binary_op_recvr_tmp_5["$[]"](j),$rb_times(f,self.ort["$[]"](i)))],$send($binary_op_recvr_tmp_5,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_52.$$arity=1,TMP_52))}).$$s=self,TMP_50.$$arity=1,TMP_50)),$send(0,"upto",[high],((TMP_53=function(i){var TMP_54,TMP_55,self=TMP_53.$$s||this,f=nil;return null==i&&(i=nil),f=0,$send(high,"downto",[m],((TMP_54=function(j){var self=TMP_54.$$s||this;return null==self.ort&&(self.ort=nil),null==self.h&&(self.h=nil),null==j&&(j=nil),f=$rb_plus(f,$rb_times(self.ort["$[]"](j),self.h["$[]"](i)["$[]"](j)))}).$$s=self,TMP_54.$$arity=1,TMP_54)),f=$rb_divide(f,h),$send(m,"upto",[high],((TMP_55=function(j){var self=TMP_55.$$s||this,$binary_op_recvr_tmp_6=nil;return null==self.h&&(self.h=nil),null==self.ort&&(self.ort=nil),null==j&&(j=nil),$binary_op_recvr_tmp_6=self.h["$[]"](i),$writer=[j,$rb_minus($binary_op_recvr_tmp_6["$[]"](j),$rb_times(f,self.ort["$[]"](j)))],$send($binary_op_recvr_tmp_6,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_55.$$arity=1,TMP_55))}).$$s=self,TMP_53.$$arity=1,TMP_53)),$writer=[m,$rb_times(scale,self.ort["$[]"](m))],$send(self.ort,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[$rb_minus(m,1),$rb_times(scale,g)],$send(self.h["$[]"](m),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]):nil}).$$s=this,TMP_47.$$arity=1,TMP_47)),$send(this.size,"times",[],((TMP_56=function(i){var TMP_57,self=TMP_56.$$s||this;return null==self.size&&(self.size=nil),null==i&&(i=nil),$send(self.size,"times",[],((TMP_57=function(j){var $writer,self=TMP_57.$$s||this;return null==self.v&&(self.v=nil),null==j&&(j=nil),$writer=[j,i["$=="](j)?1:0],$send(self.v["$[]"](i),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_57.$$arity=1,TMP_57))}).$$s=this,TMP_56.$$arity=1,TMP_56)),$send($rb_minus(high,1),"downto",[$rb_plus(0,1)],((TMP_58=function(m){var TMP_59,TMP_60,self=TMP_58.$$s||this;return null==self.h&&(self.h=nil),null==m&&(m=nil),$truthy(self.h["$[]"](m)["$[]"]($rb_minus(m,1))["$!="](0))?($send($rb_plus(m,1),"upto",[high],((TMP_59=function(i){var $writer,self=TMP_59.$$s||this;return null==self.h&&(self.h=nil),null==self.ort&&(self.ort=nil),null==i&&(i=nil),$writer=[i,self.h["$[]"](i)["$[]"]($rb_minus(m,1))],$send(self.ort,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_59.$$arity=1,TMP_59)),$send(m,"upto",[high],((TMP_60=function(j){var TMP_61,TMP_62,self=TMP_60.$$s||this,g=nil;return null==self.ort&&(self.ort=nil),null==self.h&&(self.h=nil),null==j&&(j=nil),g=0,$send(m,"upto",[high],((TMP_61=function(i){var self=TMP_61.$$s||this;return null==self.ort&&(self.ort=nil),null==self.v&&(self.v=nil),null==i&&(i=nil),g=$rb_plus(g,$rb_times(self.ort["$[]"](i),self.v["$[]"](i)["$[]"](j)))}).$$s=self,TMP_61.$$arity=1,TMP_61)),g=$rb_divide($rb_divide(g,self.ort["$[]"](m)),self.h["$[]"](m)["$[]"]($rb_minus(m,1))),$send(m,"upto",[high],((TMP_62=function(i){var $writer,self=TMP_62.$$s||this,$binary_op_recvr_tmp_7=nil;return null==self.v&&(self.v=nil),null==self.ort&&(self.ort=nil),null==i&&(i=nil),$binary_op_recvr_tmp_7=self.v["$[]"](i),$writer=[j,$rb_plus($binary_op_recvr_tmp_7["$[]"](j),$rb_times(g,self.ort["$[]"](i)))],$send($binary_op_recvr_tmp_7,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_62.$$arity=1,TMP_62))}).$$s=self,TMP_60.$$arity=1,TMP_60))):nil}).$$s=this,TMP_58.$$arity=1,TMP_58))},TMP_EigenvalueDecomposition_reduce_to_hessenberg_46.$$arity=0),Opal.def(self,"$hessenberg_to_real_schur",TMP_EigenvalueDecomposition_hessenberg_to_real_schur_63=function(){var TMP_64,TMP_66,TMP_67,TMP_68,TMP_69,TMP_70,TMP_71,TMP_72,TMP_76,TMP_83,TMP_85,nn,eps,n=nil,high=nil,exshift=nil,p=nil,q=nil,r=nil,s=nil,z=nil,norm=nil,iter=nil,l=nil,$writer=nil,w=nil,x=nil,y=nil,m=nil;for(nn=this.size,n=$rb_minus(nn,1),0,high=$rb_minus(nn,1),eps=$$$($$($nesting,"Float"),"EPSILON"),p=q=r=s=z=exshift=0,norm=0,$send(nn,"times",[],((TMP_64=function(i){var $a,TMP_65,self=TMP_64.$$s||this,$writer=nil;return null==self.h&&(self.h=nil),null==self.d&&(self.d=nil),null==self.e&&(self.e=nil),null==i&&(i=nil),$truthy($truthy($a=$rb_lt(i,0))?$a:$rb_gt(i,high))&&($writer=[i,self.h["$[]"](i)["$[]"](i)],$send(self.d,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[i,0],$send(self.e,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]),$send([$rb_minus(i,1),0].$max(),"upto",[$rb_minus(nn,1)],((TMP_65=function(j){var self=TMP_65.$$s||this;return null==self.h&&(self.h=nil),null==j&&(j=nil),norm=$rb_plus(norm,self.h["$[]"](i)["$[]"](j).$abs())}).$$s=self,TMP_65.$$arity=1,TMP_65))}).$$s=this,TMP_64.$$arity=1,TMP_64)),iter=0;$truthy($rb_ge(n,0));){for(l=n;$truthy($rb_gt(l,0))&&(s=$rb_plus(this.h["$[]"]($rb_minus(l,1))["$[]"]($rb_minus(l,1)).$abs(),this.h["$[]"](l)["$[]"](l).$abs()),$truthy(s["$=="](0))&&(s=norm),!$truthy($rb_lt(this.h["$[]"](l)["$[]"]($rb_minus(l,1)).$abs(),$rb_times(eps,s))));)l=$rb_minus(l,1);if($truthy(l["$=="](n)))$writer=[n,$rb_plus(this.h["$[]"](n)["$[]"](n),exshift)],$send(this.h["$[]"](n),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[n,this.h["$[]"](n)["$[]"](n)],$send(this.d,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[n,0],$send(this.e,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],n=$rb_minus(n,1),iter=0;else if($truthy(l["$=="]($rb_minus(n,1))))w=$rb_times(this.h["$[]"](n)["$[]"]($rb_minus(n,1)),this.h["$[]"]($rb_minus(n,1))["$[]"](n)),p=$rb_divide($rb_minus(this.h["$[]"]($rb_minus(n,1))["$[]"]($rb_minus(n,1)),this.h["$[]"](n)["$[]"](n)),2),q=$rb_plus($rb_times(p,p),w),z=$$($nesting,"Math").$sqrt(q.$abs()),$writer=[n,$rb_plus(this.h["$[]"](n)["$[]"](n),exshift)],$send(this.h["$[]"](n),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[$rb_minus(n,1),$rb_plus(this.h["$[]"]($rb_minus(n,1))["$[]"]($rb_minus(n,1)),exshift)],$send(this.h["$[]"]($rb_minus(n,1)),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],x=this.h["$[]"](n)["$[]"](n),$truthy($rb_ge(q,0))?(z=$truthy($rb_ge(p,0))?$rb_plus(p,z):$rb_minus(p,z),$writer=[$rb_minus(n,1),$rb_plus(x,z)],$send(this.d,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[n,this.d["$[]"]($rb_minus(n,1))],$send(this.d,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$truthy(z["$!="](0))&&($writer=[n,$rb_minus(x,$rb_divide(w,z))],$send(this.d,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]),$writer=[$rb_minus(n,1),0],$send(this.e,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[n,0],$send(this.e,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],x=this.h["$[]"](n)["$[]"]($rb_minus(n,1)),s=$rb_plus(x.$abs(),z.$abs()),p=$rb_divide(x,s),q=$rb_divide(z,s),r=$$($nesting,"Math").$sqrt($rb_plus($rb_times(p,p),$rb_times(q,q))),p=$rb_divide(p,r),q=$rb_divide(q,r),$send($rb_minus(n,1),"upto",[$rb_minus(nn,1)],((TMP_66=function(j){var self=TMP_66.$$s||this;return null==self.h&&(self.h=nil),null==j&&(j=nil),z=self.h["$[]"]($rb_minus(n,1))["$[]"](j),$writer=[j,$rb_plus($rb_times(q,z),$rb_times(p,self.h["$[]"](n)["$[]"](j)))],$send(self.h["$[]"]($rb_minus(n,1)),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[j,$rb_minus($rb_times(q,self.h["$[]"](n)["$[]"](j)),$rb_times(p,z))],$send(self.h["$[]"](n),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=this,TMP_66.$$arity=1,TMP_66)),$send(0,"upto",[n],((TMP_67=function(i){var self=TMP_67.$$s||this;return null==self.h&&(self.h=nil),null==i&&(i=nil),z=self.h["$[]"](i)["$[]"]($rb_minus(n,1)),$writer=[$rb_minus(n,1),$rb_plus($rb_times(q,z),$rb_times(p,self.h["$[]"](i)["$[]"](n)))],$send(self.h["$[]"](i),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[n,$rb_minus($rb_times(q,self.h["$[]"](i)["$[]"](n)),$rb_times(p,z))],$send(self.h["$[]"](i),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=this,TMP_67.$$arity=1,TMP_67)),$send(0,"upto",[high],((TMP_68=function(i){var self=TMP_68.$$s||this;return null==self.v&&(self.v=nil),null==i&&(i=nil),z=self.v["$[]"](i)["$[]"]($rb_minus(n,1)),$writer=[$rb_minus(n,1),$rb_plus($rb_times(q,z),$rb_times(p,self.v["$[]"](i)["$[]"](n)))],$send(self.v["$[]"](i),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[n,$rb_minus($rb_times(q,self.v["$[]"](i)["$[]"](n)),$rb_times(p,z))],$send(self.v["$[]"](i),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=this,TMP_68.$$arity=1,TMP_68))):($writer=[$rb_minus(n,1),$rb_plus(x,p)],$send(this.d,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[n,$rb_plus(x,p)],$send(this.d,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[$rb_minus(n,1),z],$send(this.e,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[n,z["$-@"]()],$send(this.e,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]),n=$rb_minus(n,2),iter=0;else{for(x=this.h["$[]"](n)["$[]"](n),w=y=0,$truthy($rb_lt(l,n))&&(y=this.h["$[]"]($rb_minus(n,1))["$[]"]($rb_minus(n,1)),w=$rb_times(this.h["$[]"](n)["$[]"]($rb_minus(n,1)),this.h["$[]"]($rb_minus(n,1))["$[]"](n))),$truthy(iter["$=="](10))&&(exshift=$rb_plus(exshift,x),$send(0,"upto",[n],((TMP_69=function(i){var self=TMP_69.$$s||this,$binary_op_recvr_tmp_8=nil;return null==self.h&&(self.h=nil),null==i&&(i=nil),$binary_op_recvr_tmp_8=self.h["$[]"](i),$writer=[i,$rb_minus($binary_op_recvr_tmp_8["$[]"](i),x)],$send($binary_op_recvr_tmp_8,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=this,TMP_69.$$arity=1,TMP_69)),s=$rb_plus(this.h["$[]"](n)["$[]"]($rb_minus(n,1)).$abs(),this.h["$[]"]($rb_minus(n,1))["$[]"]($rb_minus(n,2)).$abs()),x=y=$rb_times(.75,s),w=$rb_times($rb_times(-.4375,s),s)),$truthy(iter["$=="](30))&&(s=$rb_times(s=$rb_divide($rb_minus(y,x),2),$rb_plus(s,w)),$truthy($rb_gt(s,0))&&(s=$$($nesting,"Math").$sqrt(s),$truthy($rb_lt(y,x))&&(s=s["$-@"]()),s=$rb_minus(x,$rb_divide(w,$rb_plus($rb_divide($rb_minus(y,x),2),s))),$send(0,"upto",[n],((TMP_70=function(i){var self=TMP_70.$$s||this,$binary_op_recvr_tmp_9=nil;return null==self.h&&(self.h=nil),null==i&&(i=nil),$binary_op_recvr_tmp_9=self.h["$[]"](i),$writer=[i,$rb_minus($binary_op_recvr_tmp_9["$[]"](i),s)],$send($binary_op_recvr_tmp_9,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=this,TMP_70.$$arity=1,TMP_70)),exshift=$rb_plus(exshift,s),x=y=w=.964)),iter=$rb_plus(iter,1),m=$rb_minus(n,2);$truthy($rb_ge(m,l))&&(z=this.h["$[]"](m)["$[]"](m),r=$rb_minus(x,z),s=$rb_minus(y,z),p=$rb_plus($rb_divide($rb_minus($rb_times(r,s),w),this.h["$[]"]($rb_plus(m,1))["$[]"](m)),this.h["$[]"](m)["$[]"]($rb_plus(m,1))),q=$rb_minus($rb_minus($rb_minus(this.h["$[]"]($rb_plus(m,1))["$[]"]($rb_plus(m,1)),z),r),s),r=this.h["$[]"]($rb_plus(m,2))["$[]"]($rb_plus(m,1)),s=$rb_plus($rb_plus(p.$abs(),q.$abs()),r.$abs()),p=$rb_divide(p,s),q=$rb_divide(q,s),r=$rb_divide(r,s),!$truthy(m["$=="](l)))&&!$truthy($rb_lt($rb_times(this.h["$[]"](m)["$[]"]($rb_minus(m,1)).$abs(),$rb_plus(q.$abs(),r.$abs())),$rb_times(eps,$rb_times(p.$abs(),$rb_plus($rb_plus(this.h["$[]"]($rb_minus(m,1))["$[]"]($rb_minus(m,1)).$abs(),z.$abs()),this.h["$[]"]($rb_plus(m,1))["$[]"]($rb_plus(m,1)).$abs())))));)m=$rb_minus(m,1);$send($rb_plus(m,2),"upto",[n],((TMP_71=function(i){var self=TMP_71.$$s||this;return null==self.h&&(self.h=nil),null==i&&(i=nil),$writer=[$rb_minus(i,2),0],$send(self.h["$[]"](i),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$truthy($rb_gt(i,$rb_plus(m,2)))?($writer=[$rb_minus(i,3),0],$send(self.h["$[]"](i),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]):nil}).$$s=this,TMP_71.$$arity=1,TMP_71)),$send(m,"upto",[$rb_minus(n,1)],((TMP_72=function(k){var TMP_73,TMP_74,TMP_75,notlast,self=TMP_72.$$s||this;if(null==self.h&&(self.h=nil),null==k&&(k=nil),notlast=k["$!="]($rb_minus(n,1)),$truthy(k["$!="](m))){if(p=self.h["$[]"](k)["$[]"]($rb_minus(k,1)),q=self.h["$[]"]($rb_plus(k,1))["$[]"]($rb_minus(k,1)),r=$truthy(notlast)?self.h["$[]"]($rb_plus(k,2))["$[]"]($rb_minus(k,1)):0,(x=$rb_plus($rb_plus(p.$abs(),q.$abs()),r.$abs()))["$=="](0))return nil;p=$rb_divide(p,x),q=$rb_divide(q,x),r=$rb_divide(r,x)}return s=$$($nesting,"Math").$sqrt($rb_plus($rb_plus($rb_times(p,p),$rb_times(q,q)),$rb_times(r,r))),$truthy($rb_lt(p,0))&&(s=s["$-@"]()),$truthy(s["$!="](0))?($truthy(k["$!="](m))?($writer=[$rb_minus(k,1),$rb_times(s["$-@"](),x)],$send(self.h["$[]"](k),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]):$truthy(l["$!="](m))&&($writer=[$rb_minus(k,1),self.h["$[]"](k)["$[]"]($rb_minus(k,1))["$-@"]()],$send(self.h["$[]"](k),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]),p=$rb_plus(p,s),x=$rb_divide(p,s),y=$rb_divide(q,s),z=$rb_divide(r,s),q=$rb_divide(q,p),r=$rb_divide(r,p),$send(k,"upto",[$rb_minus(nn,1)],((TMP_73=function(j){var self=TMP_73.$$s||this;return null==self.h&&(self.h=nil),null==j&&(j=nil),p=$rb_plus(self.h["$[]"](k)["$[]"](j),$rb_times(q,self.h["$[]"]($rb_plus(k,1))["$[]"](j))),$truthy(notlast)&&(p=$rb_plus(p,$rb_times(r,self.h["$[]"]($rb_plus(k,2))["$[]"](j))),$writer=[j,$rb_minus(self.h["$[]"]($rb_plus(k,2))["$[]"](j),$rb_times(p,z))],$send(self.h["$[]"]($rb_plus(k,2)),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]),$writer=[j,$rb_minus(self.h["$[]"](k)["$[]"](j),$rb_times(p,x))],$send(self.h["$[]"](k),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[j,$rb_minus(self.h["$[]"]($rb_plus(k,1))["$[]"](j),$rb_times(p,y))],$send(self.h["$[]"]($rb_plus(k,1)),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_73.$$arity=1,TMP_73)),$send(0,"upto",[[n,$rb_plus(k,3)].$min()],((TMP_74=function(i){var self=TMP_74.$$s||this;return null==self.h&&(self.h=nil),null==i&&(i=nil),p=$rb_plus($rb_times(x,self.h["$[]"](i)["$[]"](k)),$rb_times(y,self.h["$[]"](i)["$[]"]($rb_plus(k,1)))),$truthy(notlast)&&(p=$rb_plus(p,$rb_times(z,self.h["$[]"](i)["$[]"]($rb_plus(k,2)))),$writer=[$rb_plus(k,2),$rb_minus(self.h["$[]"](i)["$[]"]($rb_plus(k,2)),$rb_times(p,r))],$send(self.h["$[]"](i),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]),$writer=[k,$rb_minus(self.h["$[]"](i)["$[]"](k),p)],$send(self.h["$[]"](i),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[$rb_plus(k,1),$rb_minus(self.h["$[]"](i)["$[]"]($rb_plus(k,1)),$rb_times(p,q))],$send(self.h["$[]"](i),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_74.$$arity=1,TMP_74)),$send(0,"upto",[high],((TMP_75=function(i){var self=TMP_75.$$s||this;return null==self.v&&(self.v=nil),null==i&&(i=nil),p=$rb_plus($rb_times(x,self.v["$[]"](i)["$[]"](k)),$rb_times(y,self.v["$[]"](i)["$[]"]($rb_plus(k,1)))),$truthy(notlast)&&(p=$rb_plus(p,$rb_times(z,self.v["$[]"](i)["$[]"]($rb_plus(k,2)))),$writer=[$rb_plus(k,2),$rb_minus(self.v["$[]"](i)["$[]"]($rb_plus(k,2)),$rb_times(p,r))],$send(self.v["$[]"](i),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]),$writer=[k,$rb_minus(self.v["$[]"](i)["$[]"](k),p)],$send(self.v["$[]"](i),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[$rb_plus(k,1),$rb_minus(self.v["$[]"](i)["$[]"]($rb_plus(k,1)),$rb_times(p,q))],$send(self.v["$[]"](i),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_75.$$arity=1,TMP_75))):nil}).$$s=this,TMP_72.$$arity=1,TMP_72))}}return $truthy(norm["$=="](0))?nil:($send($rb_minus(nn,1),"downto",[0],((TMP_76=function(k){var TMP_77,$c,$d,TMP_80,self=TMP_76.$$s||this,cdivr=nil,cdivi=nil;return null==self.d&&(self.d=nil),null==self.e&&(self.e=nil),null==self.h&&(self.h=nil),null==k&&(k=nil),p=self.d["$[]"](k),q=self.e["$[]"](k),$truthy(q["$=="](0))?($writer=[l=k,1],$send(self.h["$[]"](k),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$send($rb_minus(k,1),"downto",[0],((TMP_77=function(i){var TMP_78,TMP_79,self=TMP_77.$$s||this,t=nil;return null==self.h&&(self.h=nil),null==self.e&&(self.e=nil),null==self.d&&(self.d=nil),null==i&&(i=nil),w=$rb_minus(self.h["$[]"](i)["$[]"](i),p),r=0,$send(l,"upto",[k],((TMP_78=function(j){var self=TMP_78.$$s||this;return null==self.h&&(self.h=nil),null==j&&(j=nil),r=$rb_plus(r,$rb_times(self.h["$[]"](i)["$[]"](j),self.h["$[]"](j)["$[]"](k)))}).$$s=self,TMP_78.$$arity=1,TMP_78)),$truthy($rb_lt(self.e["$[]"](i),0))?(z=w,s=r):(l=i,$truthy(self.e["$[]"](i)["$=="](0))?($writer=$truthy(w["$!="](0))?[k,$rb_divide(r["$-@"](),w)]:[k,$rb_divide(r["$-@"](),$rb_times(eps,norm))],$send(self.h["$[]"](i),"[]=",Opal.to_a($writer))):(x=self.h["$[]"](i)["$[]"]($rb_plus(i,1)),y=self.h["$[]"]($rb_plus(i,1))["$[]"](i),q=$rb_plus($rb_times($rb_minus(self.d["$[]"](i),p),$rb_minus(self.d["$[]"](i),p)),$rb_times(self.e["$[]"](i),self.e["$[]"](i))),t=$rb_divide($rb_minus($rb_times(x,s),$rb_times(z,r)),q),$writer=[k,t],$send(self.h["$[]"](i),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=$truthy($rb_gt(x.$abs(),z.$abs()))?[k,$rb_divide($rb_minus(r["$-@"](),$rb_times(w,t)),x)]:[k,$rb_divide($rb_minus(s["$-@"](),$rb_times(y,t)),z)],$send(self.h["$[]"]($rb_plus(i,1)),"[]=",Opal.to_a($writer))),$writer[$rb_minus($writer.length,1)],t=self.h["$[]"](i)["$[]"](k).$abs(),$truthy($rb_gt($rb_times($rb_times(eps,t),t),1))?$send(i,"upto",[k],((TMP_79=function(j){var self=TMP_79.$$s||this;return null==self.h&&(self.h=nil),null==j&&(j=nil),$writer=[k,$rb_divide(self.h["$[]"](j)["$[]"](k),t)],$send(self.h["$[]"](j),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_79.$$arity=1,TMP_79)):nil)}).$$s=self,TMP_77.$$arity=1,TMP_77))):$truthy($rb_lt(q,0))?(l=$rb_minus(n,1),$truthy($rb_gt(self.h["$[]"](n)["$[]"]($rb_minus(n,1)).$abs(),self.h["$[]"]($rb_minus(n,1))["$[]"](n).$abs()))?($writer=[$rb_minus(n,1),$rb_divide(q,self.h["$[]"](n)["$[]"]($rb_minus(n,1)))],$send(self.h["$[]"]($rb_minus(n,1)),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[n,$rb_divide($rb_minus(self.h["$[]"](n)["$[]"](n),p)["$-@"](),self.h["$[]"](n)["$[]"]($rb_minus(n,1)))]):($d=self.$cdiv(0,self.h["$[]"]($rb_minus(n,1))["$[]"](n)["$-@"](),$rb_minus(self.h["$[]"]($rb_minus(n,1))["$[]"]($rb_minus(n,1)),p),q),$c=Opal.to_ary($d),cdivr=null==$c[0]?nil:$c[0],cdivi=null==$c[1]?nil:$c[1],$writer=[$rb_minus(n,1),cdivr],$send(self.h["$[]"]($rb_minus(n,1)),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[n,cdivi]),$send(self.h["$[]"]($rb_minus(n,1)),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[$rb_minus(n,1),0],$send(self.h["$[]"](n),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[n,1],$send(self.h["$[]"](n),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$send($rb_minus(n,2),"downto",[0],((TMP_80=function(i){var TMP_81,$e,$f,TMP_82,self=TMP_80.$$s||this,ra=nil,sa=nil,vr=nil,vi=nil,t=nil;return null==self.h&&(self.h=nil),null==self.e&&(self.e=nil),null==self.d&&(self.d=nil),null==i&&(i=nil),sa=ra=0,$send(l,"upto",[n],((TMP_81=function(j){var self=TMP_81.$$s||this;return null==self.h&&(self.h=nil),null==j&&(j=nil),ra=$rb_plus(ra,$rb_times(self.h["$[]"](i)["$[]"](j),self.h["$[]"](j)["$[]"]($rb_minus(n,1)))),sa=$rb_plus(sa,$rb_times(self.h["$[]"](i)["$[]"](j),self.h["$[]"](j)["$[]"](n)))}).$$s=self,TMP_81.$$arity=1,TMP_81)),w=$rb_minus(self.h["$[]"](i)["$[]"](i),p),$truthy($rb_lt(self.e["$[]"](i),0))?(z=w,r=ra,s=sa):(l=i,$truthy(self.e["$[]"](i)["$=="](0))?($f=self.$cdiv(ra["$-@"](),sa["$-@"](),w,q),$e=Opal.to_ary($f),cdivr=null==$e[0]?nil:$e[0],cdivi=null==$e[1]?nil:$e[1],$writer=[$rb_minus(n,1),cdivr],$send(self.h["$[]"](i),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[n,cdivi],$send(self.h["$[]"](i),"[]=",Opal.to_a($writer))):(x=self.h["$[]"](i)["$[]"]($rb_plus(i,1)),y=self.h["$[]"]($rb_plus(i,1))["$[]"](i),vr=$rb_minus($rb_plus($rb_times($rb_minus(self.d["$[]"](i),p),$rb_minus(self.d["$[]"](i),p)),$rb_times(self.e["$[]"](i),self.e["$[]"](i))),$rb_times(q,q)),vi=$rb_times($rb_times($rb_minus(self.d["$[]"](i),p),2),q),$truthy(($e=vr["$=="](0))?vi["$=="](0):vr["$=="](0))&&(vr=$rb_times($rb_times(eps,norm),$rb_plus($rb_plus($rb_plus($rb_plus(w.$abs(),q.$abs()),x.$abs()),y.$abs()),z.$abs()))),$f=self.$cdiv($rb_plus($rb_minus($rb_times(x,r),$rb_times(z,ra)),$rb_times(q,sa)),$rb_minus($rb_minus($rb_times(x,s),$rb_times(z,sa)),$rb_times(q,ra)),vr,vi),$e=Opal.to_ary($f),cdivr=null==$e[0]?nil:$e[0],cdivi=null==$e[1]?nil:$e[1],$writer=[$rb_minus(n,1),cdivr],$send(self.h["$[]"](i),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[n,cdivi],$send(self.h["$[]"](i),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$truthy($rb_gt(x.$abs(),$rb_plus(z.$abs(),q.$abs())))?($writer=[$rb_minus(n,1),$rb_divide($rb_plus($rb_minus(ra["$-@"](),$rb_times(w,self.h["$[]"](i)["$[]"]($rb_minus(n,1)))),$rb_times(q,self.h["$[]"](i)["$[]"](n))),x)],$send(self.h["$[]"]($rb_plus(i,1)),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[n,$rb_divide($rb_minus($rb_minus(sa["$-@"](),$rb_times(w,self.h["$[]"](i)["$[]"](n))),$rb_times(q,self.h["$[]"](i)["$[]"]($rb_minus(n,1)))),x)]):($f=self.$cdiv($rb_minus(r["$-@"](),$rb_times(y,self.h["$[]"](i)["$[]"]($rb_minus(n,1)))),$rb_minus(s["$-@"](),$rb_times(y,self.h["$[]"](i)["$[]"](n))),z,q),$e=Opal.to_ary($f),cdivr=null==$e[0]?nil:$e[0],cdivi=null==$e[1]?nil:$e[1],$writer=[$rb_minus(n,1),cdivr],$send(self.h["$[]"]($rb_plus(i,1)),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[n,cdivi]),$send(self.h["$[]"]($rb_plus(i,1)),"[]=",Opal.to_a($writer))),$writer[$rb_minus($writer.length,1)],t=[self.h["$[]"](i)["$[]"]($rb_minus(n,1)).$abs(),self.h["$[]"](i)["$[]"](n).$abs()].$max(),$truthy($rb_gt($rb_times($rb_times(eps,t),t),1))?$send(i,"upto",[n],((TMP_82=function(j){var self=TMP_82.$$s||this;return null==self.h&&(self.h=nil),null==j&&(j=nil),$writer=[$rb_minus(n,1),$rb_divide(self.h["$[]"](j)["$[]"]($rb_minus(n,1)),t)],$send(self.h["$[]"](j),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[n,$rb_divide(self.h["$[]"](j)["$[]"](n),t)],$send(self.h["$[]"](j),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_82.$$arity=1,TMP_82)):nil)}).$$s=self,TMP_80.$$arity=1,TMP_80))):nil}).$$s=this,TMP_76.$$arity=1,TMP_76)),$send(nn,"times",[],((TMP_83=function(i){var $c,TMP_84,self=TMP_83.$$s||this;return null==i&&(i=nil),$truthy($truthy($c=$rb_lt(i,0))?$c:$rb_gt(i,high))?$send(i,"upto",[$rb_minus(nn,1)],((TMP_84=function(j){var self=TMP_84.$$s||this;return null==self.h&&(self.h=nil),null==self.v&&(self.v=nil),null==j&&(j=nil),$writer=[j,self.h["$[]"](i)["$[]"](j)],$send(self.v["$[]"](i),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_84.$$arity=1,TMP_84)):nil}).$$s=this,TMP_83.$$arity=1,TMP_83)),$send($rb_minus(nn,1),"downto",[0],((TMP_85=function(j){var TMP_86,self=TMP_85.$$s||this;return null==j&&(j=nil),$send(0,"upto",[high],((TMP_86=function(i){var TMP_87,self=TMP_86.$$s||this;return null==self.v&&(self.v=nil),null==i&&(i=nil),$send(z=0,"upto",[[j,high].$min()],((TMP_87=function(k){var self=TMP_87.$$s||this;return null==self.v&&(self.v=nil),null==self.h&&(self.h=nil),null==k&&(k=nil),z=$rb_plus(z,$rb_times(self.v["$[]"](i)["$[]"](k),self.h["$[]"](k)["$[]"](j)))}).$$s=self,TMP_87.$$arity=1,TMP_87)),$writer=[j,z],$send(self.v["$[]"](i),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_86.$$arity=1,TMP_86))}).$$s=this,TMP_85.$$arity=1,TMP_85)))},TMP_EigenvalueDecomposition_hessenberg_to_real_schur_63.$$arity=0),nil&&"hessenberg_to_real_schur"}($nesting[0],0,$nesting)}($nesting[0],0,$nesting)},Opal.modules["matrix/lup_decomposition"]=function(Opal){function $rb_gt(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?rhs<lhs:lhs["$>"](rhs)}function $rb_minus(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs-rhs:lhs["$-"](rhs)}function $rb_times(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs*rhs:lhs["$*"](rhs)}function $rb_plus(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs+rhs:lhs["$+"](rhs)}Opal.top;var $nesting=[],nil=Opal.nil,$$$=Opal.const_get_qualified,$$=Opal.const_get_relative,$klass=(Opal.breaker,Opal.slice,Opal.klass),$send=Opal.send,$truthy=Opal.truthy;return Opal.add_stubs(["$include","$build","$min","$>","$[]","$==","$<=","$new","$each_with_index","$[]=","$-","$send","$l","$u","$p","$alias_method","$attr_reader","$times","$!=","$Raise","$*","$singular?","$is_a?","$row_count","$column_count","$map","$to_a","$row","$upto","$+","$downto","$quo","$convert_to_array","$size","$values_at","$elements","$raise","$class","$abs","$-@","$<"]),function($base,$super,$parent_nesting){function $Matrix(){}var self=$Matrix=$klass($base,null,"Matrix",$Matrix),$nesting=(self.prototype,[self].concat($parent_nesting));return function($base,$super,$parent_nesting){function $LUPDecomposition(){}var TMP_LUPDecomposition_l_1,TMP_LUPDecomposition_u_3,TMP_LUPDecomposition_p_5,TMP_LUPDecomposition_to_ary_8,TMP_LUPDecomposition_singular$q_9,TMP_LUPDecomposition_det_11,TMP_LUPDecomposition_solve_13,TMP_LUPDecomposition_initialize_26,self=$LUPDecomposition=$klass($base,null,"LUPDecomposition",$LUPDecomposition),def=self.prototype,$nesting=[self].concat($parent_nesting);return def.row_count=def.column_count=def.pivots=def.pivot_sign=nil,self.$include($$$($$($nesting,"Matrix"),"ConversionHelper")),Opal.def(self,"$l",TMP_LUPDecomposition_l_1=function(){var TMP_2;return $send($$($nesting,"Matrix"),"build",[this.row_count,[this.column_count,this.row_count].$min()],((TMP_2=function(i,j){var self=TMP_2.$$s||this;return null==self.lu&&(self.lu=nil),null==i&&(i=nil),null==j&&(j=nil),$truthy($rb_gt(i,j))?self.lu["$[]"](i)["$[]"](j):$truthy(i["$=="](j))?1:0}).$$s=this,TMP_2.$$arity=2,TMP_2))},TMP_LUPDecomposition_l_1.$$arity=0),Opal.def(self,"$u",TMP_LUPDecomposition_u_3=function(){var TMP_4;return $send($$($nesting,"Matrix"),"build",[[this.column_count,this.row_count].$min(),this.column_count],((TMP_4=function(i,j){var lhs,rhs,self=TMP_4.$$s||this;return null==self.lu&&(self.lu=nil),null==i&&(i=nil),null==j&&(j=nil),$truthy((rhs=j,"number"==typeof(lhs=i)&&"number"==typeof rhs?lhs<=rhs:lhs["$<="](rhs)))?self.lu["$[]"](i)["$[]"](j):0}).$$s=this,TMP_4.$$arity=2,TMP_4))},TMP_LUPDecomposition_u_3.$$arity=0),Opal.def(self,"$p",TMP_LUPDecomposition_p_5=function(){var TMP_6,TMP_7,rows=nil;return rows=$send($$($nesting,"Array"),"new",[this.row_count],((TMP_6=function(){var self=TMP_6.$$s||this;return null==self.row_count&&(self.row_count=nil),$$($nesting,"Array").$new(self.row_count,0)}).$$s=this,TMP_6.$$arity=0,TMP_6)),$send(this.pivots,"each_with_index",[],((TMP_7=function(p,i){var $writer;TMP_7.$$s;return null==p&&(p=nil),null==i&&(i=nil),$writer=[p,1],$send(rows["$[]"](i),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=this,TMP_7.$$arity=2,TMP_7)),$$($nesting,"Matrix").$send("new",rows,this.row_count)},TMP_LUPDecomposition_p_5.$$arity=0),Opal.def(self,"$to_ary",TMP_LUPDecomposition_to_ary_8=function(){return[this.$l(),this.$u(),this.$p()]},TMP_LUPDecomposition_to_ary_8.$$arity=0),self.$alias_method("to_a","to_ary"),self.$attr_reader("pivots"),Opal.def(self,"$singular?",TMP_LUPDecomposition_singular$q_9=function(){try{var TMP_10;return $send(this.column_count,"times",[],((TMP_10=function(j){var self=TMP_10.$$s||this;if(null==self.lu&&(self.lu=nil),null==j&&(j=nil),!$truthy(self.lu["$[]"](j)["$[]"](j)["$=="](0)))return nil;Opal.ret(!0)}).$$s=this,TMP_10.$$arity=1,TMP_10)),!1}catch($returner){if($returner===Opal.returner)return $returner.$v;throw $returner}},TMP_LUPDecomposition_singular$q_9.$$arity=0),Opal.def(self,"$det",TMP_LUPDecomposition_det_11=function(){var TMP_12,d=nil;return $truthy(this.row_count["$!="](this.column_count))&&$$($nesting,"Matrix").$Raise($$$($$($nesting,"Matrix"),"ErrDimensionMismatch")),d=this.pivot_sign,$send(this.column_count,"times",[],((TMP_12=function(j){var self=TMP_12.$$s||this;return null==self.lu&&(self.lu=nil),null==j&&(j=nil),d=$rb_times(d,self.lu["$[]"](j)["$[]"](j))}).$$s=this,TMP_12.$$arity=1,TMP_12)),d},TMP_LUPDecomposition_det_11.$$arity=0),self.$alias_method("determinant","det"),Opal.def(self,"$solve",TMP_LUPDecomposition_solve_13=function(b){var TMP_14,TMP_15,TMP_18,TMP_22,TMP_24,nx=nil,m=nil;return $truthy(this["$singular?"]())&&$$($nesting,"Matrix").$Raise($$$($$($nesting,"Matrix"),"ErrNotRegular"),"Matrix is singular."),$truthy(b["$is_a?"]($$($nesting,"Matrix")))?($truthy(b.$row_count()["$!="](this.row_count))&&$$($nesting,"Matrix").$Raise($$$($$($nesting,"Matrix"),"ErrDimensionMismatch")),nx=b.$column_count(),m=$send(this.pivots,"map",[],((TMP_14=function(row){TMP_14.$$s;return null==row&&(row=nil),b.$row(row).$to_a()}).$$s=this,TMP_14.$$arity=1,TMP_14)),$send(this.column_count,"times",[],((TMP_15=function(k){var TMP_16,self=TMP_15.$$s||this;return null==self.column_count&&(self.column_count=nil),null==k&&(k=nil),$send($rb_plus(k,1),"upto",[$rb_minus(self.column_count,1)],((TMP_16=function(i){var TMP_17,self=TMP_16.$$s||this;return null==i&&(i=nil),$send(nx,"times",[],((TMP_17=function(j){var $writer,self=TMP_17.$$s||this,$binary_op_recvr_tmp_10=nil;return null==self.lu&&(self.lu=nil),null==j&&(j=nil),$writer=[j,$rb_minus(($binary_op_recvr_tmp_10=m["$[]"](i))["$[]"](j),$rb_times(m["$[]"](k)["$[]"](j),self.lu["$[]"](i)["$[]"](k)))],$send($binary_op_recvr_tmp_10,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_17.$$arity=1,TMP_17))}).$$s=self,TMP_16.$$arity=1,TMP_16))}).$$s=this,TMP_15.$$arity=1,TMP_15)),$send($rb_minus(this.column_count,1),"downto",[0],((TMP_18=function(k){var TMP_19,TMP_20,self=TMP_18.$$s||this;return null==k&&(k=nil),$send(nx,"times",[],((TMP_19=function(j){var $writer,self=TMP_19.$$s||this;return null==self.lu&&(self.lu=nil),null==j&&(j=nil),$writer=[j,m["$[]"](k)["$[]"](j).$quo(self.lu["$[]"](k)["$[]"](k))],$send(m["$[]"](k),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_19.$$arity=1,TMP_19)),$send(k,"times",[],((TMP_20=function(i){var TMP_21,self=TMP_20.$$s||this;return null==i&&(i=nil),$send(nx,"times",[],((TMP_21=function(j){var $writer,self=TMP_21.$$s||this,$binary_op_recvr_tmp_11=nil;return null==self.lu&&(self.lu=nil),null==j&&(j=nil),$writer=[j,$rb_minus(($binary_op_recvr_tmp_11=m["$[]"](i))["$[]"](j),$rb_times(m["$[]"](k)["$[]"](j),self.lu["$[]"](i)["$[]"](k)))],$send($binary_op_recvr_tmp_11,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_21.$$arity=1,TMP_21))}).$$s=self,TMP_20.$$arity=1,TMP_20))}).$$s=this,TMP_18.$$arity=1,TMP_18)),$$($nesting,"Matrix").$send("new",m,nx)):(b=this.$convert_to_array(b),$truthy(b.$size()["$!="](this.row_count))&&$$($nesting,"Matrix").$Raise($$$($$($nesting,"Matrix"),"ErrDimensionMismatch")),m=$send(b,"values_at",Opal.to_a(this.pivots)),$send(this.column_count,"times",[],((TMP_22=function(k){var TMP_23,self=TMP_22.$$s||this;return null==self.column_count&&(self.column_count=nil),null==k&&(k=nil),$send($rb_plus(k,1),"upto",[$rb_minus(self.column_count,1)],((TMP_23=function(i){var $writer,self=TMP_23.$$s||this;return null==self.lu&&(self.lu=nil),null==i&&(i=nil),$writer=[i,$rb_minus(m["$[]"](i),$rb_times(m["$[]"](k),self.lu["$[]"](i)["$[]"](k)))],$send(m,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_23.$$arity=1,TMP_23))}).$$s=this,TMP_22.$$arity=1,TMP_22)),$send($rb_minus(this.column_count,1),"downto",[0],((TMP_24=function(k){var TMP_25,self=TMP_24.$$s||this,$writer=nil;return null==self.lu&&(self.lu=nil),null==k&&(k=nil),$writer=[k,m["$[]"](k).$quo(self.lu["$[]"](k)["$[]"](k))],$send(m,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$send(k,"times",[],((TMP_25=function(i){var self=TMP_25.$$s||this;return null==self.lu&&(self.lu=nil),null==i&&(i=nil),$writer=[i,$rb_minus(m["$[]"](i),$rb_times(m["$[]"](k),self.lu["$[]"](i)["$[]"](k)))],$send(m,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_25.$$arity=1,TMP_25))}).$$s=this,TMP_24.$$arity=1,TMP_24)),$$($nesting,"Vector").$elements(m,!1))},TMP_LUPDecomposition_solve_13.$$arity=1),Opal.def(self,"$initialize",TMP_LUPDecomposition_initialize_26=function(a){var TMP_27,TMP_28,lu_col_j=nil;return $truthy(a["$is_a?"]($$($nesting,"Matrix")))||this.$raise($$($nesting,"TypeError"),"Expected Matrix but got "+a.$class()),this.lu=a.$to_a(),this.row_count=a.$row_count(),this.column_count=a.$column_count(),this.pivots=$$($nesting,"Array").$new(this.row_count),$send(this.row_count,"times",[],((TMP_27=function(i){var $writer,self=TMP_27.$$s||this;return null==self.pivots&&(self.pivots=nil),null==i&&(i=nil),$writer=[i,i],$send(self.pivots,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=this,TMP_27.$$arity=1,TMP_27)),this.pivot_sign=1,lu_col_j=$$($nesting,"Array").$new(this.row_count),$send(this.column_count,"times",[],((TMP_28=function(j){var TMP_29,TMP_30,TMP_32,TMP_33,$a,TMP_34,lhs,rhs,self=TMP_28.$$s||this,p=nil,k=nil,$writer=nil;return null==self.row_count&&(self.row_count=nil),null==self.column_count&&(self.column_count=nil),null==self.pivots&&(self.pivots=nil),null==self.pivot_sign&&(self.pivot_sign=nil),null==self.lu&&(self.lu=nil),null==j&&(j=nil),$send(self.row_count,"times",[],((TMP_29=function(i){var $writer,self=TMP_29.$$s||this;return null==self.lu&&(self.lu=nil),null==i&&(i=nil),$writer=[i,self.lu["$[]"](i)["$[]"](j)],$send(lu_col_j,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_29.$$arity=1,TMP_29)),$send(self.row_count,"times",[],((TMP_30=function(i){var TMP_31,kmax,self=TMP_30.$$s||this,lu_row_i=nil,s=nil,$writer=nil;return null==self.lu&&(self.lu=nil),null==i&&(i=nil),lu_row_i=self.lu["$[]"](i),kmax=[i,j].$min(),s=0,$send(kmax,"times",[],((TMP_31=function(k){TMP_31.$$s;return null==k&&(k=nil),s=$rb_plus(s,$rb_times(lu_row_i["$[]"](k),lu_col_j["$[]"](k)))}).$$s=self,TMP_31.$$arity=1,TMP_31)),$writer=[j,($writer=[i,$rb_minus(lu_col_j["$[]"](i),s)],$send(lu_col_j,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)])],$send(lu_row_i,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_30.$$arity=1,TMP_30)),$send($rb_plus(p=j,1),"upto",[$rb_minus(self.row_count,1)],((TMP_32=function(i){TMP_32.$$s;return null==i&&(i=nil),$truthy($rb_gt(lu_col_j["$[]"](i).$abs(),lu_col_j["$[]"](p).$abs()))?p=i:nil}).$$s=self,TMP_32.$$arity=1,TMP_32)),$truthy(p["$!="](j))&&($send(self.column_count,"times",[],((TMP_33=function(k){var t,self=TMP_33.$$s||this,$writer=nil;return null==self.lu&&(self.lu=nil),null==k&&(k=nil),t=self.lu["$[]"](p)["$[]"](k),$writer=[k,self.lu["$[]"](j)["$[]"](k)],$send(self.lu["$[]"](p),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[k,t],$send(self.lu["$[]"](j),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_33.$$arity=1,TMP_33)),k=self.pivots["$[]"](p),$writer=[p,self.pivots["$[]"](j)],$send(self.pivots,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[j,k],$send(self.pivots,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],self.pivot_sign=self.pivot_sign["$-@"]()),$truthy($truthy((lhs=j,rhs=self.row_count,$a="number"==typeof lhs&&"number"==typeof rhs?lhs<rhs:lhs["$<"](rhs)))?self.lu["$[]"](j)["$[]"](j)["$!="](0):$a)?$send($rb_plus(j,1),"upto",[$rb_minus(self.row_count,1)],((TMP_34=function(i){var self=TMP_34.$$s||this;return null==self.lu&&(self.lu=nil),null==i&&(i=nil),$writer=[j,self.lu["$[]"](i)["$[]"](j).$quo(self.lu["$[]"](j)["$[]"](j))],$send(self.lu["$[]"](i),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_34.$$arity=1,TMP_34)):nil}).$$s=this,TMP_28.$$arity=1,TMP_28))},TMP_LUPDecomposition_initialize_26.$$arity=1),nil&&"initialize"}($nesting[0],0,$nesting)}($nesting[0],0,$nesting)},Opal.modules.matrix=function(Opal){function $rb_lt(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs<rhs:lhs["$<"](rhs)}function $rb_minus(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs-rhs:lhs["$-"](rhs)}function $rb_times(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs*rhs:lhs["$*"](rhs)}function $rb_plus(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs+rhs:lhs["$+"](rhs)}function $rb_ge(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?rhs<=lhs:lhs["$>="](rhs)}function $rb_gt(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?rhs<lhs:lhs["$>"](rhs)}function $rb_le(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs<=rhs:lhs["$<="](rhs)}function $rb_divide(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs/rhs:lhs["$/"](rhs)}var self=Opal.top,$nesting=[],nil=Opal.nil,$$$=Opal.const_get_qualified,$$=Opal.const_get_relative,$module=(Opal.breaker,Opal.slice,Opal.module),$klass=Opal.klass,$send=Opal.send,$truthy=Opal.truthy,$hash2=Opal.hash2;return Opal.add_stubs(["$require","$extend","$def_e2message","$def_exception","$include","$autoload","$private_class_method","$attr_reader","$protected","$rows","$convert_to_array","$map!","$size","$[]","$each","$==","$raise","$new","$transpose","$coerce_to_int","$<","$to_enum","$empty","$[]=","$-","$diagonal","$scalar","$!=","$*","$coerce_to_matrix","$map","$send","$to_proc","$column_count","$concat","$row_count","$each_with_index","$+","$empty?","$method","$first","$Raise","$combine","$class","$private","$fetch","$alias_method","$elements","$>=","$-@","$times","$collect","$new_matrix","$===","$upto","$min","$inspect","$freeze","$>","$include?","$last","$pop","$end","$exclude_end?","$<=","$to_a","$delete_at","$square?","$determinant","$first_minor","$**","$build","$cofactor","$!","$inject","$with_index","$all?","$conj","$singular?","$eql?","$hash","$column_vector","$column","$apply_through_coercion","$/","$inverse","$I","$abs","$quo","$identity","$loop","$zero?","$>>","$eigensystem","$+@","$determinant_bareiss","$find","$warn","$hstack","$rank","$round","$vstack","$real","$imag","$row","$join","$to_s","$dup","$to_ary","$message","$is_a?","$coerce","$length","$public_send","$kind_of?","$respond_to?","$__send__","$coerce_to","$count","$independent?","$collect2","$each2","$basis","$laplace_expansion","$sqrt","$abs2","$magnitude","$acos","$inner_product","$row_vector"]),self.$require("e2mmap.rb"),function($base,$parent_nesting){function $ExceptionForMatrix(){}var self=$ExceptionForMatrix=$module($base,"ExceptionForMatrix",$ExceptionForMatrix),$nesting=(self.prototype,[self].concat($parent_nesting));self.$extend($$($nesting,"Exception2MessageMapper")),self.$def_e2message($$($nesting,"TypeError"),"wrong argument type %s (expected %s)"),self.$def_e2message($$($nesting,"ArgumentError"),"Wrong # of arguments(%d for %d)"),self.$def_exception("ErrDimensionMismatch","#{self.name} dimension mismatch"),self.$def_exception("ErrNotRegular","Not Regular Matrix"),self.$def_exception("ErrOperationNotDefined","Operation(%s) can\\'t be defined: %s op %s"),self.$def_exception("ErrOperationNotImplemented","Sorry, Operation(%s) not implemented: %s op %s")}($nesting[0],$nesting),function($base,$super,$parent_nesting){function $Matrix(){}var TMP_Matrix_$$_1,TMP_Matrix_rows_2,TMP_Matrix_columns_5,TMP_Matrix_build_6,TMP_Matrix_diagonal_9,TMP_Matrix_scalar_11,TMP_Matrix_identity_12,TMP_Matrix_zero_13,TMP_Matrix_row_vector_15,TMP_Matrix_column_vector_16,TMP_Matrix_empty_17,TMP_Matrix_vstack_18,TMP_Matrix_hstack_20,TMP_Matrix_combine_23,TMP_Matrix_combine_28,TMP_Matrix_initialize_29,TMP_Matrix_new_matrix_30,TMP_Matrix_$$_31,TMP_Matrix_$$$eq_33,TMP_Matrix_row_count_34,TMP_Matrix_row_35,TMP_Matrix_column_38,TMP_Matrix_collect_41,TMP_Matrix_each_43,TMP_Matrix_each_with_index_57,TMP_Matrix_index_72,TMP_Matrix_minor_75,TMP_Matrix_first_minor_77,TMP_Matrix_cofactor_79,TMP_Matrix_adjugate_80,TMP_Matrix_laplace_expansion_82,TMP_Matrix_diagonal$q_84,TMP_Matrix_empty$q_85,TMP_Matrix_hermitian$q_86,TMP_Matrix_lower_triangular$q_88,TMP_Matrix_normal$q_89,TMP_Matrix_orthogonal$q_93,TMP_Matrix_permutation$q_97,TMP_Matrix_real$q_100,TMP_Matrix_regular$q_101,TMP_Matrix_singular$q_102,TMP_Matrix_square$q_103,TMP_Matrix_symmetric$q_104,TMP_Matrix_antisymmetric$q_106,TMP_Matrix_unitary$q_108,TMP_Matrix_upper_triangular$q_112,TMP_Matrix_zero$q_113,TMP_Matrix_$eq$eq_114,TMP_Matrix_eql$q_115,TMP_Matrix_clone_116,TMP_Matrix_hash_117,TMP_Matrix_$_118,TMP_Matrix_$_124,TMP_Matrix_$_127,TMP_Matrix_$_130,TMP_Matrix_hadamard_product_133,TMP_Matrix_inverse_135,TMP_Matrix_inverse_from_136,TMP_Matrix_$$_144,TMP_Matrix_$$_147,TMP_Matrix_$$_148,TMP_Matrix_determinant_150,TMP_Matrix_determinant_bareiss_151,TMP_Matrix_determinant_e_157,TMP_Matrix_hstack_158,TMP_Matrix_rank_159,TMP_Matrix_rank_e_164,TMP_Matrix_round_165,TMP_Matrix_trace_167,TMP_Matrix_transpose_169,TMP_Matrix_vstack_170,TMP_Matrix_eigensystem_171,TMP_Matrix_lup_172,TMP_Matrix_conjugate_173,TMP_Matrix_imaginary_174,TMP_Matrix_real_175,TMP_Matrix_rect_176,TMP_Matrix_coerce_177,TMP_Matrix_row_vectors_178,TMP_Matrix_column_vectors_180,TMP_Matrix_to_matrix_182,TMP_Matrix_to_a_183,TMP_Matrix_elements_to_f_184,TMP_Matrix_elements_to_i_185,TMP_Matrix_elements_to_r_186,TMP_Matrix_to_s_187,TMP_Matrix_inspect_190,self=$Matrix=$klass($base,null,"Matrix",$Matrix),def=self.prototype,$nesting=[self].concat($parent_nesting);def.rows=nil,self.$include($$($nesting,"Enumerable")),self.$include($$($nesting,"ExceptionForMatrix")),self.$autoload("EigenvalueDecomposition","matrix/eigenvalue_decomposition"),self.$autoload("LUPDecomposition","matrix/lup_decomposition"),self.$private_class_method("new"),self.$attr_reader("rows"),self.$protected("rows"),Opal.defs($$($nesting,"Matrix"),"$[]",TMP_Matrix_$$_1=function($a){var rows;return rows=Opal.slice.call(arguments,0,arguments.length),this.$rows(rows,!1)},TMP_Matrix_$$_1.$$arity=-1),Opal.defs($$($nesting,"Matrix"),"$rows",TMP_Matrix_rows_2=function(rows,copy){var TMP_3,$a,TMP_4,size;return null==copy&&(copy=!0),rows=this.$convert_to_array(rows,copy),$send(rows,"map!",[],((TMP_3=function(row){var self=TMP_3.$$s||this;return null==row&&(row=nil),self.$convert_to_array(row,copy)}).$$s=this,TMP_3.$$arity=1,TMP_3)),size=($truthy($a=rows["$[]"](0))?$a:[]).$size(),$send(rows,"each",[],((TMP_4=function(row){var self=TMP_4.$$s||this;return null==row&&(row=nil),row.$size()["$=="](size)?nil:self.$raise($$($nesting,"ErrDimensionMismatch"),"row size differs ("+row.$size()+" should be "+size+")")}).$$s=this,TMP_4.$$arity=1,TMP_4)),this.$new(rows,size)},TMP_Matrix_rows_2.$$arity=-2),Opal.defs($$($nesting,"Matrix"),"$columns",TMP_Matrix_columns_5=function(columns){return this.$rows(columns,!1).$transpose()},TMP_Matrix_columns_5.$$arity=1),Opal.defs($$($nesting,"Matrix"),"$build",TMP_Matrix_build_6=function(row_count,column_count){var $a,TMP_7,rows,$iter=TMP_Matrix_build_6.$$p,$yield=$iter||nil;return $iter&&(TMP_Matrix_build_6.$$p=null),null==column_count&&(column_count=row_count),row_count=$$($nesting,"CoercionHelper").$coerce_to_int(row_count),column_count=$$($nesting,"CoercionHelper").$coerce_to_int(column_count),$truthy($truthy($a=$rb_lt(row_count,0))?$a:$rb_lt(column_count,0))&&this.$raise($$($nesting,"ArgumentError")),$yield===nil?this.$to_enum("build",row_count,column_count):(rows=$send($$($nesting,"Array"),"new",[row_count],((TMP_7=function(i){var TMP_8,self=TMP_7.$$s||this;return null==i&&(i=nil),$send($$($nesting,"Array"),"new",[column_count],((TMP_8=function(j){TMP_8.$$s;return null==j&&(j=nil),Opal.yieldX($yield,[i,j])}).$$s=self,TMP_8.$$arity=1,TMP_8))}).$$s=this,TMP_7.$$arity=1,TMP_7)),this.$new(rows,column_count))},TMP_Matrix_build_6.$$arity=-2),Opal.defs($$($nesting,"Matrix"),"$diagonal",TMP_Matrix_diagonal_9=function($a){var $post_args,values,TMP_10,rows,size=nil;return $post_args=Opal.slice.call(arguments,0,arguments.length),(size=(values=$post_args).$size())["$=="](0)?$$($nesting,"Matrix").$empty():(rows=$send($$($nesting,"Array"),"new",[size],((TMP_10=function(j){var row,$writer;TMP_10.$$s;return null==j&&(j=nil),row=$$($nesting,"Array").$new(size,0),$writer=[j,values["$[]"](j)],$send(row,"[]=",Opal.to_a($writer)),$rb_minus($writer.length,1),row}).$$s=this,TMP_10.$$arity=1,TMP_10)),this.$new(rows))},TMP_Matrix_diagonal_9.$$arity=-1),Opal.defs($$($nesting,"Matrix"),"$scalar",TMP_Matrix_scalar_11=function(n,value){return $send(this,"diagonal",Opal.to_a($$($nesting,"Array").$new(n,value)))},TMP_Matrix_scalar_11.$$arity=2),Opal.defs($$($nesting,"Matrix"),"$identity",TMP_Matrix_identity_12=function(n){return this.$scalar(n,1)},TMP_Matrix_identity_12.$$arity=1),function(self,$parent_nesting){self.prototype,[self].concat($parent_nesting);Opal.alias(self,"unit","identity"),Opal.alias(self,"I","identity")}(Opal.get_singleton_class($$($nesting,"Matrix")),$nesting),Opal.defs($$($nesting,"Matrix"),"$zero",TMP_Matrix_zero_13=function(row_count,column_count){var TMP_14,rows;return null==column_count&&(column_count=row_count),rows=$send($$($nesting,"Array"),"new",[row_count],((TMP_14=function(){TMP_14.$$s;return $$($nesting,"Array").$new(column_count,0)}).$$s=this,TMP_14.$$arity=0,TMP_14)),this.$new(rows,column_count)},TMP_Matrix_zero_13.$$arity=-2),Opal.defs($$($nesting,"Matrix"),"$row_vector",TMP_Matrix_row_vector_15=function(row){return row=this.$convert_to_array(row),this.$new([row])},TMP_Matrix_row_vector_15.$$arity=1),Opal.defs($$($nesting,"Matrix"),"$column_vector",TMP_Matrix_column_vector_16=function(column){return column=this.$convert_to_array(column),this.$new([column].$transpose(),1)},TMP_Matrix_column_vector_16.$$arity=1),Opal.defs($$($nesting,"Matrix"),"$empty",TMP_Matrix_empty_17=function(row_count,column_count){var $a;return null==row_count&&(row_count=0),null==column_count&&(column_count=0),$truthy($truthy($a=column_count["$!="](0))?row_count["$!="](0):$a)&&this.$raise($$($nesting,"ArgumentError"),"One size must be 0"),$truthy($truthy($a=$rb_lt(column_count,0))?$a:$rb_lt(row_count,0))&&this.$raise($$($nesting,"ArgumentError"),"Negative size"),this.$new($rb_times([[]],row_count),column_count)},TMP_Matrix_empty_17.$$arity=-1),Opal.defs($$($nesting,"Matrix"),"$vstack",TMP_Matrix_vstack_18=function(x,$a){var matrices,TMP_19,result=nil;return matrices=Opal.slice.call(arguments,1,arguments.length),x=$$($nesting,"CoercionHelper").$coerce_to_matrix(x),result=$send(x.$send("rows"),"map",[],"dup".$to_proc()),$send(matrices,"each",[],((TMP_19=function(m){var self=TMP_19.$$s||this;return null==m&&(m=nil),m=$$($nesting,"CoercionHelper").$coerce_to_matrix(m),$truthy(m.$column_count()["$!="](x.$column_count()))&&self.$raise($$($nesting,"ErrDimensionMismatch"),"The given matrices must have "+x.$column_count()+" columns, but one has "+m.$column_count()),result.$concat(m.$send("rows"))}).$$s=this,TMP_19.$$arity=1,TMP_19)),this.$new(result,x.$column_count())},TMP_Matrix_vstack_18.$$arity=-2),Opal.defs($$($nesting,"Matrix"),"$hstack",TMP_Matrix_hstack_20=function(x,$a){var matrices,TMP_21,result,total_column_count=nil;return matrices=Opal.slice.call(arguments,1,arguments.length),x=$$($nesting,"CoercionHelper").$coerce_to_matrix(x),result=$send(x.$send("rows"),"map",[],"dup".$to_proc()),total_column_count=x.$column_count(),$send(matrices,"each",[],((TMP_21=function(m){var TMP_22,self=TMP_21.$$s||this;return null==m&&(m=nil),m=$$($nesting,"CoercionHelper").$coerce_to_matrix(m),$truthy(m.$row_count()["$!="](x.$row_count()))&&self.$raise($$($nesting,"ErrDimensionMismatch"),"The given matrices must have "+x.$row_count()+" rows, but one has "+m.$row_count()),$send(result,"each_with_index",[],((TMP_22=function(row,i){TMP_22.$$s;return null==row&&(row=nil),null==i&&(i=nil),row.$concat(m.$send("rows")["$[]"](i))}).$$s=self,TMP_22.$$arity=2,TMP_22)),total_column_count=$rb_plus(total_column_count,m.$column_count())}).$$s=this,TMP_21.$$arity=1,TMP_21)),this.$new(result,total_column_count)},TMP_Matrix_hstack_20.$$arity=-2),Opal.defs($$($nesting,"Matrix"),"$combine",TMP_Matrix_combine_23=function($a){var $post_args,matrices,TMP_24,TMP_25,rows,$iter=TMP_Matrix_combine_23.$$p,$yield=$iter||nil,x=nil;return $iter&&(TMP_Matrix_combine_23.$$p=null),$post_args=Opal.slice.call(arguments,0,arguments.length),matrices=$post_args,$yield===nil?$send(this,"to_enum",["combine"].concat(Opal.to_a(matrices))):$truthy(matrices["$empty?"]())?$$($nesting,"Matrix").$empty():($send(matrices,"map!",[],$$($nesting,"CoercionHelper").$method("coerce_to_matrix").$to_proc()),x=matrices.$first(),$send(matrices,"each",[],((TMP_24=function(m){TMP_24.$$s;return null==m&&(m=nil),$truthy(x.$row_count()["$=="](m.$row_count())?x.$column_count()["$=="](m.$column_count()):x.$row_count()["$=="](m.$row_count()))?nil:$$($nesting,"Matrix").$Raise($$($nesting,"ErrDimensionMismatch"))}).$$s=this,TMP_24.$$arity=1,TMP_24)),rows=$send($$($nesting,"Array"),"new",[x.$row_count()],((TMP_25=function(i){var TMP_26,self=TMP_25.$$s||this;return null==i&&(i=nil),$send($$($nesting,"Array"),"new",[x.$column_count()],((TMP_26=function(j){var TMP_27,self=TMP_26.$$s||this;return null==j&&(j=nil),Opal.yield1($yield,$send(matrices,"map",[],((TMP_27=function(m){TMP_27.$$s;return null==m&&(m=nil),m["$[]"](i,j)}).$$s=self,TMP_27.$$arity=1,TMP_27)))}).$$s=self,TMP_26.$$arity=1,TMP_26))}).$$s=this,TMP_25.$$arity=1,TMP_25)),this.$new(rows,x.$column_count()))},TMP_Matrix_combine_23.$$arity=-1),Opal.def(self,"$combine",TMP_Matrix_combine_28=function($a){var matrices,$iter=TMP_Matrix_combine_28.$$p,block=$iter||nil,self=this;return $iter&&(TMP_Matrix_combine_28.$$p=null),$iter&&(TMP_Matrix_combine_28.$$p=null),matrices=Opal.slice.call(arguments,0,arguments.length),$send($$($nesting,"Matrix"),"combine",[self].concat(Opal.to_a(matrices)),block.$to_proc())},TMP_Matrix_combine_28.$$arity=-1),Opal.def(self,"$initialize",TMP_Matrix_initialize_29=function(rows,column_count){return null==column_count&&(column_count=rows["$[]"](0).$size()),this.rows=rows,this.column_count=column_count},TMP_Matrix_initialize_29.$$arity=-2),Opal.def(self,"$new_matrix",TMP_Matrix_new_matrix_30=function(rows,column_count){return null==column_count&&(column_count=rows["$[]"](0).$size()),this.$class().$send("new",rows,column_count)},TMP_Matrix_new_matrix_30.$$arity=-2),self.$private("new_matrix"),Opal.def(self,"$[]",TMP_Matrix_$$_31=function(i,j){try{var TMP_32;return $send(this.rows,"fetch",[i],(TMP_32=function(){TMP_32.$$s;Opal.ret(nil)},TMP_32.$$s=this,TMP_32.$$arity=0,TMP_32))["$[]"](j)}catch($returner){if($returner===Opal.returner)return $returner.$v;throw $returner}},TMP_Matrix_$$_31.$$arity=2),Opal.alias(self,"element","[]"),Opal.alias(self,"component","[]"),Opal.def(self,"$[]=",TMP_Matrix_$$$eq_33=function(i,j,v){var $writer;return $writer=[j,v],$send(this.rows["$[]"](i),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]},TMP_Matrix_$$$eq_33.$$arity=3),Opal.alias(self,"set_element","[]="),Opal.alias(self,"set_component","[]="),self.$private("[]=","set_element","set_component"),Opal.def(self,"$row_count",TMP_Matrix_row_count_34=function(){return this.rows.$size()},TMP_Matrix_row_count_34.$$arity=0),self.$alias_method("row_size","row_count"),self.$attr_reader("column_count"),self.$alias_method("column_size","column_count"),Opal.def(self,"$row",TMP_Matrix_row_35=function(i){try{var TMP_36,TMP_37,$iter=TMP_Matrix_row_35.$$p,block=$iter||nil;return $iter&&(TMP_Matrix_row_35.$$p=null),$iter&&(TMP_Matrix_row_35.$$p=null),block!==nil?($send($send(this.rows,"fetch",[i],((TMP_36=function(){var self=TMP_36.$$s||this;Opal.ret(self)}).$$s=this,TMP_36.$$arity=0,TMP_36)),"each",[],block.$to_proc()),this):$$($nesting,"Vector").$elements($send(this.rows,"fetch",[i],((TMP_37=function(){TMP_37.$$s;Opal.ret(nil)}).$$s=this,TMP_37.$$arity=0,TMP_37)))}catch($returner){if($returner===Opal.returner)return $returner.$v;throw $returner}},TMP_Matrix_row_35.$$arity=1),Opal.def(self,"$column",TMP_Matrix_column_38=function(j){var $a,TMP_39,TMP_40,$iter=TMP_Matrix_column_38.$$p,$yield=$iter||nil,col=nil;return $iter&&(TMP_Matrix_column_38.$$p=null),$yield!==nil?($truthy($truthy($a=$rb_ge(j,this.$column_count()))?$a:$rb_lt(j,this.$column_count()["$-@"]()))||$send(this.$row_count(),"times",[],((TMP_39=function(i){var self=TMP_39.$$s||this;return null==self.rows&&(self.rows=nil),null==i&&(i=nil),Opal.yield1($yield,self.rows["$[]"](i)["$[]"](j))}).$$s=this,TMP_39.$$arity=1,TMP_39)),this):$truthy($truthy($a=$rb_ge(j,this.$column_count()))?$a:$rb_lt(j,this.$column_count()["$-@"]()))?nil:(col=$send($$($nesting,"Array"),"new",[this.$row_count()],((TMP_40=function(i){var self=TMP_40.$$s||this;return null==self.rows&&(self.rows=nil),null==i&&(i=nil),self.rows["$[]"](i)["$[]"](j)}).$$s=this,TMP_40.$$arity=1,TMP_40)),$$($nesting,"Vector").$elements(col,!1))},TMP_Matrix_column_38.$$arity=1),Opal.def(self,"$collect",TMP_Matrix_collect_41=function(){var TMP_42,rows,$iter=TMP_Matrix_collect_41.$$p,block=$iter||nil;return $iter&&(TMP_Matrix_collect_41.$$p=null),$iter&&(TMP_Matrix_collect_41.$$p=null),block===nil?this.$to_enum("collect"):(rows=$send(this.rows,"collect",[],((TMP_42=function(row){TMP_42.$$s;return null==row&&(row=nil),$send(row,"collect",[],block.$to_proc())}).$$s=this,TMP_42.$$arity=1,TMP_42)),this.$new_matrix(rows,this.$column_count()))},TMP_Matrix_collect_41.$$arity=0),Opal.alias(self,"map","collect"),Opal.def(self,"$each",TMP_Matrix_each_43=function(which){try{var TMP_44,TMP_45,TMP_47,TMP_49,TMP_51,TMP_53,TMP_55,$case,$iter=TMP_Matrix_each_43.$$p,$yield=$iter||nil,last=nil,block=nil;return $iter&&(TMP_Matrix_each_43.$$p=null),null==which&&(which="all"),$yield===nil?this.$to_enum("each",which):(last=$rb_minus(this.$column_count(),1),"all"["$==="]($case=which)?(block=$$($nesting,"Proc").$new(),$send(this.rows,"each",[],((TMP_44=function(row){TMP_44.$$s;return null==row&&(row=nil),$send(row,"each",[],block.$to_proc())}).$$s=this,TMP_44.$$arity=1,TMP_44))):"diagonal"["$==="]($case)?$send(this.rows,"each_with_index",[],((TMP_45=function(row,row_index){var TMP_46,self=TMP_45.$$s||this;return null==row&&(row=nil),null==row_index&&(row_index=nil),Opal.yield1($yield,$send(row,"fetch",[row_index],((TMP_46=function(){var self=TMP_46.$$s||this;Opal.ret(self)}).$$s=self,TMP_46.$$arity=0,TMP_46)))}).$$s=this,TMP_45.$$arity=2,TMP_45)):"off_diagonal"["$==="]($case)?$send(this.rows,"each_with_index",[],((TMP_47=function(row,row_index){var TMP_48,self=TMP_47.$$s||this;return null==row&&(row=nil),null==row_index&&(row_index=nil),$send(self.$column_count(),"times",[],((TMP_48=function(col_index){TMP_48.$$s;return null==col_index&&(col_index=nil),row_index["$=="](col_index)?nil:Opal.yield1($yield,row["$[]"](col_index))}).$$s=self,TMP_48.$$arity=1,TMP_48))}).$$s=this,TMP_47.$$arity=2,TMP_47)):"lower"["$==="]($case)?$send(this.rows,"each_with_index",[],((TMP_49=function(row,row_index){var TMP_50,self=TMP_49.$$s||this;return null==row&&(row=nil),null==row_index&&(row_index=nil),$send(0,"upto",[[row_index,last].$min()],((TMP_50=function(col_index){TMP_50.$$s;return null==col_index&&(col_index=nil),Opal.yield1($yield,row["$[]"](col_index))}).$$s=self,TMP_50.$$arity=1,TMP_50))}).$$s=this,TMP_49.$$arity=2,TMP_49)):"strict_lower"["$==="]($case)?$send(this.rows,"each_with_index",[],((TMP_51=function(row,row_index){var TMP_52,self=TMP_51.$$s||this;return null==row&&(row=nil),null==row_index&&(row_index=nil),$send([row_index,self.$column_count()].$min(),"times",[],((TMP_52=function(col_index){TMP_52.$$s;return null==col_index&&(col_index=nil),Opal.yield1($yield,row["$[]"](col_index))}).$$s=self,TMP_52.$$arity=1,TMP_52))}).$$s=this,TMP_51.$$arity=2,TMP_51)):"strict_upper"["$==="]($case)?$send(this.rows,"each_with_index",[],((TMP_53=function(row,row_index){var TMP_54,self=TMP_53.$$s||this;return null==row&&(row=nil),null==row_index&&(row_index=nil),$send($rb_plus(row_index,1),"upto",[last],((TMP_54=function(col_index){TMP_54.$$s;return null==col_index&&(col_index=nil),Opal.yield1($yield,row["$[]"](col_index))}).$$s=self,TMP_54.$$arity=1,TMP_54))}).$$s=this,TMP_53.$$arity=2,TMP_53)):"upper"["$==="]($case)?$send(this.rows,"each_with_index",[],((TMP_55=function(row,row_index){var TMP_56,self=TMP_55.$$s||this;return null==row&&(row=nil),null==row_index&&(row_index=nil),$send(row_index,"upto",[last],((TMP_56=function(col_index){TMP_56.$$s;return null==col_index&&(col_index=nil),Opal.yield1($yield,row["$[]"](col_index))}).$$s=self,TMP_56.$$arity=1,TMP_56))}).$$s=this,TMP_55.$$arity=2,TMP_55)):this.$raise($$($nesting,"ArgumentError"),"expected "+which.$inspect()+" to be one of :all, :diagonal, :off_diagonal, :lower, :strict_lower, :strict_upper or :upper"),this)}catch($returner){if($returner===Opal.returner)return $returner.$v;throw $returner}},TMP_Matrix_each_43.$$arity=-1),Opal.def(self,"$each_with_index",TMP_Matrix_each_with_index_57=function(which){try{var TMP_58,TMP_60,TMP_62,TMP_64,TMP_66,TMP_68,TMP_70,$case,$iter=TMP_Matrix_each_with_index_57.$$p,$yield=$iter||nil,last=nil;return $iter&&(TMP_Matrix_each_with_index_57.$$p=null),null==which&&(which="all"),$yield===nil?this.$to_enum("each_with_index",which):(last=$rb_minus(this.$column_count(),1),"all"["$==="]($case=which)?$send(this.rows,"each_with_index",[],((TMP_58=function(row,row_index){var TMP_59,self=TMP_58.$$s||this;return null==row&&(row=nil),null==row_index&&(row_index=nil),$send(row,"each_with_index",[],((TMP_59=function(e,col_index){TMP_59.$$s;return null==e&&(e=nil),null==col_index&&(col_index=nil),Opal.yieldX($yield,[e,row_index,col_index])}).$$s=self,TMP_59.$$arity=2,TMP_59))}).$$s=this,TMP_58.$$arity=2,TMP_58)):"diagonal"["$==="]($case)?$send(this.rows,"each_with_index",[],((TMP_60=function(row,row_index){var TMP_61,self=TMP_60.$$s||this;return null==row&&(row=nil),null==row_index&&(row_index=nil),Opal.yieldX($yield,[$send(row,"fetch",[row_index],(TMP_61=function(){var self=TMP_61.$$s||this;Opal.ret(self)},TMP_61.$$s=self,TMP_61.$$arity=0,TMP_61)),row_index,row_index])}).$$s=this,TMP_60.$$arity=2,TMP_60)):"off_diagonal"["$==="]($case)?$send(this.rows,"each_with_index",[],((TMP_62=function(row,row_index){var TMP_63,self=TMP_62.$$s||this;return null==row&&(row=nil),null==row_index&&(row_index=nil),$send(self.$column_count(),"times",[],((TMP_63=function(col_index){TMP_63.$$s;return null==col_index&&(col_index=nil),row_index["$=="](col_index)?nil:Opal.yieldX($yield,[row["$[]"](col_index),row_index,col_index])}).$$s=self,TMP_63.$$arity=1,TMP_63))}).$$s=this,TMP_62.$$arity=2,TMP_62)):"lower"["$==="]($case)?$send(this.rows,"each_with_index",[],((TMP_64=function(row,row_index){var TMP_65,self=TMP_64.$$s||this;return null==row&&(row=nil),null==row_index&&(row_index=nil),$send(0,"upto",[[row_index,last].$min()],((TMP_65=function(col_index){TMP_65.$$s;return null==col_index&&(col_index=nil),Opal.yieldX($yield,[row["$[]"](col_index),row_index,col_index])}).$$s=self,TMP_65.$$arity=1,TMP_65))}).$$s=this,TMP_64.$$arity=2,TMP_64)):"strict_lower"["$==="]($case)?$send(this.rows,"each_with_index",[],((TMP_66=function(row,row_index){var TMP_67,self=TMP_66.$$s||this;return null==row&&(row=nil),null==row_index&&(row_index=nil),$send([row_index,self.$column_count()].$min(),"times",[],((TMP_67=function(col_index){TMP_67.$$s;return null==col_index&&(col_index=nil),Opal.yieldX($yield,[row["$[]"](col_index),row_index,col_index])}).$$s=self,TMP_67.$$arity=1,TMP_67))}).$$s=this,TMP_66.$$arity=2,TMP_66)):"strict_upper"["$==="]($case)?$send(this.rows,"each_with_index",[],((TMP_68=function(row,row_index){var TMP_69,self=TMP_68.$$s||this;return null==row&&(row=nil),null==row_index&&(row_index=nil),$send($rb_plus(row_index,1),"upto",[last],((TMP_69=function(col_index){TMP_69.$$s;return null==col_index&&(col_index=nil),Opal.yieldX($yield,[row["$[]"](col_index),row_index,col_index])}).$$s=self,TMP_69.$$arity=1,TMP_69))}).$$s=this,TMP_68.$$arity=2,TMP_68)):"upper"["$==="]($case)?$send(this.rows,"each_with_index",[],((TMP_70=function(row,row_index){var TMP_71,self=TMP_70.$$s||this;return null==row&&(row=nil),null==row_index&&(row_index=nil),$send(row_index,"upto",[last],((TMP_71=function(col_index){TMP_71.$$s;return null==col_index&&(col_index=nil),Opal.yieldX($yield,[row["$[]"](col_index),row_index,col_index])}).$$s=self,TMP_71.$$arity=1,TMP_71))}).$$s=this,TMP_70.$$arity=2,TMP_70)):this.$raise($$($nesting,"ArgumentError"),"expected "+which.$inspect()+" to be one of :all, :diagonal, :off_diagonal, :lower, :strict_lower, :strict_upper or :upper"),this)}catch($returner){if($returner===Opal.returner)return $returner.$v;throw $returner}},TMP_Matrix_each_with_index_57.$$arity=-1),Opal.const_set($nesting[0],"SELECTORS",$hash2(["all","diagonal","off_diagonal","lower","strict_lower","strict_upper","upper"],{all:!0,diagonal:!0,off_diagonal:!0,lower:!0,strict_lower:!0,strict_upper:!0,upper:!0}).$freeze()),Opal.def(self,"$index",TMP_Matrix_index_72=function($a){try{var $post_args,args,$b,TMP_73,TMP_74,$iter=TMP_Matrix_index_72.$$p,$yield=$iter||nil,which=nil,value=nil;return $iter&&(TMP_Matrix_index_72.$$p=null),$post_args=Opal.slice.call(arguments,0,arguments.length),$truthy($rb_gt((args=$post_args).$size(),2))&&this.$raise($$($nesting,"ArgumentError"),"wrong number of arguments("+args.$size()+" for 0-2)"),which=$truthy($truthy($b=args.$size()["$=="](2))?$b:$$($nesting,"SELECTORS")["$include?"](args.$last()))?args.$pop():"all",$truthy($truthy($b=$yield!==nil)?$b:args.$size()["$=="](1))?(args.$size()["$=="](1)?(value=args.$first(),$send(this,"each_with_index",[which],((TMP_73=function(e,row_index,col_index){TMP_73.$$s;if(null==e&&(e=nil),null==row_index&&(row_index=nil),null==col_index&&(col_index=nil),!e["$=="](value))return nil;Opal.ret([row_index,col_index])}).$$s=this,TMP_73.$$arity=3,TMP_73))):$send(this,"each_with_index",[which],((TMP_74=function(e,row_index,col_index){TMP_74.$$s;if(null==e&&(e=nil),null==row_index&&(row_index=nil),null==col_index&&(col_index=nil),!$truthy(Opal.yield1($yield,e)))return nil;Opal.ret([row_index,col_index])}).$$s=this,TMP_74.$$arity=3,TMP_74)),nil):$send(this,"to_enum",["find_index",which].concat(Opal.to_a(args)))}catch($returner){if($returner===Opal.returner)return $returner.$v;throw $returner}},TMP_Matrix_index_72.$$arity=-1),self.$alias_method("find_index","index"),Opal.def(self,"$minor",TMP_Matrix_minor_75=function($a){var param,$b,$c,$d,TMP_76,$case,rows,row_range=nil,col_range=nil,from_row=nil,to_row=nil,size_row=nil,from_col=nil,to_col=nil,size_col=nil;if($case=(param=Opal.slice.call(arguments,0,arguments.length)).$size(),2["$==="]($case))$c=param,row_range=null==($b=Opal.to_ary($c))[0]?nil:$b[0],col_range=null==$b[1]?nil:$b[1],from_row=row_range.$first(),$truthy($rb_lt(from_row,0))&&(from_row=$rb_plus(from_row,this.$row_count())),to_row=row_range.$end(),$truthy($rb_lt(to_row,0))&&(to_row=$rb_plus(to_row,this.$row_count())),$truthy(row_range["$exclude_end?"]())||(to_row=$rb_plus(to_row,1)),size_row=$rb_minus(to_row,from_row),from_col=col_range.$first(),$truthy($rb_lt(from_col,0))&&(from_col=$rb_plus(from_col,this.$column_count())),to_col=col_range.$end(),$truthy($rb_lt(to_col,0))&&(to_col=$rb_plus(to_col,this.$column_count())),$truthy(col_range["$exclude_end?"]())||(to_col=$rb_plus(to_col,1)),size_col=$rb_minus(to_col,from_col);else if(4["$==="]($case)){if($c=param,from_row=null==($b=Opal.to_ary($c))[0]?nil:$b[0],size_row=null==$b[1]?nil:$b[1],from_col=null==$b[2]?nil:$b[2],size_col=null==$b[3]?nil:$b[3],$truthy($truthy($b=$rb_lt(size_row,0))?$b:$rb_lt(size_col,0)))return nil;$truthy($rb_lt(from_row,0))&&(from_row=$rb_plus(from_row,this.$row_count())),$truthy($rb_lt(from_col,0))&&(from_col=$rb_plus(from_col,this.$column_count()))}else this.$raise($$($nesting,"ArgumentError"),param.$inspect());return $truthy($truthy($b=$truthy($c=$truthy($d=$rb_gt(from_row,this.$row_count()))?$d:$rb_gt(from_col,this.$column_count()))?$c:$rb_lt(from_row,0))?$b:$rb_lt(from_col,0))?nil:(rows=$send(this.rows["$[]"](from_row,size_row),"collect",[],((TMP_76=function(row){TMP_76.$$s;return null==row&&(row=nil),row["$[]"](from_col,size_col)}).$$s=this,TMP_76.$$arity=1,TMP_76)),this.$new_matrix(rows,[$rb_minus(this.$column_count(),from_col),size_col].$min()))},TMP_Matrix_minor_75.$$arity=-1),Opal.def(self,"$first_minor",TMP_Matrix_first_minor_77=function(row,column){var TMP_78,arrays=nil;return $truthy(this["$empty?"]())&&this.$raise($$($nesting,"RuntimeError"),"first_minor of empty matrix is not defined"),$truthy($rb_le(0,row)?$rb_lt(row,this.$row_count()):$rb_le(0,row))||this.$raise($$($nesting,"ArgumentError"),"invalid row ("+row.$inspect()+" for 0.."+$rb_minus(this.$row_count(),1)+")"),$truthy($rb_le(0,column)?$rb_lt(column,this.$column_count()):$rb_le(0,column))||this.$raise($$($nesting,"ArgumentError"),"invalid column ("+column.$inspect()+" for 0.."+$rb_minus(this.$column_count(),1)+")"),(arrays=this.$to_a()).$delete_at(row),$send(arrays,"each",[],((TMP_78=function(array){TMP_78.$$s;return null==array&&(array=nil),array.$delete_at(column)}).$$s=this,TMP_78.$$arity=1,TMP_78)),this.$new_matrix(arrays,$rb_minus(this.$column_count(),1))},TMP_Matrix_first_minor_77.$$arity=2),Opal.def(self,"$cofactor",TMP_Matrix_cofactor_79=function(row,column){return $truthy(this["$empty?"]())&&this.$raise($$($nesting,"RuntimeError"),"cofactor of empty matrix is not defined"),$truthy(this["$square?"]())||$$($nesting,"Matrix").$Raise($$($nesting,"ErrDimensionMismatch")),$rb_times(this.$first_minor(row,column).$determinant(),(-1)["$**"]($rb_plus(row,column)))},TMP_Matrix_cofactor_79.$$arity=2),Opal.def(self,"$adjugate",TMP_Matrix_adjugate_80=function(){var TMP_81;return $truthy(this["$square?"]())||$$($nesting,"Matrix").$Raise($$($nesting,"ErrDimensionMismatch")),$send($$($nesting,"Matrix"),"build",[this.$row_count(),this.$column_count()],((TMP_81=function(row,column){var self=TMP_81.$$s||this;return null==row&&(row=nil),null==column&&(column=nil),self.$cofactor(column,row)}).$$s=this,TMP_81.$$arity=2,TMP_81))},TMP_Matrix_adjugate_80.$$arity=0),Opal.def(self,"$laplace_expansion",TMP_Matrix_laplace_expansion_82=function($kwargs){var row,column,$a,$b,TMP_83,num=nil;if(null==$kwargs)$kwargs=$hash2([],{});else if(!$kwargs.$$is_hash)throw Opal.ArgumentError.$new("expected kwargs");return null==(row=$kwargs.$$smap.row)&&(row=nil),null==(column=$kwargs.$$smap.column)&&(column=nil),num=$truthy($a=row)?$a:column,$truthy($truthy($a=num["$!"]())?$a:$truthy($b=row)?column:$b)&&this.$raise($$($nesting,"ArgumentError"),"exactly one the row or column arguments must be specified"),$truthy(this["$square?"]())||$$($nesting,"Matrix").$Raise($$($nesting,"ErrDimensionMismatch")),$truthy(this["$empty?"]())&&this.$raise($$($nesting,"RuntimeError"),"laplace_expansion of empty matrix is not defined"),$truthy(($a=$rb_le(0,num))?$rb_lt(num,this.$row_count()):$rb_le(0,num))||this.$raise($$($nesting,"ArgumentError"),"invalid num ("+num.$inspect()+" for 0.."+$rb_minus(this.$row_count(),1)+")"),$send(this.$send($truthy(row)?"row":"column",num).$map(),"with_index",[],(TMP_83=function(e,k){var self=TMP_83.$$s||this;return null==e&&(e=nil),null==k&&(k=nil),$rb_times(e,$send(self,"cofactor",Opal.to_a($truthy(row)?[num,k]:[k,num])))},TMP_83.$$s=this,TMP_83.$$arity=2,TMP_83)).$inject("+")},TMP_Matrix_laplace_expansion_82.$$arity=-1),self.$alias_method("cofactor_expansion","laplace_expansion"),Opal.def(self,"$diagonal?",TMP_Matrix_diagonal$q_84=function(){return $truthy(this["$square?"]())||$$($nesting,"Matrix").$Raise($$($nesting,"ErrDimensionMismatch")),$send(this.$each("off_diagonal"),"all?",[],"zero?".$to_proc())},TMP_Matrix_diagonal$q_84.$$arity=0),Opal.def(self,"$empty?",TMP_Matrix_empty$q_85=function(){var $a;return $truthy($a=this.$column_count()["$=="](0))?$a:this.$row_count()["$=="](0)},TMP_Matrix_empty$q_85.$$arity=0),Opal.def(self,"$hermitian?",TMP_Matrix_hermitian$q_86=function(){var TMP_87;return $truthy(this["$square?"]())||$$($nesting,"Matrix").$Raise($$($nesting,"ErrDimensionMismatch")),$send(this.$each_with_index("upper"),"all?",[],((TMP_87=function(e,row,col){var self=TMP_87.$$s||this;return null==e&&(e=nil),null==row&&(row=nil),null==col&&(col=nil),e["$=="](self.$rows()["$[]"](col)["$[]"](row).$conj())}).$$s=this,TMP_87.$$arity=3,TMP_87))},TMP_Matrix_hermitian$q_86.$$arity=0),Opal.def(self,"$lower_triangular?",TMP_Matrix_lower_triangular$q_88=function(){return $send(this.$each("strict_upper"),"all?",[],"zero?".$to_proc())},TMP_Matrix_lower_triangular$q_88.$$arity=0),Opal.def(self,"$normal?",TMP_Matrix_normal$q_89=function(){try{var TMP_90;return $truthy(this["$square?"]())||$$($nesting,"Matrix").$Raise($$($nesting,"ErrDimensionMismatch")),$send(this.$rows(),"each_with_index",[],((TMP_90=function(row_i,i){var TMP_91,self=TMP_90.$$s||this;return null==row_i&&(row_i=nil),null==i&&(i=nil),$send(self.$rows(),"each_with_index",[],((TMP_91=function(row_j,j){var TMP_92,self=TMP_91.$$s||this,s=nil;if(null==row_j&&(row_j=nil),null==j&&(j=nil),s=0,$send(self.$rows(),"each_with_index",[],((TMP_92=function(row_k,k){TMP_92.$$s;return null==row_k&&(row_k=nil),null==k&&(k=nil),s=$rb_plus(s,$rb_minus($rb_times(row_i["$[]"](k),row_j["$[]"](k).$conj()),$rb_times(row_k["$[]"](i).$conj(),row_k["$[]"](j))))}).$$s=self,TMP_92.$$arity=2,TMP_92)),s["$=="](0))return nil;Opal.ret(!1)}).$$s=self,TMP_91.$$arity=2,TMP_91))}).$$s=this,TMP_90.$$arity=2,TMP_90)),!0}catch($returner){if($returner===Opal.returner)return $returner.$v;throw $returner}},TMP_Matrix_normal$q_89.$$arity=0),Opal.def(self,"$orthogonal?",TMP_Matrix_orthogonal$q_93=function(){try{var TMP_94;return $truthy(this["$square?"]())||$$($nesting,"Matrix").$Raise($$($nesting,"ErrDimensionMismatch")),$send(this.$rows(),"each_with_index",[],((TMP_94=function(row,i){var TMP_95,self=TMP_94.$$s||this;return null==row&&(row=nil),null==i&&(i=nil),$send(self.$column_count(),"times",[],((TMP_95=function(j){var TMP_96,self=TMP_95.$$s||this,s=nil;if(null==j&&(j=nil),s=0,$send(self.$row_count(),"times",[],((TMP_96=function(k){var self=TMP_96.$$s||this;return null==k&&(k=nil),s=$rb_plus(s,$rb_times(row["$[]"](k),self.$rows()["$[]"](k)["$[]"](j)))}).$$s=self,TMP_96.$$arity=1,TMP_96)),s["$=="](i["$=="](j)?1:0))return nil;Opal.ret(!1)}).$$s=self,TMP_95.$$arity=1,TMP_95))}).$$s=this,TMP_94.$$arity=2,TMP_94)),!0}catch($returner){if($returner===Opal.returner)return $returner.$v;throw $returner}},TMP_Matrix_orthogonal$q_93.$$arity=0),Opal.def(self,"$permutation?",TMP_Matrix_permutation$q_97=function(){try{var TMP_98,cols=nil;return $truthy(this["$square?"]())||$$($nesting,"Matrix").$Raise($$($nesting,"ErrDimensionMismatch")),cols=$$($nesting,"Array").$new(this.$column_count()),$send(this.$rows(),"each_with_index",[],((TMP_98=function(row,i){var TMP_99,self=TMP_98.$$s||this,found=nil;if(null==row&&(row=nil),null==i&&(i=nil),found=!1,$send(row,"each_with_index",[],((TMP_99=function(e,j){TMP_99.$$s;var $a,$writer=nil;return null==e&&(e=nil),null==j&&(j=nil),e["$=="](1)?($truthy($truthy($a=found)?$a:cols["$[]"](j))&&Opal.ret(!1),$writer=[j,!0],$send(cols,"[]=",Opal.to_a($writer)),found=$writer[$rb_minus($writer.length,1)]):$truthy(e["$!="](0))?void Opal.ret(!1):nil}).$$s=self,TMP_99.$$arity=2,TMP_99)),$truthy(found))return nil;Opal.ret(!1)}).$$s=this,TMP_98.$$arity=2,TMP_98)),!0}catch($returner){if($returner===Opal.returner)return $returner.$v;throw $returner}},TMP_Matrix_permutation$q_97.$$arity=0),Opal.def(self,"$real?",TMP_Matrix_real$q_100=function(){return $send(this,"all?",[],"real?".$to_proc())},TMP_Matrix_real$q_100.$$arity=0),Opal.def(self,"$regular?",TMP_Matrix_regular$q_101=function(){return this["$singular?"]()["$!"]()},TMP_Matrix_regular$q_101.$$arity=0),Opal.def(self,"$singular?",TMP_Matrix_singular$q_102=function(){return this.$determinant()["$=="](0)},TMP_Matrix_singular$q_102.$$arity=0),Opal.def(self,"$square?",TMP_Matrix_square$q_103=function(){return this.$column_count()["$=="](this.$row_count())},TMP_Matrix_square$q_103.$$arity=0),Opal.def(self,"$symmetric?",TMP_Matrix_symmetric$q_104=function(){try{var TMP_105;return $truthy(this["$square?"]())||$$($nesting,"Matrix").$Raise($$($nesting,"ErrDimensionMismatch")),$send(this,"each_with_index",["strict_upper"],((TMP_105=function(e,row,col){var self=TMP_105.$$s||this;if(null==e&&(e=nil),null==row&&(row=nil),null==col&&(col=nil),!$truthy(e["$!="](self.$rows()["$[]"](col)["$[]"](row))))return nil;Opal.ret(!1)}).$$s=this,TMP_105.$$arity=3,TMP_105)),!0}catch($returner){if($returner===Opal.returner)return $returner.$v;throw $returner}},TMP_Matrix_symmetric$q_104.$$arity=0),Opal.def(self,"$antisymmetric?",TMP_Matrix_antisymmetric$q_106=function(){try{var TMP_107;return $truthy(this["$square?"]())||$$($nesting,"Matrix").$Raise($$($nesting,"ErrDimensionMismatch")),$send(this,"each_with_index",["upper"],((TMP_107=function(e,row,col){var self=TMP_107.$$s||this;if(null==e&&(e=nil),null==row&&(row=nil),null==col&&(col=nil),e["$=="](self.$rows()["$[]"](col)["$[]"](row)["$-@"]()))return nil;Opal.ret(!1)}).$$s=this,TMP_107.$$arity=3,TMP_107)),!0}catch($returner){if($returner===Opal.returner)return $returner.$v;throw $returner}},TMP_Matrix_antisymmetric$q_106.$$arity=0),Opal.def(self,"$unitary?",TMP_Matrix_unitary$q_108=function(){try{var TMP_109;return $truthy(this["$square?"]())||$$($nesting,"Matrix").$Raise($$($nesting,"ErrDimensionMismatch")),$send(this.$rows(),"each_with_index",[],((TMP_109=function(row,i){var TMP_110,self=TMP_109.$$s||this;return null==row&&(row=nil),null==i&&(i=nil),$send(self.$column_count(),"times",[],((TMP_110=function(j){var TMP_111,self=TMP_110.$$s||this,s=nil;if(null==j&&(j=nil),s=0,$send(self.$row_count(),"times",[],((TMP_111=function(k){var self=TMP_111.$$s||this;return null==k&&(k=nil),s=$rb_plus(s,$rb_times(row["$[]"](k).$conj(),self.$rows()["$[]"](k)["$[]"](j)))}).$$s=self,TMP_111.$$arity=1,TMP_111)),s["$=="](i["$=="](j)?1:0))return nil;Opal.ret(!1)}).$$s=self,TMP_110.$$arity=1,TMP_110))}).$$s=this,TMP_109.$$arity=2,TMP_109)),!0}catch($returner){if($returner===Opal.returner)return $returner.$v;throw $returner}},TMP_Matrix_unitary$q_108.$$arity=0),Opal.def(self,"$upper_triangular?",TMP_Matrix_upper_triangular$q_112=function(){return $send(this.$each("strict_lower"),"all?",[],"zero?".$to_proc())},TMP_Matrix_upper_triangular$q_112.$$arity=0),Opal.def(self,"$zero?",TMP_Matrix_zero$q_113=function(){return $send(this,"all?",[],"zero?".$to_proc())},TMP_Matrix_zero$q_113.$$arity=0),Opal.def(self,"$==",TMP_Matrix_$eq$eq_114=function(other){var $a;return!!$truthy($truthy($a=$$($nesting,"Matrix")["$==="](other))?this.$column_count()["$=="](other.$column_count()):$a)&&this.$rows()["$=="](other.$rows())},TMP_Matrix_$eq$eq_114.$$arity=1),Opal.def(self,"$eql?",TMP_Matrix_eql$q_115=function(other){var $a;return!!$truthy($truthy($a=$$($nesting,"Matrix")["$==="](other))?this.$column_count()["$=="](other.$column_count()):$a)&&this.$rows()["$eql?"](other.$rows())},TMP_Matrix_eql$q_115.$$arity=1),Opal.def(self,"$clone",TMP_Matrix_clone_116=function(){return this.$new_matrix($send(this.rows,"map",[],"dup".$to_proc()),this.$column_count())},TMP_Matrix_clone_116.$$arity=0),Opal.def(self,"$hash",TMP_Matrix_hash_117=function(){return this.rows.$hash()},TMP_Matrix_hash_117.$$arity=0),Opal.def(self,"$*",TMP_Matrix_$_118=function(m){var TMP_119,TMP_121,self=this,$case=nil,rows=nil;return $case=m,$$($nesting,"Numeric")["$==="]($case)?(rows=$send(self.rows,"collect",[],((TMP_119=function(row){var TMP_120,self=TMP_119.$$s||this;return null==row&&(row=nil),$send(row,"collect",[],((TMP_120=function(e){return TMP_120.$$s,null==e&&(e=nil),$rb_times(e,m)}).$$s=self,TMP_120.$$arity=1,TMP_120))}).$$s=self,TMP_119.$$arity=1,TMP_119)),self.$new_matrix(rows,self.$column_count())):$$($nesting,"Vector")["$==="]($case)?(m=self.$class().$column_vector(m),$rb_times(self,m).$column(0)):$$($nesting,"Matrix")["$==="]($case)?($truthy(self.$column_count()["$!="](m.$row_count()))&&$$($nesting,"Matrix").$Raise($$($nesting,"ErrDimensionMismatch")),rows=$send($$($nesting,"Array"),"new",[self.$row_count()],((TMP_121=function(i){var TMP_122,self=TMP_121.$$s||this;return null==i&&(i=nil),$send($$($nesting,"Array"),"new",[m.$column_count()],((TMP_122=function(j){var TMP_123,self=TMP_122.$$s||this;return null==j&&(j=nil),$send(Opal.Range.$new(0,self.$column_count(),!0),"inject",[0],((TMP_123=function(vij,k){var self=TMP_123.$$s||this;return null==vij&&(vij=nil),null==k&&(k=nil),$rb_plus(vij,$rb_times(self["$[]"](i,k),m["$[]"](k,j)))}).$$s=self,TMP_123.$$arity=2,TMP_123))}).$$s=self,TMP_122.$$arity=1,TMP_122))}).$$s=self,TMP_121.$$arity=1,TMP_121)),self.$new_matrix(rows,m.$column_count())):self.$apply_through_coercion(m,"*")},TMP_Matrix_$_118.$$arity=1),Opal.def(self,"$+",TMP_Matrix_$_124=function(m){var TMP_125,$case,rows;if($case=m,$$($nesting,"Numeric")["$==="]($case))$$($nesting,"Matrix").$Raise($$($nesting,"ErrOperationNotDefined"),"+",this.$class(),m.$class());else if($$($nesting,"Vector")["$==="]($case))m=this.$class().$column_vector(m);else if(!$$($nesting,"Matrix")["$==="]($case))return this.$apply_through_coercion(m,"+");return $truthy(this.$row_count()["$=="](m.$row_count())?this.$column_count()["$=="](m.$column_count()):this.$row_count()["$=="](m.$row_count()))||$$($nesting,"Matrix").$Raise($$($nesting,"ErrDimensionMismatch")),rows=$send($$($nesting,"Array"),"new",[this.$row_count()],((TMP_125=function(i){var TMP_126,self=TMP_125.$$s||this;return null==i&&(i=nil),$send($$($nesting,"Array"),"new",[self.$column_count()],((TMP_126=function(j){var self=TMP_126.$$s||this;return null==j&&(j=nil),$rb_plus(self["$[]"](i,j),m["$[]"](i,j))}).$$s=self,TMP_126.$$arity=1,TMP_126))}).$$s=this,TMP_125.$$arity=1,TMP_125)),this.$new_matrix(rows,this.$column_count())},TMP_Matrix_$_124.$$arity=1),Opal.def(self,"$-",TMP_Matrix_$_127=function(m){var TMP_128,$case,rows;if($case=m,$$($nesting,"Numeric")["$==="]($case))$$($nesting,"Matrix").$Raise($$($nesting,"ErrOperationNotDefined"),"-",this.$class(),m.$class());else if($$($nesting,"Vector")["$==="]($case))m=this.$class().$column_vector(m);else if(!$$($nesting,"Matrix")["$==="]($case))return this.$apply_through_coercion(m,"-");return $truthy(this.$row_count()["$=="](m.$row_count())?this.$column_count()["$=="](m.$column_count()):this.$row_count()["$=="](m.$row_count()))||$$($nesting,"Matrix").$Raise($$($nesting,"ErrDimensionMismatch")),rows=$send($$($nesting,"Array"),"new",[this.$row_count()],((TMP_128=function(i){var TMP_129,self=TMP_128.$$s||this;return null==i&&(i=nil),$send($$($nesting,"Array"),"new",[self.$column_count()],((TMP_129=function(j){var self=TMP_129.$$s||this;return null==j&&(j=nil),$rb_minus(self["$[]"](i,j),m["$[]"](i,j))}).$$s=self,TMP_129.$$arity=1,TMP_129))}).$$s=this,TMP_128.$$arity=1,TMP_128)),this.$new_matrix(rows,this.$column_count())},TMP_Matrix_$_127.$$arity=1),Opal.def(self,"$/",TMP_Matrix_$_130=function(other){var TMP_131,self=this,$case=nil,rows=nil;return $case=other,$$($nesting,"Numeric")["$==="]($case)?(rows=$send(self.rows,"collect",[],((TMP_131=function(row){var TMP_132,self=TMP_131.$$s||this;return null==row&&(row=nil),$send(row,"collect",[],((TMP_132=function(e){return TMP_132.$$s,null==e&&(e=nil),$rb_divide(e,other)}).$$s=self,TMP_132.$$arity=1,TMP_132))}).$$s=self,TMP_131.$$arity=1,TMP_131)),self.$new_matrix(rows,self.$column_count())):$$($nesting,"Matrix")["$==="]($case)?$rb_times(self,other.$inverse()):self.$apply_through_coercion(other,"/")},TMP_Matrix_$_130.$$arity=1),Opal.def(self,"$hadamard_product",TMP_Matrix_hadamard_product_133=function(m){var TMP_134;return $send(this,"combine",[m],((TMP_134=function(a,b){TMP_134.$$s;return null==a&&(a=nil),null==b&&(b=nil),$rb_times(a,b)}).$$s=this,TMP_134.$$arity=2,TMP_134))},TMP_Matrix_hadamard_product_133.$$arity=1),self.$alias_method("entrywise_product","hadamard_product"),Opal.def(self,"$inverse",TMP_Matrix_inverse_135=function(){return $truthy(this["$square?"]())||$$($nesting,"Matrix").$Raise($$($nesting,"ErrDimensionMismatch")),this.$class().$I(this.$row_count()).$send("inverse_from",this)},TMP_Matrix_inverse_135.$$arity=0),Opal.alias(self,"inv","inverse"),Opal.def(self,"$inverse_from",TMP_Matrix_inverse_from_136=function(src){var TMP_137,last,a=nil;return last=$rb_minus(this.$row_count(),1),a=src.$to_a(),$send(0,"upto",[last],((TMP_137=function(k){var TMP_138,$a,TMP_139,TMP_142,TMP_143,self=TMP_137.$$s||this,i=nil,akk=nil;return null==self.rows&&(self.rows=nil),null==k&&(k=nil),i=k,akk=a["$[]"](k)["$[]"](k).$abs(),$send($rb_plus(k,1),"upto",[last],((TMP_138=function(j){var v;TMP_138.$$s;return null==j&&(j=nil),v=a["$[]"](j)["$[]"](k).$abs(),$truthy($rb_gt(v,akk))?(i=j,akk=v):nil}).$$s=self,TMP_138.$$arity=1,TMP_138)),akk["$=="](0)&&$$($nesting,"Matrix").$Raise($$($nesting,"ErrNotRegular")),$truthy(i["$!="](k))&&($a=[a["$[]"](k),a["$[]"](i)],a["$[]="](i,$a[0]),a["$[]="](k,$a[1]),$a=[self.rows["$[]"](k),self.rows["$[]"](i)],self.rows["$[]="](i,$a[0]),self.rows["$[]="](k,$a[1])),akk=a["$[]"](k)["$[]"](k),$send(0,"upto",[last],((TMP_139=function(ii){var TMP_140,TMP_141,q,self=TMP_139.$$s||this,$writer=nil;return null==ii&&(ii=nil),ii["$=="](k)?nil:(q=a["$[]"](ii)["$[]"](k).$quo(akk),$writer=[k,0],$send(a["$[]"](ii),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$send($rb_plus(k,1),"upto",[last],((TMP_140=function(j){TMP_140.$$s;var $binary_op_recvr_tmp_1=nil;return null==j&&(j=nil),$binary_op_recvr_tmp_1=a["$[]"](ii),$writer=[j,$rb_minus($binary_op_recvr_tmp_1["$[]"](j),$rb_times(a["$[]"](k)["$[]"](j),q))],$send($binary_op_recvr_tmp_1,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_140.$$arity=1,TMP_140)),$send(0,"upto",[last],((TMP_141=function(j){var self=TMP_141.$$s||this,$binary_op_recvr_tmp_2=nil;return null==self.rows&&(self.rows=nil),null==j&&(j=nil),$binary_op_recvr_tmp_2=self.rows["$[]"](ii),$writer=[j,$rb_minus($binary_op_recvr_tmp_2["$[]"](j),$rb_times(self.rows["$[]"](k)["$[]"](j),q))],$send($binary_op_recvr_tmp_2,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_141.$$arity=1,TMP_141)))}).$$s=self,TMP_139.$$arity=1,TMP_139)),$send($rb_plus(k,1),"upto",[last],((TMP_142=function(j){var $writer;TMP_142.$$s;return null==j&&(j=nil),$writer=[j,a["$[]"](k)["$[]"](j).$quo(akk)],$send(a["$[]"](k),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_142.$$arity=1,TMP_142)),$send(0,"upto",[last],((TMP_143=function(j){var $writer,self=TMP_143.$$s||this;return null==self.rows&&(self.rows=nil),null==j&&(j=nil),$writer=[j,self.rows["$[]"](k)["$[]"](j).$quo(akk)],$send(self.rows["$[]"](k),"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_143.$$arity=1,TMP_143))}).$$s=this,TMP_137.$$arity=1,TMP_137)),this},TMP_Matrix_inverse_from_136.$$arity=1),self.$private("inverse_from"),Opal.def(self,"$**",TMP_Matrix_$$_144=function(other){try{var TMP_145,$a,$b,TMP_146,self=this,$case=nil,x=nil,z=nil,v=nil,d=nil,v_inv=nil;return function(){if($case=other,$$($nesting,"Integer")["$==="]($case)){if(x=self,$truthy($rb_le(other,0))){if(x=self.$inverse(),other["$=="](0))return self.$class().$identity(self.$column_count());other=other["$-@"]()}return z=nil,$send(self,"loop",[],((TMP_145=function(){TMP_145.$$s;return other["$[]"](0)["$=="](1)&&(z=$truthy(z)?$rb_times(z,x):x),$truthy((other=other["$>>"](1))["$zero?"]())&&Opal.ret(z),x=$rb_times(x,x)}).$$s=self,TMP_145.$$arity=0,TMP_145))}return $$($nesting,"Numeric")["$==="]($case)?($b=self.$eigensystem(),$a=Opal.to_ary($b),v=null==$a[0]?nil:$a[0],d=null==$a[1]?nil:$a[1],v_inv=null==$a[2]?nil:$a[2],$rb_times($rb_times(v,$send(self.$class(),"diagonal",Opal.to_a($send(d.$each("diagonal"),"map",[],((TMP_146=function(e){TMP_146.$$s;return null==e&&(e=nil),e["$**"](other)}).$$s=self,TMP_146.$$arity=1,TMP_146))))),v_inv)):$$($nesting,"Matrix").$Raise($$($nesting,"ErrOperationNotDefined"),"**",self.$class(),other.$class())}()}catch($returner){if($returner===Opal.returner)return $returner.$v;throw $returner}},TMP_Matrix_$$_144.$$arity=1),Opal.def(self,"$+@",TMP_Matrix_$$_147=function(){return this},TMP_Matrix_$$_147.$$arity=0),Opal.def(self,"$-@",TMP_Matrix_$$_148=function(){var TMP_149;return $send(this,"collect",[],((TMP_149=function(e){TMP_149.$$s;return null==e&&(e=nil),e["$-@"]()}).$$s=this,TMP_149.$$arity=1,TMP_149))},TMP_Matrix_$$_148.$$arity=0),Opal.def(self,"$determinant",TMP_Matrix_determinant_150=function(){var $a,$b,self=this,m=nil,$case=nil,m0=nil,m1=nil,m2=nil,m3=nil;return $truthy(self["$square?"]())||$$($nesting,"Matrix").$Raise($$($nesting,"ErrDimensionMismatch")),m=self.rows,$case=self.$row_count(),(0)["$==="]($case)?1:1["$==="]($case)?m["$[]"](0)["$[]"](0)["$+@"]():2["$==="]($case)?$rb_minus($rb_times(m["$[]"](0)["$[]"](0)["$+@"](),m["$[]"](1)["$[]"](1)),$rb_times(m["$[]"](0)["$[]"](1),m["$[]"](1)["$[]"](0))):3["$==="]($case)?($b=m,$a=Opal.to_ary($b),m0=null==$a[0]?nil:$a[0],m1=null==$a[1]?nil:$a[1],m2=null==$a[2]?nil:$a[2],$rb_minus($rb_plus($rb_plus($rb_minus($rb_minus($rb_times($rb_times(m0["$[]"](0)["$+@"](),m1["$[]"](1)),m2["$[]"](2)),$rb_times($rb_times(m0["$[]"](0),m1["$[]"](2)),m2["$[]"](1))),$rb_times($rb_times(m0["$[]"](1),m1["$[]"](0)),m2["$[]"](2))),$rb_times($rb_times(m0["$[]"](1),m1["$[]"](2)),m2["$[]"](0))),$rb_times($rb_times(m0["$[]"](2),m1["$[]"](0)),m2["$[]"](1))),$rb_times($rb_times(m0["$[]"](2),m1["$[]"](1)),m2["$[]"](0)))):4["$==="]($case)?($b=m,$a=Opal.to_ary($b),m0=null==$a[0]?nil:$a[0],m1=null==$a[1]?nil:$a[1],m2=null==$a[2]?nil:$a[2],m3=null==$a[3]?nil:$a[3],$rb_plus($rb_minus($rb_minus($rb_plus($rb_plus($rb_minus($rb_minus($rb_plus($rb_plus($rb_minus($rb_minus($rb_plus($rb_plus($rb_minus($rb_minus($rb_plus($rb_plus($rb_minus($rb_minus($rb_plus($rb_plus($rb_minus($rb_minus($rb_times($rb_times($rb_times(m0["$[]"](0)["$+@"](),m1["$[]"](1)),m2["$[]"](2)),m3["$[]"](3)),$rb_times($rb_times($rb_times(m0["$[]"](0),m1["$[]"](1)),m2["$[]"](3)),m3["$[]"](2))),$rb_times($rb_times($rb_times(m0["$[]"](0),m1["$[]"](2)),m2["$[]"](1)),m3["$[]"](3))),$rb_times($rb_times($rb_times(m0["$[]"](0),m1["$[]"](2)),m2["$[]"](3)),m3["$[]"](1))),$rb_times($rb_times($rb_times(m0["$[]"](0),m1["$[]"](3)),m2["$[]"](1)),m3["$[]"](2))),$rb_times($rb_times($rb_times(m0["$[]"](0),m1["$[]"](3)),m2["$[]"](2)),m3["$[]"](1))),$rb_times($rb_times($rb_times(m0["$[]"](1),m1["$[]"](0)),m2["$[]"](2)),m3["$[]"](3))),$rb_times($rb_times($rb_times(m0["$[]"](1),m1["$[]"](0)),m2["$[]"](3)),m3["$[]"](2))),$rb_times($rb_times($rb_times(m0["$[]"](1),m1["$[]"](2)),m2["$[]"](0)),m3["$[]"](3))),$rb_times($rb_times($rb_times(m0["$[]"](1),m1["$[]"](2)),m2["$[]"](3)),m3["$[]"](0))),$rb_times($rb_times($rb_times(m0["$[]"](1),m1["$[]"](3)),m2["$[]"](0)),m3["$[]"](2))),$rb_times($rb_times($rb_times(m0["$[]"](1),m1["$[]"](3)),m2["$[]"](2)),m3["$[]"](0))),$rb_times($rb_times($rb_times(m0["$[]"](2),m1["$[]"](0)),m2["$[]"](1)),m3["$[]"](3))),$rb_times($rb_times($rb_times(m0["$[]"](2),m1["$[]"](0)),m2["$[]"](3)),m3["$[]"](1))),$rb_times($rb_times($rb_times(m0["$[]"](2),m1["$[]"](1)),m2["$[]"](0)),m3["$[]"](3))),$rb_times($rb_times($rb_times(m0["$[]"](2),m1["$[]"](1)),m2["$[]"](3)),m3["$[]"](0))),$rb_times($rb_times($rb_times(m0["$[]"](2),m1["$[]"](3)),m2["$[]"](0)),m3["$[]"](1))),$rb_times($rb_times($rb_times(m0["$[]"](2),m1["$[]"](3)),m2["$[]"](1)),m3["$[]"](0))),$rb_times($rb_times($rb_times(m0["$[]"](3),m1["$[]"](0)),m2["$[]"](1)),m3["$[]"](2))),$rb_times($rb_times($rb_times(m0["$[]"](3),m1["$[]"](0)),m2["$[]"](2)),m3["$[]"](1))),$rb_times($rb_times($rb_times(m0["$[]"](3),m1["$[]"](1)),m2["$[]"](0)),m3["$[]"](2))),$rb_times($rb_times($rb_times(m0["$[]"](3),m1["$[]"](1)),m2["$[]"](2)),m3["$[]"](0))),$rb_times($rb_times($rb_times(m0["$[]"](3),m1["$[]"](2)),m2["$[]"](0)),m3["$[]"](1))),$rb_times($rb_times($rb_times(m0["$[]"](3),m1["$[]"](2)),m2["$[]"](1)),m3["$[]"](0)))):self.$determinant_bareiss()},TMP_Matrix_determinant_150.$$arity=0),self.$alias_method("det","determinant"),Opal.def(self,"$determinant_bareiss",TMP_Matrix_determinant_bareiss_151=function(){try{var TMP_152,TMP_153,size,last,no_pivot,a=nil,sign=nil,pivot=nil;return size=this.$row_count(),last=$rb_minus(size,1),a=this.$to_a(),no_pivot=$send($$($nesting,"Proc"),"new",[],((TMP_152=function(){TMP_152.$$s;Opal.ret(0)}).$$s=this,TMP_152.$$arity=0,TMP_152)),pivot=sign=1,$send(size,"times",[],((TMP_153=function(k){var TMP_154,$a,TMP_155,previous_pivot,self=TMP_153.$$s||this,switch$=nil;return null==k&&(k=nil),previous_pivot=pivot,(pivot=a["$[]"](k)["$[]"](k))["$=="](0)&&(switch$=$send(Opal.Range.$new($rb_plus(k,1),size,!0),"find",[no_pivot],((TMP_154=function(row){TMP_154.$$s;return null==row&&(row=nil),a["$[]"](row)["$[]"](k)["$!="](0)}).$$s=self,TMP_154.$$arity=1,TMP_154)),$a=[a["$[]"](k),a["$[]"](switch$)],a["$[]="](switch$,$a[0]),a["$[]="](k,$a[1]),pivot=a["$[]"](k)["$[]"](k),sign=sign["$-@"]()),$send($rb_plus(k,1),"upto",[last],((TMP_155=function(i){var TMP_156,self=TMP_155.$$s||this,ai=nil;return null==i&&(i=nil),ai=a["$[]"](i),$send($rb_plus(k,1),"upto",[last],((TMP_156=function(j){var $writer;TMP_156.$$s;return null==j&&(j=nil),$writer=[j,$rb_divide($rb_minus($rb_times(pivot,ai["$[]"](j)),$rb_times(ai["$[]"](k),a["$[]"](k)["$[]"](j))),previous_pivot)],$send(ai,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_156.$$arity=1,TMP_156))}).$$s=self,TMP_155.$$arity=1,TMP_155))}).$$s=this,TMP_153.$$arity=1,TMP_153)),$rb_times(sign,pivot)}catch($returner){if($returner===Opal.returner)return $returner.$v;throw $returner}},TMP_Matrix_determinant_bareiss_151.$$arity=0),self.$private("determinant_bareiss"),Opal.def(self,"$determinant_e",TMP_Matrix_determinant_e_157=function(){return this.$warn("Matrix#determinant_e is deprecated; use #determinant",$hash2(["uplevel"],{uplevel:1})),this.$determinant()},TMP_Matrix_determinant_e_157.$$arity=0),Opal.alias(self,"det_e","determinant_e"),Opal.def(self,"$hstack",TMP_Matrix_hstack_158=function($a){var matrices,self=this;return matrices=Opal.slice.call(arguments,0,arguments.length),$send(self.$class(),"hstack",[self].concat(Opal.to_a(matrices)))},TMP_Matrix_hstack_158.$$arity=-1),Opal.def(self,"$rank",TMP_Matrix_rank_159=function(){var TMP_160,last_column,last_row,a=nil,pivot_row=nil,previous_pivot=nil;return a=this.$to_a(),last_column=$rb_minus(this.$column_count(),1),last_row=$rb_minus(this.$row_count(),1),previous_pivot=1,$send(pivot_row=0,"upto",[last_column],((TMP_160=function(k){var TMP_161,$a,TMP_162,switch_row,self=TMP_160.$$s||this,pivot=nil;return null==k&&(k=nil),switch_row=$send(Opal.Range.$new(pivot_row,last_row,!1),"find",[],((TMP_161=function(row){TMP_161.$$s;return null==row&&(row=nil),a["$[]"](row)["$[]"](k)["$!="](0)}).$$s=self,TMP_161.$$arity=1,TMP_161)),$truthy(switch_row)?(pivot_row["$=="](switch_row)||($a=[a["$[]"](pivot_row),a["$[]"](switch_row)],a["$[]="](switch_row,$a[0]),a["$[]="](pivot_row,$a[1])),pivot=a["$[]"](pivot_row)["$[]"](k),$send($rb_plus(pivot_row,1),"upto",[last_row],((TMP_162=function(i){var TMP_163,self=TMP_162.$$s||this,ai=nil;return null==i&&(i=nil),ai=a["$[]"](i),$send($rb_plus(k,1),"upto",[last_column],((TMP_163=function(j){var $writer;TMP_163.$$s;return null==j&&(j=nil),$writer=[j,$rb_divide($rb_minus($rb_times(pivot,ai["$[]"](j)),$rb_times(ai["$[]"](k),a["$[]"](pivot_row)["$[]"](j))),previous_pivot)],$send(ai,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]}).$$s=self,TMP_163.$$arity=1,TMP_163))}).$$s=self,TMP_162.$$arity=1,TMP_162)),pivot_row=$rb_plus(pivot_row,1),previous_pivot=pivot):nil}).$$s=this,TMP_160.$$arity=1,TMP_160)),pivot_row},TMP_Matrix_rank_159.$$arity=0),Opal.def(self,"$rank_e",TMP_Matrix_rank_e_164=function(){return this.$warn("Matrix#rank_e is deprecated; use #rank",$hash2(["uplevel"],{uplevel:1})),this.$rank()},TMP_Matrix_rank_e_164.$$arity=0),Opal.def(self,"$round",TMP_Matrix_round_165=function(ndigits){var TMP_166;return null==ndigits&&(ndigits=0),$send(this,"map",[],((TMP_166=function(e){TMP_166.$$s;return null==e&&(e=nil),e.$round(ndigits)}).$$s=this,TMP_166.$$arity=1,TMP_166))},TMP_Matrix_round_165.$$arity=-1),Opal.def(self,"$trace",TMP_Matrix_trace_167=function(){var TMP_168;return $truthy(this["$square?"]())||$$($nesting,"Matrix").$Raise($$($nesting,"ErrDimensionMismatch")),$send(Opal.Range.$new(0,this.$column_count(),!0),"inject",[0],((TMP_168=function(tr,i){var self=TMP_168.$$s||this;return null==self.rows&&(self.rows=nil),null==tr&&(tr=nil),null==i&&(i=nil),$rb_plus(tr,self.rows["$[]"](i)["$[]"](i))}).$$s=this,TMP_168.$$arity=2,TMP_168))},TMP_Matrix_trace_167.$$arity=0),Opal.alias(self,"tr","trace"),Opal.def(self,"$transpose",TMP_Matrix_transpose_169=function(){return $truthy(this.$row_count()["$zero?"]())?this.$class().$empty(this.$column_count(),0):this.$new_matrix(this.rows.$transpose(),this.$row_count())},TMP_Matrix_transpose_169.$$arity=0),Opal.alias(self,"t","transpose"),Opal.def(self,"$vstack",TMP_Matrix_vstack_170=function($a){var matrices,self=this;return matrices=Opal.slice.call(arguments,0,arguments.length),$send(self.$class(),"vstack",[self].concat(Opal.to_a(matrices)))},TMP_Matrix_vstack_170.$$arity=-1),Opal.def(self,"$eigensystem",TMP_Matrix_eigensystem_171=function(){return $$($nesting,"EigenvalueDecomposition").$new(this)},TMP_Matrix_eigensystem_171.$$arity=0),Opal.alias(self,"eigen","eigensystem"),Opal.def(self,"$lup",TMP_Matrix_lup_172=function(){return $$($nesting,"LUPDecomposition").$new(this)},TMP_Matrix_lup_172.$$arity=0),Opal.alias(self,"lup_decomposition","lup"),Opal.def(self,"$conjugate",TMP_Matrix_conjugate_173=function(){return $send(this,"collect",[],"conjugate".$to_proc())},TMP_Matrix_conjugate_173.$$arity=0),Opal.alias(self,"conj","conjugate"),Opal.def(self,"$imaginary",TMP_Matrix_imaginary_174=function(){return $send(this,"collect",[],"imaginary".$to_proc())},TMP_Matrix_imaginary_174.$$arity=0),Opal.alias(self,"imag","imaginary"),Opal.def(self,"$real",TMP_Matrix_real_175=function(){return $send(this,"collect",[],"real".$to_proc())},TMP_Matrix_real_175.$$arity=0),Opal.def(self,"$rect",TMP_Matrix_rect_176=function(){return[this.$real(),this.$imag()]},TMP_Matrix_rect_176.$$arity=0),Opal.alias(self,"rectangular","rect"),Opal.def(self,"$coerce",TMP_Matrix_coerce_177=function(other){var self=this,$case=nil;return $case=other,$$($nesting,"Numeric")["$==="]($case)?[$$($nesting,"Scalar").$new(other),self]:self.$raise($$($nesting,"TypeError"),self.$class()+" can't be coerced into "+other.$class())},TMP_Matrix_coerce_177.$$arity=1),Opal.def(self,"$row_vectors",TMP_Matrix_row_vectors_178=function(){var TMP_179;return $send($$($nesting,"Array"),"new",[this.$row_count()],((TMP_179=function(i){var self=TMP_179.$$s||this;return null==i&&(i=nil),self.$row(i)}).$$s=this,TMP_179.$$arity=1,TMP_179))},TMP_Matrix_row_vectors_178.$$arity=0),Opal.def(self,"$column_vectors",TMP_Matrix_column_vectors_180=function(){var TMP_181;return $send($$($nesting,"Array"),"new",[this.$column_count()],((TMP_181=function(i){var self=TMP_181.$$s||this;return null==i&&(i=nil),self.$column(i)}).$$s=this,TMP_181.$$arity=1,TMP_181))},TMP_Matrix_column_vectors_180.$$arity=0),Opal.def(self,"$to_matrix",TMP_Matrix_to_matrix_182=function(){return this},TMP_Matrix_to_matrix_182.$$arity=0),Opal.def(self,"$to_a",TMP_Matrix_to_a_183=function(){return $send(this.rows,"collect",[],"dup".$to_proc())},TMP_Matrix_to_a_183.$$arity=0),Opal.def(self,"$elements_to_f",TMP_Matrix_elements_to_f_184=function(){return this.$warn("Matrix#elements_to_f is deprecated, use map(&:to_f)",$hash2(["uplevel"],{uplevel:1})),$send(this,"map",[],"to_f".$to_proc())},TMP_Matrix_elements_to_f_184.$$arity=0),Opal.def(self,"$elements_to_i",TMP_Matrix_elements_to_i_185=function(){return this.$warn("Matrix#elements_to_i is deprecated, use map(&:to_i)",$hash2(["uplevel"],{uplevel:1})),$send(this,"map",[],"to_i".$to_proc())},TMP_Matrix_elements_to_i_185.$$arity=0),Opal.def(self,"$elements_to_r",TMP_Matrix_elements_to_r_186=function(){return this.$warn("Matrix#elements_to_r is deprecated, use map(&:to_r)",$hash2(["uplevel"],{uplevel:1})),$send(this,"map",[],"to_r".$to_proc())},TMP_Matrix_elements_to_r_186.$$arity=0),Opal.def(self,"$to_s",TMP_Matrix_to_s_187=function(){var TMP_188;return $truthy(this["$empty?"]())?this.$class()+".empty("+this.$row_count()+", "+this.$column_count()+")":$rb_plus($rb_plus(this.$class()+"[",$send(this.rows,"collect",[],(TMP_188=function(row){var TMP_189,self=TMP_188.$$s||this;return null==row&&(row=nil),$rb_plus($rb_plus("[",$send(row,"collect",[],(TMP_189=function(e){TMP_189.$$s;return null==e&&(e=nil),e.$to_s()},TMP_189.$$s=self,TMP_189.$$arity=1,TMP_189)).$join(", ")),"]")},TMP_188.$$s=this,TMP_188.$$arity=1,TMP_188)).$join(", ")),"]")},TMP_Matrix_to_s_187.$$arity=0),Opal.def(self,"$inspect",TMP_Matrix_inspect_190=function(){return $truthy(this["$empty?"]())?this.$class()+".empty("+this.$row_count()+", "+this.$column_count()+")":""+this.$class()+this.rows.$inspect()},TMP_Matrix_inspect_190.$$arity=0),function($base,$parent_nesting){function $ConversionHelper(){}var TMP_ConversionHelper_convert_to_array_191,self=$ConversionHelper=$module($base,"ConversionHelper",$ConversionHelper),$nesting=(self.prototype,[self].concat($parent_nesting));Opal.def(self,"$convert_to_array",TMP_ConversionHelper_convert_to_array_191=function(obj,copy){var self=this,$case=nil,converted=nil,e=nil;return null==copy&&(copy=!1),function(){if($case=obj,$$($nesting,"Array")["$==="]($case))return $truthy(copy)?obj.$dup():obj;if($$($nesting,"Vector")["$==="]($case))return obj.$to_a();try{converted=obj.$to_ary()}catch($err){if(!Opal.rescue($err,[$$($nesting,"Exception")]))throw $err;e=$err;try{self.$raise($$($nesting,"TypeError"),"can't convert "+obj.$class()+" into an Array ("+e.$message()+")")}finally{Opal.pop_exception()}}return $truthy(converted["$is_a?"]($$($nesting,"Array")))||self.$raise($$($nesting,"TypeError"),obj.$class()+"#to_ary should return an Array"),converted}()},TMP_ConversionHelper_convert_to_array_191.$$arity=-2),self.$private("convert_to_array")}($nesting[0],$nesting),self.$extend($$($nesting,"ConversionHelper")),function($base,$parent_nesting){function $CoercionHelper(){}var TMP_CoercionHelper_apply_through_coercion_192,TMP_CoercionHelper_coerce_to_193,TMP_CoercionHelper_coerce_to_int_194,TMP_CoercionHelper_coerce_to_matrix_195,self=$CoercionHelper=$module($base,"CoercionHelper",$CoercionHelper),$nesting=(self.prototype,[self].concat($parent_nesting));Opal.def(self,"$apply_through_coercion",TMP_CoercionHelper_apply_through_coercion_192=function(obj,oper){var $a,self=this,coercion=nil;try{return coercion=obj.$coerce(self),$truthy($truthy($a=coercion["$is_a?"]($$($nesting,"Array")))?coercion.$length()["$=="](2):$a)||self.$raise($$($nesting,"TypeError")),coercion["$[]"](0).$public_send(oper,coercion["$[]"](1))}catch($err){if(!Opal.rescue($err,[$$($nesting,"StandardError")]))throw $err;try{return self.$raise($$($nesting,"TypeError"),obj.$inspect()+" can't be coerced into "+self.$class())}finally{Opal.pop_exception()}}},TMP_CoercionHelper_apply_through_coercion_192.$$arity=2),self.$private("apply_through_coercion"),Opal.defs(self,"$coerce_to",TMP_CoercionHelper_coerce_to_193=function(obj,cls,meth){var self=this,ret=nil,e=nil;if($truthy(obj["$kind_of?"](cls)))return obj;$truthy(obj["$respond_to?"](meth))||self.$raise($$($nesting,"TypeError"),"Expected a "+cls+" but got a "+obj.$class());try{ret=obj.$__send__(meth)}catch($err){if(!Opal.rescue($err,[$$($nesting,"Exception")]))throw $err;e=$err;try{self.$raise($$($nesting,"TypeError"),"Coercion error: "+obj.$inspect()+"."+meth+" => "+cls+" failed:\n("+e.$message()+")")}finally{Opal.pop_exception()}}return $truthy(ret["$kind_of?"](cls))||self.$raise($$($nesting,"TypeError"),"Coercion error: obj."+meth+" did NOT return a "+cls+" (was "+ret.$class()+")"),ret},TMP_CoercionHelper_coerce_to_193.$$arity=3),Opal.defs(self,"$coerce_to_int",TMP_CoercionHelper_coerce_to_int_194=function(obj){return this.$coerce_to(obj,$$($nesting,"Integer"),"to_int")},TMP_CoercionHelper_coerce_to_int_194.$$arity=1),Opal.defs(self,"$coerce_to_matrix",TMP_CoercionHelper_coerce_to_matrix_195=function(obj){return this.$coerce_to(obj,$$($nesting,"Matrix"),"to_matrix")},TMP_CoercionHelper_coerce_to_matrix_195.$$arity=1)}($nesting[0],$nesting),self.$include($$($nesting,"CoercionHelper")),function($base,$super,$parent_nesting){function $Scalar(){}var TMP_Scalar_initialize_196,TMP_Scalar_$_197,TMP_Scalar_$_198,TMP_Scalar_$_199,TMP_Scalar_$_201,TMP_Scalar_$$_202,self=$Scalar=$klass($base,$super,"Scalar",$Scalar),def=self.prototype,$nesting=[self].concat($parent_nesting);def.value=nil,self.$include($$($nesting,"ExceptionForMatrix")),self.$include($$($nesting,"CoercionHelper")),Opal.def(self,"$initialize",TMP_Scalar_initialize_196=function(value){return this.value=value},TMP_Scalar_initialize_196.$$arity=1),Opal.def(self,"$+",TMP_Scalar_$_197=function(other){var self=this,$case=nil;return $case=other,$$($nesting,"Numeric")["$==="]($case)?$$($nesting,"Scalar").$new($rb_plus(self.value,other)):$$($nesting,"Vector")["$==="]($case)||$$($nesting,"Matrix")["$==="]($case)?$$($nesting,"Scalar").$Raise($$($nesting,"ErrOperationNotDefined"),"+",self.value.$class(),other.$class()):self.$apply_through_coercion(other,"+")},TMP_Scalar_$_197.$$arity=1),Opal.def(self,"$-",TMP_Scalar_$_198=function(other){var self=this,$case=nil;return $case=other,$$($nesting,"Numeric")["$==="]($case)?$$($nesting,"Scalar").$new($rb_minus(self.value,other)):$$($nesting,"Vector")["$==="]($case)||$$($nesting,"Matrix")["$==="]($case)?$$($nesting,"Scalar").$Raise($$($nesting,"ErrOperationNotDefined"),"-",self.value.$class(),other.$class()):self.$apply_through_coercion(other,"-")},TMP_Scalar_$_198.$$arity=1),Opal.def(self,"$*",TMP_Scalar_$_199=function(other){var TMP_200,self=this,$case=nil;return $case=other,$$($nesting,"Numeric")["$==="]($case)?$$($nesting,"Scalar").$new($rb_times(self.value,other)):$$($nesting,"Vector")["$==="]($case)||$$($nesting,"Matrix")["$==="]($case)?$send(other,"collect",[],((TMP_200=function(e){var self=TMP_200.$$s||this;return null==self.value&&(self.value=nil),null==e&&(e=nil),$rb_times(self.value,e)}).$$s=self,TMP_200.$$arity=1,TMP_200)):self.$apply_through_coercion(other,"*")},TMP_Scalar_$_199.$$arity=1),Opal.def(self,"$/",TMP_Scalar_$_201=function(other){var self=this,$case=nil;return $case=other,$$($nesting,"Numeric")["$==="]($case)?$$($nesting,"Scalar").$new($rb_divide(self.value,other)):$$($nesting,"Vector")["$==="]($case)?$$($nesting,"Scalar").$Raise($$($nesting,"ErrOperationNotDefined"),"/",self.value.$class(),other.$class()):$$($nesting,"Matrix")["$==="]($case)?$rb_times(self,other.$inverse()):self.$apply_through_coercion(other,"/")},TMP_Scalar_$_201.$$arity=1),Opal.def(self,"$**",TMP_Scalar_$$_202=function(other){var self=this,$case=nil;return $case=other,$$($nesting,"Numeric")["$==="]($case)?$$($nesting,"Scalar").$new(self.value["$**"](other)):$$($nesting,"Vector")["$==="]($case)?$$($nesting,"Scalar").$Raise($$($nesting,"ErrOperationNotDefined"),"**",self.value.$class(),other.$class()):$$($nesting,"Matrix")["$==="]($case)?$$($nesting,"Scalar").$Raise($$($nesting,"ErrOperationNotImplemented"),"**",self.value.$class(),other.$class()):self.$apply_through_coercion(other,"**")},TMP_Scalar_$$_202.$$arity=1)}($nesting[0],$$($nesting,"Numeric"),$nesting)}($nesting[0],0,$nesting),function($base,$super,$parent_nesting){function $Vector(){}var TMP_Vector_$$_203,TMP_Vector_elements_204,TMP_Vector_basis_205,TMP_Vector_zero_206,TMP_Vector_initialize_207,TMP_Vector_$$_208,TMP_Vector_$$$eq_209,TMP_Vector_round_210,TMP_Vector_size_212,TMP_Vector_each_213,TMP_Vector_each2_214,TMP_Vector_collect2_216,TMP_Vector_independent$q_218,TMP_Vector_independent$q_220,TMP_Vector_zero$q_221,TMP_Vector_$eq$eq_222,TMP_Vector_eql$q_223,TMP_Vector_clone_224,TMP_Vector_hash_225,TMP_Vector_$_226,TMP_Vector_$_228,TMP_Vector_$_230,TMP_Vector_$_232,TMP_Vector_$$_234,TMP_Vector_$$_235,TMP_Vector_inner_product_237,TMP_Vector_cross_product_239,TMP_Vector_collect_242,TMP_Vector_magnitude_243,TMP_Vector_map2_245,TMP_Vector_normalize_246,TMP_Vector_angle_with_247,TMP_Vector_covector_248,TMP_Vector_to_a_249,TMP_Vector_to_matrix_250,TMP_Vector_elements_to_f_251,TMP_Vector_elements_to_i_252,TMP_Vector_elements_to_r_253,TMP_Vector_coerce_254,TMP_Vector_to_s_255,TMP_Vector_inspect_256,self=$Vector=$klass($base,null,"Vector",$Vector),def=self.prototype,$nesting=[self].concat($parent_nesting);return def.elements=nil,self.$include($$($nesting,"ExceptionForMatrix")),self.$include($$($nesting,"Enumerable")),self.$include($$$($$($nesting,"Matrix"),"CoercionHelper")),self.$extend($$$($$($nesting,"Matrix"),"ConversionHelper")),self.$private_class_method("new"),self.$attr_reader("elements"),self.$protected("elements"),Opal.defs($$($nesting,"Vector"),"$[]",TMP_Vector_$$_203=function($a){var array;return array=Opal.slice.call(arguments,0,arguments.length),this.$new(this.$convert_to_array(array,!1))},TMP_Vector_$$_203.$$arity=-1),Opal.defs($$($nesting,"Vector"),"$elements",TMP_Vector_elements_204=function(array,copy){return null==copy&&(copy=!0),this.$new(this.$convert_to_array(array,copy))},TMP_Vector_elements_204.$$arity=-2),Opal.defs($$($nesting,"Vector"),"$basis",TMP_Vector_basis_205=function($kwargs){var size,index,array,$writer;if(null==$kwargs)$kwargs=$hash2([],{});else if(!$kwargs.$$is_hash)throw Opal.ArgumentError.$new("expected kwargs");if(!Opal.hasOwnProperty.call($kwargs.$$smap,"size"))throw Opal.ArgumentError.$new("missing keyword: size");if(size=$kwargs.$$smap.size,!Opal.hasOwnProperty.call($kwargs.$$smap,"index"))throw Opal.ArgumentError.$new("missing keyword: index");return index=$kwargs.$$smap.index,$truthy($rb_lt(size,1))&&this.$raise($$($nesting,"ArgumentError"),"invalid size ("+size+" for 1..)"),$truthy($rb_le(0,index)?$rb_lt(index,size):$rb_le(0,index))||this.$raise($$($nesting,"ArgumentError"),"invalid index ("+index+" for 0..."+size+")"),array=$$($nesting,"Array").$new(size,0),$writer=[index,1],$send(array,"[]=",Opal.to_a($writer)),$rb_minus($writer.length,1),this.$new(this.$convert_to_array(array,!1))},TMP_Vector_basis_205.$$arity=1),Opal.defs($$($nesting,"Vector"),"$zero",TMP_Vector_zero_206=function(size){var array;return $truthy($rb_lt(size,0))&&this.$raise($$($nesting,"ArgumentError"),"invalid size ("+size+" for 0..)"),array=$$($nesting,"Array").$new(size,0),this.$new(this.$convert_to_array(array,!1))},TMP_Vector_zero_206.$$arity=1),Opal.def(self,"$initialize",TMP_Vector_initialize_207=function(array){return this.elements=array},TMP_Vector_initialize_207.$$arity=1),Opal.def(self,"$[]",TMP_Vector_$$_208=function(i){return this.elements["$[]"](i)},TMP_Vector_$$_208.$$arity=1),Opal.alias(self,"element","[]"),Opal.alias(self,"component","[]"),Opal.def(self,"$[]=",TMP_Vector_$$$eq_209=function(i,v){var $writer;return $writer=[i,v],$send(this.elements,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]},TMP_Vector_$$$eq_209.$$arity=2),Opal.alias(self,"set_element","[]="),Opal.alias(self,"set_component","[]="),self.$private("[]=","set_element","set_component"),Opal.def(self,"$round",TMP_Vector_round_210=function(ndigits){var TMP_211;return null==ndigits&&(ndigits=0),$send(this,"map",[],((TMP_211=function(e){TMP_211.$$s;return null==e&&(e=nil),e.$round(ndigits)}).$$s=this,TMP_211.$$arity=1,TMP_211))},TMP_Vector_round_210.$$arity=-1),Opal.def(self,"$size",TMP_Vector_size_212=function(){return this.elements.$size()},TMP_Vector_size_212.$$arity=0),Opal.def(self,"$each",TMP_Vector_each_213=function(){var $iter=TMP_Vector_each_213.$$p,block=$iter||nil;return $iter&&(TMP_Vector_each_213.$$p=null),$iter&&(TMP_Vector_each_213.$$p=null),block===nil?this.$to_enum("each"):($send(this.elements,"each",[],block.$to_proc()),this)},TMP_Vector_each_213.$$arity=0),Opal.def(self,"$each2",TMP_Vector_each2_214=function(v){var TMP_215,$iter=TMP_Vector_each2_214.$$p,$yield=$iter||nil;return $iter&&(TMP_Vector_each2_214.$$p=null),$truthy(v["$kind_of?"]($$($nesting,"Integer")))&&this.$raise($$($nesting,"TypeError"),"Integer is not like Vector"),$truthy(this.$size()["$!="](v.$size()))&&$$($nesting,"Vector").$Raise($$($nesting,"ErrDimensionMismatch")),$yield===nil?this.$to_enum("each2",v):($send(this.$size(),"times",[],((TMP_215=function(i){var self=TMP_215.$$s||this;return null==self.elements&&(self.elements=nil),null==i&&(i=nil),Opal.yieldX($yield,[self.elements["$[]"](i),v["$[]"](i)])}).$$s=this,TMP_215.$$arity=1,TMP_215)),this)},TMP_Vector_each2_214.$$arity=1),Opal.def(self,"$collect2",TMP_Vector_collect2_216=function(v){var TMP_217,$iter=TMP_Vector_collect2_216.$$p,$yield=$iter||nil;return $iter&&(TMP_Vector_collect2_216.$$p=null),$truthy(v["$kind_of?"]($$($nesting,"Integer")))&&this.$raise($$($nesting,"TypeError"),"Integer is not like Vector"),$truthy(this.$size()["$!="](v.$size()))&&$$($nesting,"Vector").$Raise($$($nesting,"ErrDimensionMismatch")),$yield===nil?this.$to_enum("collect2",v):$send($$($nesting,"Array"),"new",[this.$size()],((TMP_217=function(i){var self=TMP_217.$$s||this;return null==self.elements&&(self.elements=nil),null==i&&(i=nil),Opal.yieldX($yield,[self.elements["$[]"](i),v["$[]"](i)])}).$$s=this,TMP_217.$$arity=1,TMP_217))},TMP_Vector_collect2_216.$$arity=1),Opal.defs($$($nesting,"Vector"),"$independent?",TMP_Vector_independent$q_218=function($a){var $post_args,vs,TMP_219;return $post_args=Opal.slice.call(arguments,0,arguments.length),$send(vs=$post_args,"each",[],((TMP_219=function(v){var self=TMP_219.$$s||this;return null==v&&(v=nil),$truthy(v["$is_a?"]($$($nesting,"Vector")))||self.$raise($$($nesting,"TypeError"),"expected Vector, got "+v.$class()),v.$size()["$=="](vs.$first().$size())?nil:$$($nesting,"Vector").$Raise($$($nesting,"ErrDimensionMismatch"))}).$$s=this,TMP_219.$$arity=1,TMP_219)),!$truthy($rb_gt(vs.$count(),vs.$first().$size()))&&$send($$($nesting,"Matrix"),"[]",Opal.to_a(vs)).$rank()["$eql?"](vs.$count())},TMP_Vector_independent$q_218.$$arity=-1),Opal.def(self,"$independent?",TMP_Vector_independent$q_220=function($a){var vs,self=this;return vs=Opal.slice.call(arguments,0,arguments.length),$send(self.$class(),"independent?",[self].concat(Opal.to_a(vs)))},TMP_Vector_independent$q_220.$$arity=-1),Opal.def(self,"$zero?",TMP_Vector_zero$q_221=function(){return $send(this,"all?",[],"zero?".$to_proc())},TMP_Vector_zero$q_221.$$arity=0),Opal.def(self,"$==",TMP_Vector_$eq$eq_222=function(other){return!!$truthy($$($nesting,"Vector")["$==="](other))&&this.elements["$=="](other.$elements())},TMP_Vector_$eq$eq_222.$$arity=1),Opal.def(self,"$eql?",TMP_Vector_eql$q_223=function(other){return!!$truthy($$($nesting,"Vector")["$==="](other))&&this.elements["$eql?"](other.$elements())},TMP_Vector_eql$q_223.$$arity=1),Opal.def(self,"$clone",TMP_Vector_clone_224=function(){return this.$class().$elements(this.elements)},TMP_Vector_clone_224.$$arity=0),Opal.def(self,"$hash",TMP_Vector_hash_225=function(){return this.elements.$hash()},TMP_Vector_hash_225.$$arity=0),Opal.def(self,"$*",TMP_Vector_$_226=function(x){var TMP_227,self=this,$case=nil,els=nil;return $case=x,$$($nesting,"Numeric")["$==="]($case)?(els=$send(self.elements,"collect",[],((TMP_227=function(e){return TMP_227.$$s,null==e&&(e=nil),$rb_times(e,x)}).$$s=self,TMP_227.$$arity=1,TMP_227)),self.$class().$elements(els,!1)):$$($nesting,"Matrix")["$==="]($case)?$rb_times($$($nesting,"Matrix").$column_vector(self),x):$$($nesting,"Vector")["$==="]($case)?$$($nesting,"Vector").$Raise($$($nesting,"ErrOperationNotDefined"),"*",self.$class(),x.$class()):self.$apply_through_coercion(x,"*")},TMP_Vector_$_226.$$arity=1),Opal.def(self,"$+",TMP_Vector_$_228=function(v){var TMP_229,self=this,$case=nil,els=nil;return $case=v,$$($nesting,"Vector")["$==="]($case)?($truthy(self.$size()["$!="](v.$size()))&&$$($nesting,"Vector").$Raise($$($nesting,"ErrDimensionMismatch")),els=$send(self,"collect2",[v],((TMP_229=function(v1,v2){return TMP_229.$$s,null==v1&&(v1=nil),null==v2&&(v2=nil),$rb_plus(v1,v2)}).$$s=self,TMP_229.$$arity=2,TMP_229)),self.$class().$elements(els,!1)):$$($nesting,"Matrix")["$==="]($case)?$rb_plus($$($nesting,"Matrix").$column_vector(self),v):self.$apply_through_coercion(v,"+")},TMP_Vector_$_228.$$arity=1),Opal.def(self,"$-",TMP_Vector_$_230=function(v){var TMP_231,self=this,$case=nil,els=nil;return $case=v,$$($nesting,"Vector")["$==="]($case)?($truthy(self.$size()["$!="](v.$size()))&&$$($nesting,"Vector").$Raise($$($nesting,"ErrDimensionMismatch")),els=$send(self,"collect2",[v],((TMP_231=function(v1,v2){return TMP_231.$$s,null==v1&&(v1=nil),null==v2&&(v2=nil),$rb_minus(v1,v2)}).$$s=self,TMP_231.$$arity=2,TMP_231)),self.$class().$elements(els,!1)):$$($nesting,"Matrix")["$==="]($case)?$rb_minus($$($nesting,"Matrix").$column_vector(self),v):self.$apply_through_coercion(v,"-")},TMP_Vector_$_230.$$arity=1),Opal.def(self,"$/",TMP_Vector_$_232=function(x){var TMP_233,self=this,$case=nil,els=nil;return $case=x,$$($nesting,"Numeric")["$==="]($case)?(els=$send(self.elements,"collect",[],((TMP_233=function(e){return TMP_233.$$s,null==e&&(e=nil),$rb_divide(e,x)}).$$s=self,TMP_233.$$arity=1,TMP_233)),self.$class().$elements(els,!1)):$$($nesting,"Matrix")["$==="]($case)||$$($nesting,"Vector")["$==="]($case)?$$($nesting,"Vector").$Raise($$($nesting,"ErrOperationNotDefined"),"/",self.$class(),x.$class()):self.$apply_through_coercion(x,"/")},TMP_Vector_$_232.$$arity=1),Opal.def(self,"$+@",TMP_Vector_$$_234=function(){return this},TMP_Vector_$$_234.$$arity=0),Opal.def(self,"$-@",TMP_Vector_$$_235=function(){var TMP_236;return $send(this,"collect",[],((TMP_236=function(e){TMP_236.$$s;return null==e&&(e=nil),e["$-@"]()}).$$s=this,TMP_236.$$arity=1,TMP_236))},TMP_Vector_$$_235.$$arity=0),Opal.def(self,"$inner_product",TMP_Vector_inner_product_237=function(v){var TMP_238,p=nil;return $truthy(this.$size()["$!="](v.$size()))&&$$($nesting,"Vector").$Raise($$($nesting,"ErrDimensionMismatch")),p=0,$send(this,"each2",[v],((TMP_238=function(v1,v2){TMP_238.$$s;return null==v1&&(v1=nil),null==v2&&(v2=nil),p=$rb_plus(p,$rb_times(v1,v2.$conj()))}).$$s=this,TMP_238.$$arity=2,TMP_238)),p},TMP_Vector_inner_product_237.$$arity=1),self.$alias_method("dot","inner_product"),Opal.def(self,"$cross_product",TMP_Vector_cross_product_239=function($a){var $post_args,vs,TMP_240,TMP_241,self=this,$case=nil,v=nil,rows=nil;return $post_args=Opal.slice.call(arguments,0,arguments.length),vs=$post_args,$truthy($rb_ge(self.$size(),2))||self.$raise($$($nesting,"ErrOperationNotDefined"),"cross product is not defined on vectors of dimension "+self.$size()),vs.$size()["$=="]($rb_minus(self.$size(),2))||self.$raise($$($nesting,"ArgumentError"),"wrong number of arguments ("+vs.$size()+" for "+$rb_minus(self.$size(),2)+")"),$send(vs,"each",[],((TMP_240=function(v){var self=TMP_240.$$s||this;return null==v&&(v=nil),$truthy(v["$is_a?"]($$($nesting,"Vector")))||self.$raise($$($nesting,"TypeError"),"expected Vector, got "+v.$class()),v.$size()["$=="](self.$size())?nil:$$($nesting,"Vector").$Raise($$($nesting,"ErrDimensionMismatch"))}).$$s=self,TMP_240.$$arity=1,TMP_240)),$case=self.$size(),2["$==="]($case)?$$($nesting,"Vector")["$[]"](self.elements["$[]"](1)["$-@"](),self.elements["$[]"](0)):3["$==="]($case)?(v=vs["$[]"](0),$$($nesting,"Vector")["$[]"]($rb_minus($rb_times(v["$[]"](2),self.elements["$[]"](1)),$rb_times(v["$[]"](1),self.elements["$[]"](2))),$rb_minus($rb_times(v["$[]"](0),self.elements["$[]"](2)),$rb_times(v["$[]"](2),self.elements["$[]"](0))),$rb_minus($rb_times(v["$[]"](1),self.elements["$[]"](0)),$rb_times(v["$[]"](0),self.elements["$[]"](1))))):(rows=[self].concat(Opal.to_a(vs)).concat([$send($$($nesting,"Array"),"new",[self.$size()],(TMP_241=function(i){var self=TMP_241.$$s||this;return null==i&&(i=nil),$$($nesting,"Vector").$basis($hash2(["size","index"],{size:self.$size(),index:i}))},TMP_241.$$s=self,TMP_241.$$arity=1,TMP_241))]),$$($nesting,"Matrix").$rows(rows).$laplace_expansion($hash2(["row"],{row:$rb_minus(self.$size(),1)})))},TMP_Vector_cross_product_239.$$arity=-1),self.$alias_method("cross","cross_product"),Opal.def(self,"$collect",TMP_Vector_collect_242=function(){var els,$iter=TMP_Vector_collect_242.$$p,block=$iter||nil;return $iter&&(TMP_Vector_collect_242.$$p=null),$iter&&(TMP_Vector_collect_242.$$p=null),block===nil?this.$to_enum("collect"):(els=$send(this.elements,"collect",[],block.$to_proc()),this.$class().$elements(els,!1))},TMP_Vector_collect_242.$$arity=0),Opal.alias(self,"map","collect"),Opal.def(self,"$magnitude",TMP_Vector_magnitude_243=function(){var TMP_244;return $$($nesting,"Math").$sqrt($send(this.elements,"inject",[0],((TMP_244=function(v,e){TMP_244.$$s;return null==v&&(v=nil),null==e&&(e=nil),$rb_plus(v,e.$abs2())}).$$s=this,TMP_244.$$arity=2,TMP_244)))},TMP_Vector_magnitude_243.$$arity=0),Opal.alias(self,"r","magnitude"),Opal.alias(self,"norm","magnitude"),Opal.def(self,"$map2",TMP_Vector_map2_245=function(v){var els,$iter=TMP_Vector_map2_245.$$p,block=$iter||nil;return $iter&&(TMP_Vector_map2_245.$$p=null),$iter&&(TMP_Vector_map2_245.$$p=null),block===nil?this.$to_enum("map2",v):(els=$send(this,"collect2",[v],block.$to_proc()),this.$class().$elements(els,!1))},TMP_Vector_map2_245.$$arity=1),function($base,$super,$parent_nesting){function $ZeroVectorError(){}var self=$ZeroVectorError=$klass($base,$super,"ZeroVectorError",$ZeroVectorError);self.prototype,[self].concat($parent_nesting)}($nesting[0],$$($nesting,"StandardError"),$nesting),Opal.def(self,"$normalize",TMP_Vector_normalize_246=function(){var n=nil;return(n=this.$magnitude())["$=="](0)&&this.$raise($$($nesting,"ZeroVectorError"),"Zero vectors can not be normalized"),$rb_divide(this,n)},TMP_Vector_normalize_246.$$arity=0),Opal.def(self,"$angle_with",TMP_Vector_angle_with_247=function(v){var prod=nil;return $truthy(v["$is_a?"]($$($nesting,"Vector")))||this.$raise($$($nesting,"TypeError"),"Expected a Vector, got a "+v.$class()),$truthy(this.$size()["$!="](v.$size()))&&$$($nesting,"Vector").$Raise($$($nesting,"ErrDimensionMismatch")),(prod=$rb_times(this.$magnitude(),v.$magnitude()))["$=="](0)&&this.$raise($$($nesting,"ZeroVectorError"),"Can't get angle of zero vector"),$$($nesting,"Math").$acos($rb_divide(this.$inner_product(v),prod))},TMP_Vector_angle_with_247.$$arity=1),Opal.def(self,"$covector",TMP_Vector_covector_248=function(){return $$($nesting,"Matrix").$row_vector(this)},TMP_Vector_covector_248.$$arity=0),Opal.def(self,"$to_a",TMP_Vector_to_a_249=function(){return this.elements.$dup()},TMP_Vector_to_a_249.$$arity=0),Opal.def(self,"$to_matrix",TMP_Vector_to_matrix_250=function(){return $$($nesting,"Matrix").$column_vector(this)},TMP_Vector_to_matrix_250.$$arity=0),Opal.def(self,"$elements_to_f",TMP_Vector_elements_to_f_251=function(){return this.$warn("Vector#elements_to_f is deprecated",$hash2(["uplevel"],{uplevel:1})),$send(this,"map",[],"to_f".$to_proc())},TMP_Vector_elements_to_f_251.$$arity=0),Opal.def(self,"$elements_to_i",TMP_Vector_elements_to_i_252=function(){return this.$warn("Vector#elements_to_i is deprecated",$hash2(["uplevel"],{uplevel:1})),$send(this,"map",[],"to_i".$to_proc())},TMP_Vector_elements_to_i_252.$$arity=0),Opal.def(self,"$elements_to_r",TMP_Vector_elements_to_r_253=function(){return this.$warn("Vector#elements_to_r is deprecated",$hash2(["uplevel"],{uplevel:1})),$send(this,"map",[],"to_r".$to_proc())},TMP_Vector_elements_to_r_253.$$arity=0),Opal.def(self,"$coerce",TMP_Vector_coerce_254=function(other){var self=this,$case=nil;return $case=other,$$($nesting,"Numeric")["$==="]($case)?[$$$($$($nesting,"Matrix"),"Scalar").$new(other),self]:self.$raise($$($nesting,"TypeError"),self.$class()+" can't be coerced into "+other.$class())},TMP_Vector_coerce_254.$$arity=1),Opal.def(self,"$to_s",TMP_Vector_to_s_255=function(){return $rb_plus($rb_plus("Vector[",this.elements.$join(", ")),"]")},TMP_Vector_to_s_255.$$arity=0),Opal.def(self,"$inspect",TMP_Vector_inspect_256=function(){return $rb_plus("Vector",this.elements.$inspect())},TMP_Vector_inspect_256.$$arity=0),nil&&"inspect"}($nesting[0],0,$nesting)};
